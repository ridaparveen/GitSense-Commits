# Activity Summary for 1/4/2026

## 2:59:57 PM
The provided log details a series of code changes, all occurring on January 2, 2026, primarily focusing on customer management, data fetching, and analytics queries within a T360 API backend.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\analytics\query\booking.query.ts` (Timestamp: 1/2/2026, 2:35:49 PM)**
    *   This file defines the `bookingQueryBuilder` function, responsible for generating complex SQL queries for analytics reports.
    *   It imports utilities for dynamic column selection and filter query generation.
    *   The function dynamically sets `customizer` properties (e.g., `selectedColumns`, `dateRange`, `calType`, `chartType`) based on the `type` of booking query requested.
    *   It supports various report types, including calculating average day differences between booking and actual departure dates (both container-wise and MBL-wise) and generating stacked bar charts to categorize these differences into time ranges (e.g., "Less than 1 week", "1 - 2 weeks").
    *   Queries use `mtr_tracking_data` and `agent_booking_entry` tables, applying filters for `CompanyName` and date ranges.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\getCustomerOptions.ts` (Multiple timestamps between 1/2/2026, 3:58:49 PM and 4:31:23 PM)**
    *   This controller manages customer options, primarily for fetching and deleting.
    *   **`getAllCustomerOptions`:** Fetches a distinct list of `account_name` from `mtr_tracking_data`, allowing for partial string searches and limiting results to 10. Earlier, commented-out code suggests more elaborate customer role-based and paginated fetching was considered or previously implemented.
    *   **`deleteCustomerOption`:** This function underwent several rapid iterations:
        *   Initially, it deleted records from `mtr_tracking_data` based on `account_name` provided in the request body.
        *   It then shifted to accepting a `customer_id` from `req.params`, first attempting to delete from `mtr_tracking_data` using a `customer_id` column, then an `id` column.
        *   The final change redirects the deletion to the `Account_Master_Customer_MAP` table, using the `id` column, indicating a focus on deleting specific customer mappings rather than general tracking data entries.
    *   Debugging `console.log` statements were temporarily added for `customer_id` and `req.params` during this iterative development.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\routes\getCustomerOptionsRoute.ts` (Multiple timestamps between 1/2/2026, 3:59:33 PM and 4:28:07 PM)**
    *   This file defines API routes for the `getCustomerOptions` controller.
    *   It exposes a `GET /` endpoint for `getAllCustomerOptions`.
    *   The `DELETE` route evolved from `DELETE /` to `DELETE /delete`, and finally to `DELETE /delete/:customer_id`. This evolution directly mirrors the changes in how `deleteCustomerOption` in its controller expects parameters.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\code.controller.ts` (Multiple timestamps between 1/2/2026, 4:12:38 PM and 4:14:13 PM)**
    *   This controller handles more comprehensive customer (Account Master) functionalities.
    *   **`getAllCustomer`:** Retrieves detailed customer information from `PO_AccountMaster_Customer_Master`, supporting pagination, sorting, and search filters. It also fetches associated shipper mappings (`account_master_shipper_MAP`), document uploads (`document_upload_details`), and customer mappings (`Account_Master_Customer_MAP`). A minor update added `customer_id` to the `customerMapData` output.
    *   **`createCustomer`:** A robust function for creating or modifying customer records.
        *   It supports file uploads and handles various customer attributes.
        *   Uses a database transaction.
        *   Determines if it's a 'NEW' or 'Modify' operation based on existing `acode`. For modifications, it deletes existing related records across multiple tables (`PO_AccountMaster_Customer_Master`, `agent_po_account_master_type`, `Account_Master_Shipper_MAP`, `account_master_pic`) before re-inserting.
        *   Generates new `acode` or `subcode` for new entries or specific customer types.
        *   Processes `ctypelist` to insert into `agent_po_account_master_type`.
        *   Parses `mapping` data (likely for shippers) to populate `Account_Master_Shipper_MAP`, resolving related codes from other master tables.
        *   The code for this function is truncated, indicating further logic beyond the provided snippet.

**Patterns and Recurring Elements:**

*   **Customer-Centric Development:** A strong focus on customer-related operations, including analytics, fetching options, detailed profile management, and deletion.
*   **Rapid Iteration on Deletion Logic:** The `deleteCustomerOption` function and its corresponding route changed multiple times within a short period, refining how customer deletion is performed and which data `id` is used (from `account_name` to `customer_id` to `id`, and from `mtr_tracking_data` to `Account_Master_Customer_MAP`).
*   **Database Interaction:** Extensive use of PostgreSQL-like SQL queries (`SELECT`, `INSERT`, `DELETE`, `TRIM`, `ILIKE`, `EXTRACT(DAY FROM...)`) with parameterized values ($1, $2) for security.
*   **Dynamic Query Generation:** The `bookingQueryBuilder` and `getAllCustomer` functions demonstrate building SQL queries dynamically based on input parameters.
*   **Utility Functions:** Reliance on imported helper functions like `getColumnsByCategory`, `getFilterQueryByDisplayValue`, `chkStr`, `getAccountCode`, `getAccountSubCode` for modularity and data handling.
*   **Logging and Debugging:** Frequent `console.log` and `logger.info` statements suggest an active debugging and monitoring process.
*   **Truncation:** Several code snippets are truncated, implying larger functions and more extensive changes were made than fully captured in the log.

## 3:00:09 PM
The changes primarily involve enhancements and additions to analytics query builders, focusing on transit, TEU, departure, general shipment, container, and booking-related reports. All modifications occurred on 1/2/2026.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\transit.query.ts` (Timestamp: 1/2/2026, 4:59:40 PM)**
    *   Introduced `transitQueryBuilder` for generating complex SQL queries related to transit times.
    *   Supports analytics for "country_of_origin" and "port_pair" comparisons of actual, estimated, and estimated vs. actual transit times.
    *   Added dedicated logic for "ScheduledTransitVsActualTransit" (container-wise) and "ScheduledTransitVsActualTransitMblWise" (MBL-wise) reports, calculating average day differences between live actual arrived/departed dates and inland ETA/departure dates.
    *   The queries include `DISTINCT ON` clauses to handle data uniqueness based on voyage, container number, and container type.
    *   Customizer configurations for chart types, calculation types, and selected columns are dynamically set.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\services\analytics\teuService.ts` (Timestamp: 1/2/2026, 5:00:42 PM and 1/2/2026, 5:00:53 PM)**
    *   The `getTEUReports` service was updated to provide TEU (Twenty-foot Equivalent Unit) analytics.
    *   Calculates TEU based on `country_of_origin`, `country_of_discharge`, or other generic `group_by_column`.
    *   Includes logic to extract numeric container types (`t49_cont_type` or `cont_type`) for `total_volume` calculation and then converts to TEU (dividing by 20).
    *   Standardizes port names (e.g., 'LONG BEACH' becomes 'LOS ANGELES') for specific columns.
    *   Default `fromDate` and `toDate` are set if not provided in the request.
    *   The two entries for this file are functionally identical, indicating a minor save or reformat without code changes.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\departure.query.ts` (Timestamp: 1/2/2026, 5:01:49 PM)**
    *   Introduced `departureQueryBuilder` for departure-related KPIs.
    *   Supports "BLReleaseKPI" as a stacked bar chart, categorizing the difference between vessel actual departure and batch run date into "Equal/Less than 3 days" and "More than 3 days".
    *   Added "DelayedPOLDepartures" (container-wise) and "DelayedPOLDeparturesMblWise" (MBL-wise) reports, calculating the sum of day differences between live actual departed date and departure date.
    *   Implemented "OriginalETAvsActualETA" (container-wise) and "OriginalETAvsActualETAMblWise" (MBL-wise) reports, calculating the sum of day differences between updated ETA port date and original ETA POD.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\general.query.ts` (Timestamp: 1/2/2026, 5:03:05 PM)**
    *   Added `generalQueryBuilder` for basic shipment and MBL/container counts.
    *   Introduced "TotalShipments" which provides a count of distinct `fileno` (shipments) and distinct `voyage` (containers).
    *   Added "TotalShipmentsMblWise" which provides a count of distinct `fileno` (shipments) and distinct `mblno` (Master Bill of Lading).
    *   Calculates percentages for these counts relative to the maximum value observed.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\container.query.ts` (Timestamp: 1/2/2026, 5:03:44 PM)**
    *   Introduced `containerQueryBuilder` for container-specific analytics.
    *   Supports "ContainerDischargevsContainerAvailable" (difference between container available date and discharge date).
    *   Added "ContainerDischargeVsFinalDeliveryDate" (difference between delivery customer date and container discharge date, filtered by `type_of_move`).
    *   Implemented "ContainerGateOutVsGateIn" (difference between empty return date and container outgate date, adding 1 day).
    *   Added "ContainerOrVesselDischargeVsGateOut" (difference between container outgate and discharge date).
    *   Prioritizes `t49_` prefixed date columns where available, indicating "live" data.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\booking.query.ts` (Timestamp: 1/2/2026, 5:09:05 PM, 5:09:30 PM, 5:11:03 PM, 5:46:22 PM, 5:47:08 PM)**
    *   The `bookingQueryBuilder` was updated to include various booking-to-departure time analyses.
    *   Features "BookingDatetoActualDeparture" (container-wise) and "BookingDatetoActualDepartureMblWise" (MBL-wise) reports, calculating the average day difference between actual vessel departure and booking date.
    *   Introduced stacked bar chart variants: "BookingDatetoActualDepartureStackedBar" and "BookingDatetoActualDepartureMblWiseStackedBar", which categorize the day difference into weekly intervals (e.g., "Less than 1 week", "1 - 2 weeks").
    *   All five entries for this file at different timestamps are identical, indicating no functional code changes between these saves.

**Patterns and Recurring Elements:**

*   **Dynamic Query Generation:** A consistent pattern of constructing SQL queries based on `type`, `columnName`, `viewBy`, and `displayBy` parameters, using helper functions like `getFilterQueryByDisplayValue` and `getFilterQueryByTransitView`.
*   **Customizer Object:** The `customizer` object is universally used to configure report metadata such as `dateRange`, `calType`, `chartType`, `dateColumns`, and `calColumnConfig` for the frontend to interpret the analytics data.
*   **Column Selection:** The `getColumnsByCategory` utility is frequently called to define which columns are relevant for a given report, often ignoring common metadata columns and explicitly requiring key analytical columns.
*   **Date Handling and Validation:** All queries include robust date validation, checking for `IS NOT NULL` and `!= '0001-01-01 00:00:00 BC'` to ensure accurate calculations and prevent errors from invalid default dates. Date range filtering `departure_date >= '${fromDate}'::timestamp AND departure_date < '${toDate}'::timestamp + INTERVAL '1 day'` is also standard.
*   **Company-Specific Filtering:** Data is consistently filtered by `account_name` using `LOWER(account_name) = ANY ( regexp_split_to_array(LOWER('${CompanyName}'), '\s*,\s*') )`, allowing multiple company names to be passed.
*   **`DISTINCT ON` for Uniqueness:** Many queries use `DISTINCT ON (voyage,contno, CASE WHEN t49_cont_type IS NOT NULL AND TRIM(t49_cont_type) <> '' AND TRIM(t49_cont_type) != '0' THEN t49_cont_type ELSE cont_type END )` to ensure unique records, particularly for container-level analysis.
*   **`t49_` Data Prioritization:** There's a recurring logic to use `t49_` prefixed columns (e.g., `t49_vessel_actualdeparted_date`) over their standard counterparts if they contain valid data, suggesting `t49_` fields represent more current or accurate tracking information.
*   **Percentage Calculation Logic:** Most analytical queries include a `WITH max_value AS (...)` common table expression to determine the maximum value and then calculate each entity's `percentage` relative to this maximum, handling division by zero and negative values.
*   **MBL-Wise and Container-Wise Variants:** Several reports offer both container-level (`fileno || ',' || contno` for grouping) and MBL-level (`fileno || ',' || mblno` for grouping) aggregation, reflecting different granularities of tracking.
*   **PostgreSQL Features:** Extensive use of PostgreSQL-specific functions like `EXTRACT(DAY FROM interval)`, `DATE_TRUNC`, `regexp_split_to_array`, `CAST`, `NULLIF`, and `REGEXP_REPLACE` for data manipulation and aggregation.

## 4:03:59 PM
**File: `src\controllers\analytics\query\booking.query.ts` (Timestamp: 1/2/2026, 2:35:49 PM)**
This file defines the `bookingQueryBuilder` function, responsible for generating complex SQL queries for analytics reports related to booking and actual departure dates. It imports utilities for column selection and filter query generation. The function customizes report parameters like date ranges, calculation types (average), and date columns based on the `type` of the report.
Key updates include:
*   Ignored columns like `country_name`, `networkdays`, `bl_release_date` for column selection, while ensuring `bookingdate`, `booking_status_action_date`, `est_cargo_ready_date`, and `departure_date` are always included.
*   Introduced new report types:
    *   `BookingDatetoActualDeparture`: Calculates the average day difference between booking and actual departure dates per `fileno` and `contno`, providing a value and a percentage relative to the maximum value.
    *   `BookingDatetoActualDepartureMblWise`: Similar to the above, but aggregates per `fileno` and `mblno`.
    *   `BookingDatetoActualDepartureStackedBar`: Categorizes day differences into predefined ranges ("Less than 1 week", "1 - 2 weeks", etc.) and aggregates counts by date intervals, suitable for stacked bar charts.
    *   `BookingDatetoActualDepartureMblWiseStackedBar`: An incomplete block, presumably for a similar stacked bar chart aggregation per MBL.
Each query includes filtering by `CompanyName` and a date range (`fromDate`, `toDate`).

**File: `src\controllers\getCustomerOptions.ts`**
This controller manages customer options and deletion functionality.
*   **Initial Update (1/2/2026, 3:58:49 PM):**
    *   The `getAllCustomerOptions` function was completely refactored. Previously it had extensive commented-out logic for handling different roles (`AGENT`, `CUSTOMER`) and pagination, fetching from `agent_po_account_master` or `mtr_tracking_data`. The new version is streamlined to fetch `DISTINCT TRIM(account_name)` from `mtr_tracking_data` with a search capability (`ILIKE`) and a limit of 10 results.
    *   A new `deleteCustomerOption` function was introduced, initially designed to delete records from `mtr_tracking_data` based on `account_name` received in `req.body`.
*   **Subsequent Updates (1/2/2026, 4:17:54 PM - 4:31:23 PM):**
    *   **4:17:54 PM:** The `deleteCustomerOption` function was modified to accept `customer_id` from `req.params` instead of `account_name` from `req.body`, and the SQL query changed to `DELETE FROM mtr_tracking_data WHERE customer_id = $1`.
    *   **4:22:36 PM:** The SQL query in `deleteCustomerOption` was refined to use `id` as the column for deletion: `DELETE FROM mtr_tracking_data WHERE id = $1`.
    *   **4:28:41 PM, 4:28:50 PM, 4:29:40 PM:** Minor debugging `console.log` statements were added to `deleteCustomerOption` to inspect `customer_id` and `req.params`. The core delete logic remained unchanged.
    *   **4:31:23 PM:** The target table for deletion in `deleteCustomerOption` was changed from `mtr_tracking_data` to `Account_Master_Customer_MAP`, making the SQL `DELETE FROM Account_Master_Customer_MAP WHERE id = $1`.

**File: `src\routes\getCustomerOptionsRoute.ts`**
This file defines the API routes for customer options.
*   **Initial Update (1/2/2026, 3:59:33 PM):**
    *   Defined a `GET /` route for `getAllCustomerOptions` and a `DELETE /` route for `deleteCustomerOption`.
*   **Subsequent Updates (1/2/2026, 3:59:43 PM - 4:28:07 PM):**
    *   **3:59:43 PM:** The `DELETE` route was changed from `/` to `/delete`.
    *   **4:18:20 PM & 4:28:07 PM:** The `DELETE` route was further refined to include a dynamic `customer_id` parameter: `/delete/:customer_id`. This change directly corresponds to the `deleteCustomerOption` controller's expectation of `customer_id` from `req.params`.

**File: `src\controllers\code.controller.ts`**
This controller handles comprehensive customer management, including fetching, creating, and modifying customer records.
*   **Initial Update (1/2/2026, 4:12:38 PM):**
    *   `getAllCustomer`: This function retrieves customer details from `PO_AccountMaster_Customer_Master` with support for pagination, sorting (`orderBy`), and dynamic column-based searching. It also fetches and integrates related data, specifically shipper mappings from `account_master_shipper_MAP`, document upload details from `document_upload_details`, and customer mappings from `Account_Master_Customer_MAP`.
    *   `createCustomer`: This function manages the creation or modification of customer records, supporting file uploads.
        *   It sanitizes the `cname` field.
        *   It operates within a database transaction.
        *   It checks for existing customers by `acode`; if found, it's treated as a modification, leading to deletion of existing associated records across multiple tables (customer master, type, shipper map, account master pic) before re-insertion. If new, it generates a unique `acode`.
        *   Inserts into `PO_AccountMaster_Customer_Master`.
        *   Handles `ctypelist` specifically for 'CUSTOMER' type, inserting into `agent_po_account_master_type`.
        *   Processes `mapping` data (likely shipper-related), resolving `polcode`, `shippercode`, and `agentcode` by querying respective master tables, and then inserting into `Account_Master_Shipper_MAP`. The provided log for this function ends abruptly.
*   **Subsequent Update (1/2/2026, 4:14:13 PM):**
    *   `getAllCustomer`: The `customerMapData` object, returned as part of the customer details, was enhanced to include the `id` from `Account_Master_Customer_MAP`, now exposed as `customer_id`. The `createCustomer` function's code content was identical to the previous log entry, indicating no functional change to it in this specific timestamp, or that the snippet was truncated in the same manner.

**Patterns and Recurring Elements:**
*   **Rapid Iteration on Customer Deletion:** The `deleteCustomerOption` function and its corresponding route changed multiple times in a short span, moving from `req.body` to `req.params` for ID, refining the ID column name, and finally changing the target table for deletion.
*   **Focus on Customer Data:** A consistent theme is the management and retrieval of customer-related information across various tables (`PO_AccountMaster_Customer_Master`, `mtr_tracking_data`, `Account_Master_Shipper_MAP`, `Account_Master_Customer_MAP`).
*   **Complex SQL Queries:** Several functions utilize intricate SQL queries involving joins, subqueries, aggregations, date/time manipulations, and conditional logic (`CASE WHEN`).
*   **Database Transaction Management:** The `createCustomer` function explicitly uses `BEGIN` for a database transaction, indicating multi-step operations requiring atomicity.
*   **Data Sanitization:** Use of `TRIM()` in SQL and `chkStr()` in controllers, along with string replacements for `cname`, suggests an emphasis on clean data handling.
*   **Timestamp Proximity:** All logged changes occurred on the same day, indicating active development on these specific features.
*   **Incomplete Log Entries:** Several code blocks provided in the log end abruptly, suggesting the log might be capturing snapshots rather than full diffs for longer functions.

## 4:04:04 PM
The provided log details changes across several files, primarily focusing on frontend routing, a booking confirmation component, and customer management forms and API interactions.

### File-Specific Updates:

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\App.js`**
    *   **Timestamps:** 1/2/2026, 2:26:45 PM and 1/2/2026, 2:26:51 PM.
    *   **Key Changes:** These two commits are nearly identical, primarily involving extensive additions of `import` statements and new `Route` definitions within the React `Routes` component.
        *   **Imports:** A large number of new screen components were imported, covering various functionalities like `ShippingOrdersScreen`, `ContainerReportScreen`, `Auth0Login`, `ReportSchedulerScreen`, `NewReportScreen`, `EditReportScreen`, `SprAlcScreen`, `PdfParserScreen`, `AlcExceptionDashboard`, `AlcDestinationCostRecord`, `FCLScreen`, `SprInvoiceScreen`, `ISFDashboardScreen`, `BackOfficeAdminTerminal`, `LCLScreen`, `ShipmentTrackingScreen`, `AddMtrForm`, `GetTruckingDetails`, `RailScreen`, `AgentBookingFormScreenExtend`, `AgentPoFormExtend`, `Dashboard7501Screen`, `ShipmentsScreen`, `CngBookingScreen`, `BookingDashbaordScreenExtend`, `CngBookingFormScreen`, `CngBookingScreenExtend`, `CityMaster`, `UploadOTMBOL`, `PortmasterScreen`, `AirTrackingScreen`, `Auth0LogoutHandler`, and `HblListDetails`.
        *   **Routes:** Corresponding `Route` paths were added for these new components, often nested under `/app` and protected by `ProtectedRoute` based on `UserRoleEnum`.
        *   **Specific Route Modifications:**
            *   The root path (`/`) was uncommented and changed to render `LoginScreen` within `AuthGuard`.
            *   A `/logout` path was added for `Auth0LogoutHandler`.
            *   The `booking` route was updated to use `BookingDashbaordScreenExtend` instead of `BookingDashbaordScreen`.
            *   The `booking/form` route was updated to use `AgentBookingFormScreenExtend` instead of `AgentBookingFormScreen`.
            *   A new route `booking/form/po_form` was added, rendering `AgentPoFormExtend`.
            *   New `isf_dashboard` routes were introduced for `ISFDashboardScreen` and its form.
            *   New `spr` related routes for `spr_dashboard`, `portmaster`, and `city_master` were added.
            *   OTM BOL routes for `upload`, `add`, and `edit` were added.
            *   Detention routes for `linewise` and `customerwise` were added.
            *   Commercial Invoice routes (`commercial_invoice`, `commercial_invoice/form`) were added.
            *   The file shows a partial `agent_po/form` route at the end, suggesting further additions or truncation.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\pages\booking\AgentBookingConfirmation.jsx`**
    *   **Timestamp:** 1/2/2026, 2:59:06 PM.
    *   **Key Changes:** This component handles agent booking confirmation.
        *   **New Imports:** `ThemedModalExtend` and `AddVesselForm` (from `packing-list`) were imported, suggesting new modal functionality for adding vessels. `ScacCodeForm` and `UploadFile` were also imported. `FiDownload` and `FaHourglass` icons were added.
        *   **State Additions:** `openVesselModal` and `openScacModal` states were introduced, confirming the addition of modals for vessel and SCAC code management.
        *   **`useGetBookingConfirmQuery`:** The query for booking confirmation data now uses `initialValues?.agent_booking_id || ""` as a parameter, ensuring it fetches data only when an ID is available.
        *   **`useFetchBookingPlListQuery`:** The PL list fetching logic was updated to use `page: pagination.page + 1` and `perPage: pagination.pageSize` (though `page: 1` is fixed in the current query, with a large `perPage` implied for client-side filtering). It also includes `pl_status: "SUBMIT"` for empty keywords and `serial_id` for selected/deselected PLs. It now `skip`s fetching if `confirmData` is not yet loaded.
        *   **`useEffect` for selected PLs:** New `useEffect` hooks were added to load and initialize `selectedPl` from `confirmData` when it becomes available, ensuring existing selections are pre-filled.
        *   **Form Submission (`onSubmit`):**
            *   Includes a check for `initialValues?.agent_booking_id` to prevent submission if missing.
            *   Handles `do_document` file uploads using `FormData`.
            *   Sends `selectedPl` and `deselectedPl` arrays to the `updateDo` mutation.
            *   Implements conditional logic for `userAction` (`save_and_next`, `send-to-otm`).
            *   The "send-to-otm" action now triggers `generateXML` and `uploadXML` mutations, with success/error toasts and loaders.
            *   Improved error handling, specifically catching custom warning errors thrown for API warnings and displaying them in a `PopupAlert`.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\code\customer\CustomerForm.jsx`**
    *   **Timestamps:** 1/2/2026, 3:46:26 PM, 1/2/2026, 3:48:00 PM, 1/2/2026, 3:48:14 PM, 1/2/2026, 3:54:30 PM, and 1/2/2026, 4:36:47 PM.
    *   **Key Changes:** This component handles the form for adding/editing customer details.
        *   **Initial `3:46:26 PM`:**
            *   Introduced `CustomerMapping` component, which manages customer-to-customer mappings.
            *   The `formik` initial values were updated to include `customer_mapping` and initialize it if empty.
            *   `formData` submission logic was updated to stringify and append `customer_mapping` along with `mapping` and `files`.
            *   Added `handleIsfPartyOptionChange` to fetch "IMPORTER" options for "ISF Party Mapping" autocomplete.
        *   **`3:48:00 PM`:** Reverted the `customer_mapping` initialization logic within `formik`'s `initialValues` back to simply `initialValues`, removing the conditional check for `length`.
        *   **`3:48:14 PM`:** Reverted the `customer_mapping` initialization again, adding back the conditional `initialValues.customer_mapping?.length ? initialValues.customer_mapping : []`. This implies a back-and-forth on how `customer_mapping` should be initialized.
        *   **`3:54:30 PM`:** Added a `console.log("initialValues123456", initialValues);` for debugging purposes. No functional change.
        *   **`4:36:47 PM`:** No functional changes observed compared to the `3:54:30 PM` version. The `console.log` remains.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\code\customer\CustomerMapping.jsx`**
    *   **Timestamps:** 1/2/2026, 3:47:04 PM, 1/2/2026, 4:03:31 PM, 1/2/2026, 4:04:17 PM, 1/2/2026, 4:09:07 PM, 1/2/2026, 4:21:23 PM, 1/2/2026, 4:21:38 PM, 1/2/2026, 4:34:47 PM, 1/2/2026, 4:35:01 PM, and 1/2/2026, 4:35:58 PM.
    *   **Key Changes:** This component manages a list of customer mappings using `AppAutocomplete` and allows adding/deleting rows.
        *   **Initial `3:47:04 PM`:** Implements basic add/delete row functionality for `customer_mapping` within `formik`. Fetches customer options using `ApiManager.getCustomerOptions`.
        *   **`4:03:31 PM`:** Introduced logic in `deleteRow` to call `ApiManager.deleteCustomerOption` **only if** `rowToDelete.customer` has a value. If the API call fails, the UI deletion is prevented.
        *   **`4:04:17 PM`:** Changed `ApiManager.deleteCustomerOption` to `ApiManager.deleteCustomerOptions`. This suggests a renaming of the API method.
        *   **`4:09:07 PM`:** **Reverted** the `deleteRow` logic to no longer call a backend API. It now only filters the `mapping` array to remove the row from the UI. This undoes the backend deletion capability introduced at `4:03:31 PM`.
        *   **`4:21:23 PM`:** Reinstated backend deletion logic in `deleteRow`, but now specifically checks for `row.customer_id` and calls `ApiManager.deleteCustomerOption(row.customer_id)`.
        *   **`4:21:38 PM`:** Added a `console.log(row, "rowdata====");` for debugging.
        *   **`4:34:47 PM`:** Enhanced `deleteRow` with `toast.success` for successful deletion and `toast.info` for local row removal (if `customer_id` is missing). Also added `toast.error` for API failures.
        *   **`4:35:01 PM`:** Imported `toast` from `react-hot-toast`.
        *   **`4:35:58 PM`:** Removed comment lines (`/* --- */`). No functional change.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\services\Endpoints.js`**
    *   **Timestamps:** 1/2/2026, 4:01:34 PM, 1/2/2026, 4:08:51 PM, 1/2/2026, 4:20:10 PM, 1/2/2026, 4:20:25 PM, 1/2/2026, 4:25:35 PM, 1/2/2026, 4:32:00 PM, and 1/2/2026, 4:36:10 PM.
    *   **Key Changes:** This file defines API endpoints.
        *   **Initial `4:01:34 PM`:** `DELETE_CUSTOMER_OPTION` was defined as `(accountName) => `/deleteCustomerOption?account_name=${encodeURIComponent(accountName)}``.
        *   **`4:08:51 PM`:** Removed `DELETE_CUSTOMER_OPTION` entirely. This explains why `CustomerMapping.jsx` had a temporary removal of API calls for deletion.
        *   **`4:20:10 PM`:** `DELETE_CUSTOMER_OPTION` was re-added but incorrectly pointed to `getCustomerOptions` with a search parameter, which is a GET endpoint. This was likely a mistake.
        *   **`4:20:25 PM`:** `DELETE_CUSTOMER_OPTION` was corrected to `(customerId) => `/deleteCustomerOption/${customerId}``, implying a DELETE request to a specific ID.
        *   **`4:25:35 PM`:** `DELETE_CUSTOMER_OPTION` was changed to `(customerId) => `/delete/${customerId}``, making the path more generic.
        *   **`4:32:00 PM`:** `DELETE_CUSTOMER_OPTION` was changed again to `(customerId) => `/getCustomerOptions/delete/${customerId}``, making the path specific to customer options and deletion.
        *   **`4:36:10 PM`:** No functional change compared to the `4:32:00 PM` version.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\services\ApiManager.js`**
    *   **Timestamps:** 1/2/2026, 4:01:42 PM, 1/2/2026, 4:01:51 PM, 1/2/2026, 4:06:54 PM, 1/2/2026, 4:08:09 PM, 1/2/2026, 4:19:58 PM, and 1/2/2026, 4:36:34 PM.
    *   **Key Changes:** This file manages API calls using the defined endpoints.
        *   **Initial `4:01:42 PM`:** Had a duplicate `getCustomerOptions` definition. The second one incorrectly used `DELETE_CUSTOMER_OPTION` endpoint with `ApiMethods.get`.
        *   **`4:01:51 PM`:** Corrected the duplicate, renaming the second one to `deleteCustomerOptions` and still incorrectly using `ApiMethods.get` with the `DELETE_CUSTOMER_OPTION` endpoint.
        *   **`4:06:54 PM`:** `deleteCustomerOptions` was correctly changed to use `ApiMethods.delete` and the `DELETE_CUSTOMER_OPTION` endpoint. The parameter name was also made `accountName`.
        *   **`4:08:09 PM`:** `deleteCustomerOptions` was entirely removed, reflecting the change in `Endpoints.js`.
        *   **`4:19:58 PM`:** `deleteCustomerOption` (singular, with `customerId` parameter) was re-added, correctly using `ApiMethods.delete` and passing `customerId` to the endpoint.
        *   **`4:36:34 PM`:** No functional change compared to the `4:19:58 PM` version.

### Timestamps of Significant Changes:

*   **1/2/2026, 2:26:45 PM - 1/2/2026, 2:26:51 PM:** Major frontend routing expansion in `App.js` with many new screens and protected routes.
*   **1/2/2026, 2:59:06 PM:** Significant refactoring and feature addition in `AgentBookingConfirmation.jsx`, including XML generation/upload, improved PL data fetching, and robust error handling.
*   **1/2/2026, 3:46:26 PM:** Introduction of `CustomerMapping.jsx` and its integration into `CustomerForm.jsx`, enabling dynamic customer mapping functionality.
*   **1/2/2026, 4:03:31 PM - 1/2/2026, 4:21:23 PM:** Back-and-forth changes in `CustomerMapping.jsx` and related API definitions in `Endpoints.js` and `ApiManager.js` concerning the implementation of backend deletion for customer mappings, eventually settling on a `DELETE` request with `customer_id`.
*   **1/2/2026, 4:34:47 PM:** Final refinement of `deleteRow` in `CustomerMapping.jsx` to include user feedback (toasts) for deletion actions.

### Patterns and Recurring Elements:

*   **Modular Component Development:** The project heavily uses React components (e.g., `Screen` components, `Form` components, `Providers`, `common` UI elements) indicating a modular and reusable architecture.
*   **Role-Based Access Control:** `ProtectedRoute` and `UserRoleEnum` are consistently used across `App.js` to enforce role-based access to various routes and features (ADMIN, CUSTOMER, AGENT, CSF, FRONTOFFICE, BACKOFFICE, SPR_CUSTOMER, ADMIN_V2). This is a strong recurring pattern.
*   **Formik for Form Management:** `useFormik` is extensively used in form components (`AgentBookingConfirmation.jsx`, `CustomerForm.jsx`) for handling form state, validation, and submission, suggesting a standardized approach to forms.
*   **Redux Toolkit Query (RTK Query):** The presence of `useAddCustomerMutation`, `useCreateBookingXmlMutation`, `useUploadBookingXmlMutation`, `useFetchBookingPlListQuery`, `useGetBookingConfirmQuery`, and `useUpdateDoMutation` indicates a strong reliance on RTK Query for data fetching and mutation, promoting a consistent data layer.
*   **Centralized API Management:** `ApiManager.js` and `Endpoints.js` work together to define and manage all API interactions, providing a single source of truth for API endpoints and methods.
*   **Toast Notifications:** `react-hot-toast` is consistently used across different components for providing user feedback (success, error, warning, loading messages).
*   **Autocomplete for Search/Selection:** `AppAutocomplete` is used in multiple forms for searching and selecting options (e.g., Sales Rep, City, Descartes Customer Mapping, ISF Party Mapping, Customer Mapping).
*   **Responsive Design:** `useMediaQuery` from `@mui/material` is used in `AgentBookingConfirmation.jsx` to adjust UI elements (like `pageSize`) based on screen size.
*   **Debugging Statements:** Repeated `console.log` statements (e.g., "TEST on Flow", "initialValues : ", "initialValues123456", "rowdata====") appear across changes, indicating active development and debugging.
*   **Iterative API Endpoint Refinement:** The `DELETE_CUSTOMER_OPTION` endpoint and its corresponding `ApiManager` method underwent several changes in URL structure and method type (from GET to DELETE, and path variations), suggesting an iterative process to finalize the API design or correct earlier misconfigurations.

## 4:04:08 PM
Across the `t360-backend-v2` repository, a series of updates were made to several query builder files (`transit.query.ts`, `teuService.ts`, `departure.query.ts`, `general.query.ts`, `container.query.ts`, `booking.query.ts`) around **January 2nd, 2026**, primarily between 4:59 PM and 5:47 PM. These changes are focused on refining the data retrieval logic and customization options for various analytics reports.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\transit.query.ts` (Timestamp: 1/2/2026, 4:59:40 PM):**
    *   The `transitQueryBuilder` function was enhanced to handle different transit report types.
    *   For "country\_of\_origin" reports, it now customizes chart type, selected columns (prioritizing `eta_pod`, `country_name`, `departure_date`, `t49_vessel_actualarrived_date`, `t49_vessel_actualdeparted_date`), and defines calculation configurations for actual, estimated, and estimated-actual transit times. It executes separate queries for each, storing results in `customizer.additionalData`.
    *   For "ScheduledTransitVsActualTransit" and "ScheduledTransitVsActualTransitMblWise" types, new SQL queries were introduced. These queries calculate the difference between actual and estimated transit durations (`t49_vessel_actualarrived_date - t49_vessel_actualdeparted_date` vs `inland_eta - departure_date`), grouped by `fileno || ',' || contno` or `fileno || ',' || mblno` respectively, and provide a percentage relative to the maximum difference.
    *   The `queryGenerator` function was detailed for "country\_of\_origin" reports, involving a join with `portmaster` and including logic to handle negative values and division by zero in percentage calculations.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\services\analytics\teuService.ts` (Timestamps: 1/2/2026, 5:00:42 PM and 5:00:53 PM):**
    *   The `getTEUReports` function was updated to dynamically construct TEU calculation queries.
    *   It now supports grouping by "country\_of\_origin" or "country\_of\_discharge", joining `mtr_tracking_data` with `portmaster` and calculating TEU based on container types (`t49_cont_type` or `cont_type`).
    *   For other grouping columns, the query calculates TEU, mapping "LONG BEACH" to "LOS ANGELES" for certain `pod` columns and assigning 'OTHERS' for null/empty values.
    *   The `mblwiseCondition` object defines a `DISTINCT ON` clause for ensuring unique container entries per voyage.
    *   The two commits for this file show identical content, indicating a minor, non-functional save or re-save.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\departure.query.ts` (Timestamp: 1/2/2026, 5:01:49 PM):**
    *   The `departureQueryBuilder` function was expanded to manage several departure-related reports.
    *   "BLReleaseKPI" now generates a stacked bar chart, categorizing the day difference between "Vessel Actual Departure Date" and "Batch Run Date" into "Equal/Less than 3 days" and "More than 3 days".
    *   "DelayedPOLDepartures" and "DelayedPOLDeparturesMblWise" calculate the sum of day differences when `t49_vessel_actualdeparted_date` is later than `departure_date`, grouped by `fileno || ',' || contno` or `fileno || ',' || mblno` respectively.
    *   "OriginalETAvsActualETA" and "OriginalETAvsActualETAMblWise" (partially shown) calculate the day difference between "Updated ETA Port Date" and "ETA POD", also grouped by `fileno || ',' || contno` or `fileno || ',' || mblno`.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\general.query.ts` (Timestamp: 1/2/2026, 5:03:05 PM):**
    *   The `generalQueryBuilder` now handles "TotalShipments" and "TotalShipmentsMblWise" reports.
    *   These reports use `UNION` queries to count distinct `fileno` (Shipment Count) and `voyage` (Container Count) or `mblno` (Mbl Count).
    *   Notably, the percentage calculation for these general reports is performed in JavaScript *after* the database query, rather than directly within the SQL.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\container.query.ts` (Timestamp: 1/2/2026, 5:03:44 PM):**
    *   The `containerQueryBuilder` was updated to support various container-related analytics.
    *   This includes "ContainerDischargevsContainerAvailable" (difference between `t49_cont_available_date`/`cont_available_date` and `cont_discharge_date`), "ContainerDischargeVsFinalDeliveryDate" (difference between `delivery_customer_date` and `cont_discharge_date`, filtered by `type_of_move`), "ContainerGateOutVsGateIn" (difference between `t49_empty_return_date`/`empty_return_date` and `t49_contno_out_gated`/`contno_out_gated`), and "ContainerOrVesselDischargeVsGateOut" (difference between `t49_contno_out_gated`/`contno_out_gated` and `cont_discharge_date`).

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\booking.query.ts` (Timestamps: 1/2/2026, 5:09:05 PM, 5:09:30 PM, 5:11:03 PM, 5:46:22 PM, 5:47:08 PM):**
    *   The `bookingQueryBuilder` handles "BookingDatetoActualDeparture" reports (both container and MBL-wise) which calculate the average day difference between "Live Actual Departed Date" and "Booking Date" by joining `mtr_tracking_data` with `agent_booking_entry`.
    *   Stacked bar chart versions ("BookingDatetoActualDepartureStackedBar", "BookingDatetoActualDepartureMblWiseStackedBar") categorize these day differences into predefined time bins (e.g., "Less than 1 week", "1 - 2 weeks").
    *   Multiple commits for this file show identical code, suggesting repeated saves without material changes.

**Patterns and Recurring Elements:**

*   **Consistent Date and Company Filtering:** All queries uniformly filter data by `departure_date` within a `fromDate` and `toDate` range and by `LOWER(account_name) = ANY (regexp_split_to_array(LOWER('${CompanyName}'), '\s*,\s*'))`, allowing multiple company names.
*   **Robust Date Validation:** Many queries include explicit checks for valid dates (`IS NOT NULL` and `!= '0001-01-01 00:00:00 BC'`) to prevent calculations with placeholder or invalid date entries.
*   **Prioritization of `t49_` Data:** A recurring `CASE WHEN t49_... IS NOT NULL THEN t49_... ELSE ... END` pattern is used, indicating that `t49_` prefixed columns (e.g., `t49_cont_type`, `t49_vessel_actualdeparted_date`) are considered more authoritative or up-to-date.
*   **`DISTINCT ON` for Uniqueness:** The `DISTINCT ON (voyage,contno, CASE WHEN t49_cont_type IS NOT NULL ... END)` clause is widely used in subqueries to ensure unique records for aggregation, particularly when calculating differences involving containers.
*   **Percentage Calculations:** Most analytical reports calculate a `percentage` based on a value relative to a maximum value, often with specific handling for division by zero or negative values.
*   **Modular Query Building:** The codebase is structured with separate query builder files for different analytics categories (transit, departure, container, booking, general), each dynamically generating SQL based on the report `type` and user `customizer` settings.
*   **Customizer Object for Report Configuration:** The `customizer` object is central to configuring report behavior, including `chartType`, `calType`, `dateRange`, `dateColumns`, `calColumnConfig`, and `selectedColumns` (often populated via `getColumnsByCategory`).
*   **Clustered Timestamps:** The concentration of changes within a ~45-minute window on January 2nd, 2026, suggests a focused development or deployment activity for these analytics modules.

## 4:16:50 PM
The provided log details changes across two files within a JavaScript learning environment, primarily focusing on basic HTML structure and JavaScript variable declarations.

**File: `c:\Users\ridap\OneDrive\Documents\javascript-learning\index.html`**
This file, updated between 1/4/2026, 3:18:32 PM and 3:18:41 PM, represents a simple HTML document.
Initially, it contained a basic `<h1>Hello world!</h1>` heading and an empty `<button>` element with an `onclick` attribute triggering an alert.
A subsequent change, occurring just seconds later, added the text "Click me" inside the button, making it visible and interactive.

**File: `c:\Users\ridap\OneDrive\Documents\javascript-learning\0_variables.js`**
This JavaScript file underwent several iterations between 1/4/2026, 3:36:06 PM and 3:45:41 PM, demonstrating a clear progression in learning JavaScript variables.
*   It began with a simple `console.log("Hello my first js code!";)` statement (initial commit at 3:36:06 PM), which was quickly corrected for a syntax error (extra semicolon inside the string literal) by 3:36:47 PM.
*   Further updates (3:38:49 PM - 3:38:57 PM) introduced the declaration and logging of a `myAge` variable using `var`, alongside a comment referencing "camel case" variable naming convention.
*   A significant expansion at 3:45:07 PM added more variable declarations (`my_firtsName`, `_lastName`, `$myAge`), showcasing different valid naming styles. This update also included examples of *invalid* variable names (`123data`, `my@email`) which would cause syntax errors.
*   By 3:45:32 PM, the invalid variable examples (`123data` and `my@email`) were commented out, indicating an understanding of JavaScript's variable naming rules. The final entry for this file at 3:45:41 PM shows no functional change from the previous state.

**Patterns and Recurring Elements:**
The log demonstrates a typical learning process:
*   **Incremental Development:** Code is built up in small, manageable steps, adding new features or concepts one at a time.
*   **Error Correction:** Initial syntax errors (e.g., in `console.log` and invalid variable names) are identified and corrected or commented out, reflecting an active debugging and learning cycle.
*   **Concept Exploration:** The `0_variables.js` file specifically explores different aspects of variable declaration and naming conventions in JavaScript.
*   **Timestamps:** The close proximity of timestamps for changes within the same file (e.g., multiple changes to `0_variables.js` within minutes) suggests active, focused work sessions.

## 6:07:31 PM
The changes log details updates across two files: `index.html` and `0_variables.js`, both located in a `javascript-learning` directory.

**File: `c:\Users\ridap\OneDrive\Documents\javascript-learning\index.html`**
*   **1/4/2026, 3:18:32 PM**: The initial setup of an HTML page was committed. It included a basic structure with a `meta` viewport tag, a `title` (Document), an `h1` tag displaying "Hello world!", and a button that, when clicked, triggers an `alert` message "welcome to my js tutorials".
*   **1/4/2026, 3:18:41 PM**: A minor but user-facing update was made, adding the text "Click me" to the button element.

**File: `c:\Users\ridap\OneDrive\Documents\javascript-learning\0_variables.js`**
*   **1/4/2026, 3:36:06 PM**: The file was initialized with a `console.log("Hello my first js code!";)`.
*   **1/4/2026, 3:36:47 PM**: A syntax error was corrected by removing an extraneous semicolon within the string of the `console.log` statement, changing it to `console.log("Hello my first js code!");`.
*   **1/4/2026, 3:38:49 PM**: Variable declaration was introduced. The code added a comment `// camel` and declared `var myAge = 25;`, immediately logging its value to the console.
*   **1/4/2026, 3:38:57 PM**: The comment was refined to `// camel case`.
*   **1/4/2026, 3:45:07 PM**: Significant expansion on variable declarations occurred, exploring different naming conventions. Variables `my_firtsName` (assigned "Rida"), `_lastName` (assigned "Parveen"), and `$myAge` (assigned 25) were added, each followed by a `console.log`. Additionally, two invalid variable declarations, `123data = "some data"` and `my@email = "rida@gmail.com"`, were introduced, likely for testing naming rules.
*   **1/4/2026, 3:45:32 PM**: The previously added invalid variable declarations (`123data` and `my@email`) were commented out, indicating an understanding or correction of JavaScript variable naming rules.
*   **1/4/2026, 3:45:41 PM**: No functional changes were observed; the content remained identical to the previous timestamp, possibly a re-save.

**Patterns and Recurring Elements:**
The log shows a clear progression through basic JavaScript learning.
*   The `index.html` changes demonstrate initial setup and minor UI improvements.
*   The `0_variables.js` file, indicated by its "0_" prefix, focuses on foundational JavaScript concepts, starting with console output and rapidly moving into variable declaration and the exploration of variable naming conventions.
*   There's a consistent pattern of immediately logging the value of any newly declared variable using `console.log()`, which is common practice during learning and debugging.
*   The timestamps, particularly within the `0_variables.js` file, suggest a rapid, iterative process of coding, testing, and refining (e.g., fixing syntax, correcting comments, exploring invalid syntax, then commenting it out).

## 6:07:43 PM
The provided log details changes across several files in a React frontend application, primarily focusing on route management, booking confirmation logic, and customer form functionalities, including a new customer mapping feature.

### File-Specific Updates:

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\App.js`**
    *   **1/2/2026, 2:26:45 PM & 1/2/2026, 2:26:51 PM**: Both entries for `App.js` show almost identical, extensive import lists and route definitions. The application utilizes `react-router-dom` for navigation, defining a large number of routes for various screens (e.g., Dashboard, User Management, Packing List, Service Invoice, Expense Code, Destination, Vendor, Customer, Party, Agent, Planboards, Detention, Commercial Invoice, Booking, Analytics, ALC, Reports, Tracking, Shipments, CNG Booking, City Master, Port Master, Air Tracking).
    *   The `AuthGuard` and `ProtectedRoute` components are consistently used to manage access based on user roles (`ADMIN`, `CUSTOMER`, `AGENT`, `CSF`, `FRONTOFFICE`, `BACKOFFICE`, `SPR_CUSTOMER`, `ADMIN_V2`).
    *   A significant change between the two timestamps is the commented-out default route `/` pointing to `<Auth0Login />` and its replacement with a route for `/` that renders `<LoginScreen />` within `AuthGuard`. This indicates a shift in the primary login flow, possibly de-emphasizing Auth0 or providing a more direct login page.
    *   Multiple console logs like `console.log(" ~ file: App.js:2 ~ TEST on Flow");` appear, suggesting debugging or temporary testing messages.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\pages\booking\AgentBookingConfirmation.jsx`**
    *   **1/2/2026, 2:59:06 PM**: This file details the `AgentBookingConfirmation` component. It uses `Formik` for form management, `Material-UI` for UI, and `react-hot-toast` for notifications.
    *   Key functionalities include:
        *   Fetching and displaying a list of packing lists (`useFetchBookingPlListQuery`).
        *   Handling file uploads (e.g., `do_document`).
        *   Creating and uploading booking XML files (`useCreateBookingXmlMutation`, `useUploadBookingXmlMutation`).
        *   Updating booking details (`useUpdateDoMutation`).
        *   Managing selected and deselected packing lists.
        *   Displaying responsive pagination and sorting for data grids.
        *   Implementing validation (`bookingConfirmationValidation`) and displaying success/error/warning toasts.
        *   The form handles values like `booking_no_line`, `booking_date`, `do_number`, `do_date`, `vessel`, and `pl_status`.
    *   There's a specific logic flow for "save\_and\_next" and "send-to-otm" actions, involving toast messages for loading states during XML generation and upload.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\code\customer\CustomerForm.jsx`**
    *   **1/2/2026, 3:46:26 PM**, **3:48:00 PM**, **3:48:14 PM**, **3:54:30 PM**, **4:36:47 PM**: These entries show iterative changes to the `CustomerForm` component.
    *   Initializes state for autocomplete options (Sales Rep, Descartes Customer, ISF Party, City) and uploaded files.
    *   Uses `Formik` for managing customer form data and validation (`CustomerValidationSchema`).
    *   The `onSubmit` logic handles appending form fields, file uploads, and stringified JSON for `mapping` and `customer_mapping` to a `FormData` object before submitting via `useAddCustomerMutation`.
    *   Handles autocomplete option changes for various fields by calling `ApiManager` methods.
    *   Includes a `CustomerMapping` component (details below) for managing customer-specific mappings.
    *   A minor change at **3:48:00 PM** removed the explicit initialization of `customer_mapping` within `formik`'s `initialValues`, relying on `initialValues` directly. This was then reverted at **3:48:14 PM** to explicitly check `initialValues.customer_mapping?.length` before setting it, ensuring an empty array is used if no initial mappings exist.
    *   The entry at **3:54:30 PM** adds a `console.log("initialValues123456", initialValues);`, likely for debugging. The final entry at **4:36:47 PM** reverts this specific console log, returning to a cleaner state.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\code\customer\CustomerMapping.jsx`**
    *   **1/2/2026, 3:47:04 PM**, **4:03:31 PM**, **4:04:17 PM**, **4:09:07 PM**, **4:21:23 PM**, **4:21:38 PM**, **4:34:47 PM**, **4:35:01 PM**, **4:35:58 PM**: This file is dedicated to managing customer mappings within a form.
    *   It uses `AppAutocomplete` for selecting customers and provides add/delete functionality for mapping rows.
    *   `fetchCustomers` is a `useCallback` hook to fetch customer options dynamically based on search keywords from `ApiManager.getCustomerOptions`.
    *   **3:47:04 PM**: Initial implementation of adding and deleting rows locally (Formik state).
    *   **4:03:31 PM**: Introduction of an `ApiManager.deleteCustomerOption` call within `deleteRow` if `rowToDelete.customer` exists, with error handling. This also added a `return;` if the API call fails, preventing UI deletion.
    *   **4:04:17 PM**: The `deleteCustomerOption` call was changed to `ApiManager.deleteCustomerOptions` (plural), indicating a potential rename of the API method.
    *   **4:09:07 PM**: The backend API call for deletion was **removed** from `deleteRow`, reverting to purely local state management for deletion.
    *   **4:21:23 PM** & **4:21:38 PM**: The `deleteRow` function was re-introduced with backend deletion logic. It now checks for `row.customer_id` and calls `ApiManager.deleteCustomerOption(row.customer_id)`. A `console.log(row, "rowdata====");` was added for debugging purposes in the latter timestamp.
    *   **4:34:47 PM** & **4:35:01 PM** & **4:35:58 PM**: Further refinements to `deleteRow` were made, adding `toast.success` for successful deletion and `toast.info` for local row removal (if no `customer_id` is present). `toast.error` was also added for API failures. `toast` import was added at **4:35:01 PM**. The `console.log` from **4:21:38 PM** was removed in the final entry.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\services\Endpoints.js`**
    *   **1/2/2026, 4:01:34 PM**: Initially defined `DELETE_CUSTOMER_OPTION` with `accountName` as a query parameter in the URL.
    *   **1/2/2026, 4:08:51 PM**: `DELETE_CUSTOMER_OPTION` endpoint definition was removed. This temporarily left `ApiManager.deleteCustomerOptions` without a clear endpoint definition, which would have caused an error.
    *   **1/2/2026, 4:20:10 PM**: `DELETE_CUSTOMER_OPTION` was re-added but incorrectly pointed to the same endpoint as `GET_CUSTOMER_OPTIONS` (a GET request for customer options). This would have caused issues if actually used for deletion.
    *   **1/2/2026, 4:20:25 PM**: `DELETE_CUSTOMER_OPTION` was corrected to `(customerId) => `/deleteCustomerOption/${customerId}``. This suggests a RESTful DELETE endpoint for a specific customer ID.
    *   **1/2/2026, 4:25:35 PM**: `DELETE_CUSTOMER_OPTION` was changed to `(customerId) => `/delete/${customerId}``. This is a more generic `delete` endpoint, possibly for customer-related data.
    *   **1/2/2026, 4:32:00 PM** & **4:36:10 PM**: `DELETE_CUSTOMER_OPTION` was finalized to `(customerId) => `/getCustomerOptions/delete/${customerId}``. This explicitly targets a delete operation within the `getCustomerOptions` API group.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\services\ApiManager.js`**
    *   **1/2/2026, 4:01:42 PM**: Defined `getCustomerOptions` and `deleteCustomerOptions`. The `deleteCustomerOptions` method incorrectly called `ENDPOINTS.DELETE_CUSTOMER_OPTION(search)` using `ApiMethods.get`, and `ENDPOINTS.DELETE_CUSTOMER_OPTION` was defined as fetching data.
    *   **1/2/2026, 4:01:51 PM**: `deleteCustomerOptions` method was explicitly renamed from `getCustomerOptions` (the second definition was a typo). The method still used `ApiMethods.get`.
    *   **1/2/2026, 4:06:54 PM**: The `deleteCustomerOptions` method was updated to correctly use `ApiMethods.delete(url)` and accept `accountName` as a parameter.
    *   **1/2/2026, 4:08:09 PM**: The `deleteCustomerOptions` method definition was **removed**. This aligns with the temporary removal of the corresponding endpoint definition in `Endpoints.js`.
    *   **1/2/2026, 4:19:58 PM** & **4:36:34 PM**: The `deleteCustomerOption` (singular, possibly a correction) method was re-added. It now takes `customerId` and correctly uses `ApiMethods.delete` with the appropriate endpoint from `ENDPOINTS.DELETE_CUSTOMER_OPTION(customerId)`.

### Patterns and Recurring Elements:

*   **Timestamps:** All changes occurred on **1/2/2026**, primarily between 2:26 PM and 4:36 PM, indicating a focused development session on related features.
*   **React/MUI/Formik Stack:** The frontend consistently uses React, Material-UI for components (`Grid`, `Box`, `IconButton`, `AppAutocomplete`, `InputBox`, `SelectBox`), and Formik for robust form management and validation.
*   **API Management (`ApiManager` and `Endpoints.js`):** There's a clear separation of API endpoint definitions (`Endpoints.js`) and API call logic (`ApiManager.js`). This pattern facilitates organization and maintainability.
*   **`ProtectedRoute` and `AuthGuard`:** Access control is a critical recurring theme across `App.js`, with detailed role-based authorization for almost every route. This suggests a multi-role application where different user types have distinct permissions.
*   **Dynamic Data Fetching and Autocomplete:** Many components, especially forms, rely on dynamic data fetching for dropdowns and autocompletes (`getSalesOptions`, `getCityOptions`, `getCommonOptions`, `getCustomerOptions`), indicating a highly interactive user experience.
*   **Toast Notifications:** `react-hot-toast` is heavily used for user feedback, providing success, error, info, and loading messages consistently.
*   **Debugging (`console.log`):** Frequent `console.log` statements (e.g., "TEST on Flow", "initialValues : ", "rowdata====") appear and are sometimes added/removed, suggesting active debugging during development.
*   **Customer Mapping Feature:** A new feature for "Customer Mapping" is being developed, which involves managing a list of linked customers within a form, including adding, updating, and deleting these mappings, with backend integration for deletion.
*   **`initialValues` and `enableReinitialize` in Formik:** Formik forms frequently use `initialValues` and `enableReinitialize: true`, indicating that forms are often pre-populated with data and should re-render if `initialValues` change.
*   **File Uploads:** The `CustomerForm` explicitly handles file uploads using `FormData`, indicating a requirement for attaching documents to customer records. Similarly, `AgentBookingConfirmation` handles "do\_document" uploads.
*   **XML Generation/Upload:** The `AgentBookingConfirmation` flow includes distinct steps for generating and uploading XML data to "otm," highlighting integration with external systems or specific data interchange requirements.

## 6:07:45 PM
**File: c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\analytics\query\booking.query.ts**
**Timestamp: 1/2/2026, 2:35:49 PM**
This file introduces new analytics queries for booking data. It defines an interface `QueryBuilderI` and implements the `bookingQueryBuilder` function. This function constructs SQL queries based on the `type` parameter, generating reports for:
*   **BookingDatetoActualDeparture**: Calculates the average day difference between booking date and actual departure date, grouped by file and container number, including a percentage relative to the maximum value.
*   **BookingDatetoActualDepartureMblWise**: Similar to the above, but grouped by file and MBL (Master Bill of Lading) number.
*   **BookingDatetoActualDepartureStackedBar**: Categorizes the day differences into time ranges (e.g., "Less than 1 week", "1 - 2 weeks") and generates a stacked bar chart query. It dynamically uses `getFilterQueryByDisplayValue` for aggregation.
*   The code also includes a partial implementation for `BookingDatetoActualDepartureMblWiseStackedBar`, suggesting an MBL-wise version of the stacked bar chart is also being developed.
The `customizer` object is extensively used to configure report parameters like date ranges, calculation types, and columns to be ignored or included.

**File: c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\getCustomerOptions.ts**
**Timestamp: 1/2/2026, 3:58:49 PM - 4:31:23 PM (Multiple Changes)**
This controller manages customer options.
*   **Initial Change (3:58:49 PM)**: The `getAllCustomerOptions` function was significantly refactored. Previously, it contained extensive commented-out logic for role-based (AGENT/CUSTOMER) and paginated fetching of customer names. The current implementation simplifies this to fetch distinct `account_name` values from `mtr_tracking_data` with a search filter (`req.query.search`) and a limit of 10. A new `deleteCustomerOption` function was added, initially expecting `account_name` in the request body to delete records from `mtr_tracking_data`.
*   **Subsequent Changes (4:17:54 PM - 4:31:23 PM)**: There was a series of rapid iterations to fix the `deleteCustomerOption` function:
    *   It was updated to retrieve `customer_id` from `req.params` instead of `account_name` from `req.body`, and the SQL query changed to `DELETE FROM mtr_tracking_data WHERE customer_id = $1`.
    *   The SQL query was then corrected to `DELETE FROM mtr_tracking_data WHERE id = $1`, suggesting `id` is the correct identifier column.
    *   Finally, the target table for deletion was changed from `mtr_tracking_data` to `Account_Master_Customer_MAP`, indicating that the `customer_id` in the route parameter refers to an entry in this mapping table.
    *   Debugging `console.log` statements were also added and refined during these changes.

**File: c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\routes\getCustomerOptionsRoute.ts**
**Timestamp: 1/2/2026, 3:59:33 PM - 4:28:07 PM (Multiple Changes)**
This file defines API routes for customer options.
*   **Initial Change (3:59:33 PM)**: Set up a GET route for `getAllCustomerOptions` at `/` and a DELETE route for `deleteCustomerOption` also at `/`.
*   **Subsequent Changes (3:59:43 PM - 4:18:20 PM)**: The DELETE route was modified from `/` to `/delete`. Later, it was further updated to include a `customer_id` path parameter (`/delete/:customer_id`) to align with the changes made in the `deleteCustomerOption` controller function.

**File: c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\code.controller.ts**
**Timestamp: 1/2/2026, 4:12:38 PM - 4:14:13 PM (Multiple Changes)**
This controller handles comprehensive customer management.
*   **Initial Change (4:12:38 PM)**:
    *   `getAllCustomer` function was implemented to fetch detailed customer information from `PO_AccountMaster_Customer_Master`. It supports pagination, ordering, and dynamic search based on query parameters matching table columns. It also retrieves associated data like shipper mappings from `account_master_shipper_MAP`, uploaded documents from `document_upload_details`, and customer mappings from `Account_Master_Customer_MAP`.
    *   `createCustomer` function was added to handle creation and modification of customer records. It uses an `upload` utility, begins a database transaction, checks for existing customers to determine if it's a 'NEW' or 'Modify' operation, and generates account codes if new. It inserts/updates the main `PO_AccountMaster_Customer_Master` table, `agent_po_account_master_type`, and parses `mapping` data to populate `Account_Master_Shipper_MAP`, involving lookups for `polcode`, `shippercode`, and `agentcode`.
*   **Subsequent Change (4:14:13 PM)**: In the `getAllCustomer` function, the `customerQuery` was updated to also select the `id` column from `Account_Master_Customer_MAP`, and this `id` is now included in the `customer_mapping` data as `customer_id`.

**Patterns and Recurring Elements:**
*   **Concentrated Development**: All changes occurred on the same date (1/2/2026) within a short timeframe, indicating a focused development session.
*   **Database-Centric Operations**: The codebase heavily relies on direct SQL queries (`query()` function) for data retrieval, insertion, and deletion, suggesting a PostgreSQL backend due to the parameter syntax (`$1`) and specific date/time functions.
*   **Customer Management Focus**: A significant portion of the work is dedicated to customer-related functionalities, including detailed fetching, creation, modification, and deletion. This includes handling various related data such as shipper mappings and document uploads.
*   **Analytics Expansion**: New analytics queries are being developed for booking data, showing an effort to enhance reporting capabilities with diverse visualization types (average, stacked bars) and grouping options.
*   **Iterative Refinement**: The multiple changes to `getCustomerOptions.ts` and `getCustomerOptionsRoute.ts` demonstrate an iterative process of development, debugging, and correcting API endpoints and database interactions, particularly around identifying and deleting customer records.
*   **Logging**: `console.log` and `logger.info`/`logger.error` statements are frequently used for debugging and operational visibility.

## 6:07:57 PM
The changes, all occurring on January 2nd, 2026, within a concentrated timeframe, focus on enhancing the analytics and reporting capabilities of the `t360-backend-v2` application, primarily through dynamic SQL query generation for various data insights.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\transit.query.ts` (Timestamp: 1/2/2026, 4:59:40 PM):**
    *   Introduces a `transitQueryBuilder` for generating complex SQL queries related to transit times.
    *   Handles different report types such as "country_of_origin", "ScheduledTransitVsActualTransit", and "ScheduledTransitVsActualTransitMblWise".
    *   Configures report display (e.g., `chartType`, `calType`, `calColumnConfig`) and dynamically selects relevant columns.
    *   Calculates transit time differences (actual vs. estimated) and their percentages, often grouped by `fileno || ',' || contno` or `fileno || ',' || mblno`.
    *   Utilizes a `queryGenerator` helper function to abstract common query logic for different transit reports.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\services\analytics\teuService.ts` (Timestamps: 1/2/2026, 5:00:42 PM; 1/2/2026, 5:00:53 PM):**
    *   The `getTEUReports` service function is defined to fetch TEU (Twenty-foot Equivalent Unit) analytics.
    *   Dynamically builds SQL queries based on `group_by_column` (e.g., "country_of_origin", "country_of_discharge", or other columns).
    *   Calculates TEU values by processing `t49_cont_type` or `cont_type` and converts them to numeric.
    *   Includes specific logic to map 'LONG BEACH' to 'LOS ANGELES' for certain columns like 'pod' or 'place_of_delivery'.
    *   The two timestamps show identical code content, suggesting a save operation rather than a functional change.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\departure.query.ts` (Timestamp: 1/2/2026, 5:01:49 PM):**
    *   The `departureQueryBuilder` is responsible for queries related to departure performance.
    *   Supports various report types like "BLReleaseKPI" (a stacked bar chart categorizing BL release delays), "DelayedPOLDepartures" (container-wise), "DelayedPOLDeparturesMblWise" (MBL-wise), "OriginalETAvsActualETA", and "OriginalETAvsActualETAMblWise".
    *   Calculates day differences for KPIs such as "Vessel Actual Departure Date - Batch Run Date" or "Live Actual Departed Date - Departure Date".

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\general.query.ts` (Timestamp: 1/2/2026, 5:03:05 PM):**
    *   Provides a `generalQueryBuilder` for basic shipment and container count reports.
    *   "TotalShipments" calculates distinct `fileno` (shipments) and distinct `voyage` (containers).
    *   "TotalShipmentsMblWise" calculates distinct `fileno` (shipments) and distinct `mblno` (MBLs).
    *   Calculates value and percentage relative to the maximum count for presentation.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\container.query.ts` (Timestamp: 1/2/2026, 5:03:44 PM):**
    *   The `containerQueryBuilder` focuses on container movement analytics.
    *   Includes reports for "ContainerDischargevsContainerAvailable", "ContainerDischargeVsFinalDeliveryDate", "ContainerGateOutVsGateIn", and "ContainerOrVesselDischargeVsGateOut".
    *   Calculates date differences for various container milestones (e.g., availability minus discharge, delivery minus discharge, empty return minus gate out).
    *   Prioritizes `t49_` prefixed date columns as primary data sources.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\booking.query.ts` (Timestamps: 1/2/2026, 5:09:05 PM; 1/2/2026, 5:09:30 PM; 1/2/2026, 5:11:03 PM; 1/2/2026, 5:46:22 PM; 1/2/2026, 5:47:08 PM):**
    *   The `bookingQueryBuilder` handles analytics related to the booking process.
    *   Features reports for "BookingDatetoActualDeparture" (container-wise and MBL-wise, both average and stacked bar versions).
    *   Calculates the average day difference between booking date and actual vessel departure date.
    *   Stacked bar reports categorize these day differences into predefined time buckets (e.g., 'Less than 1 week', '1 - 2 weeks').
    *   Multiple identical timestamps for this file suggest frequent saves or minor non-functional changes during a development session.

**Patterns and Recurring Elements:**

*   **Timestamp Concentration:** All recorded changes occurred on the same day, January 2nd, 2026, within a span of approximately 48 minutes. This indicates a focused development or refactoring effort on analytics features.
*   **Dynamic SQL Generation:** A dominant pattern is the dynamic construction of PostgreSQL queries using template literals (backticks) based on various input parameters like report type, company name, date ranges, and grouping columns.
*   **`mtr_tracking_data` as Primary Source:** Most queries revolve around the `mtr_tracking_data` table, suggesting it's the central repository for logistics tracking information.
*   **Date Range and Company Filtering:** All queries consistently include filters for a date range (`departure_date >= '${fromDate}'::timestamp AND departure_date < '${toDate}'::timestamp + INTERVAL '1 day'`) and `account_name` (allowing multiple company names via `regexp_split_to_array`).
*   **Handling Invalid Dates:** There's a consistent pattern of checking for and excluding invalid date entries, specifically `'0001-01-01 00:00:00 BC'`.
*   **`customizer` Object:** A `customizer` object is used across files to configure various aspects of the report, including `dateRange`, `calType` (e.g., "avg", "total", "NA"), `dateColumns`, `calColumnConfig` (defining calculation keys and names), and `chartType` (e.g., "StackedBar", "transitBar").
*   **Dynamic Column Selection (`getColumnsByCategory`):** The utility function `getColumnsByCategory` is widely used to fetch relevant columns for each report, often ignoring common fields like `bookingdate`, `est_cargo_ready_date`, `networkdays`, `bl_release_date`, `country_name` and including specific `must` fields depending on the report.
*   **Percentage Calculation:** Many reports include logic to calculate the percentage of a value relative to the maximum absolute value within the result set, often with safeguards against division by zero or negative percentages.
*   **Container vs. MBL-Wise Reports:** There's a clear distinction and implementation for both container-level (`fileno || ',' || contno`) and MBL-level (`fileno || ',' || mblno`) aggregations across different report types.
*   **Prioritizing `t49_` Columns:** When multiple columns exist for similar data (e.g., `t49_cont_type` vs. `cont_type`, `t49_vessel_actualarrived_date` vs. `eta_pod`), the `t49_` prefixed columns are often given precedence, implying they represent "live" or more accurate tracking data.
*   **Logging:** `console.log` or `logger.info` statements are present to log generated SQL queries, aiding in debugging and monitoring.

## 8:01:12 PM
The `index.html` file saw initial creation and a minor update. On 1/4/2026 at 3:18:32 PM, a basic HTML page was created with a "Hello world!" heading and an interactive button that triggers an alert on click. Nine seconds later, at 3:18:41 PM, the button was updated to display the text "Click me".

The `0_variables.js` file underwent several iterations, primarily focused on exploring JavaScript variable declarations. The first recorded change at 1/4/2026, 3:36:06 PM introduced a `console.log` statement with a syntax error (extra semicolon). This error was corrected at 3:36:47 PM. Subsequent changes introduced variable declarations:
*   At 3:38:49 PM, `var myAge = 25;` was added, along with a comment `// camel`.
*   This comment was corrected to `// camel case` at 3:38:57 PM.
*   A significant expansion occurred at 3:45:07 PM, where multiple variables were declared and logged: `my_firtsName` (string), `_lastName` (string), and `$myAge` (number). This update also included attempts to declare invalid variable names like `123data` and `my@email`, which were also logged.
*   By 3:45:32 PM, the invalid variable declarations (`123data` and `my@email`) and their corresponding `console.log` statements were commented out, indicating an understanding or correction of JavaScript naming rules.
*   The final entry at 3:45:41 PM showed no functional change, being identical to the previous version.

**Key Patterns and Recurring Elements:**

*   **Learning and Experimentation:** The changes across both files demonstrate a clear pattern of learning and experimentation, particularly evident in `0_variables.js` where different variable naming conventions (including invalid ones) are tried and then corrected or commented out.
*   **Incremental Development:** Changes are small and iterative, building upon previous versions (e.g., adding text to a button, fixing syntax, adding more variable examples).
*   **Focus on Fundamentals:** The content centers on basic web development concepts: a simple HTML structure, a JavaScript alert for user interaction, and core JavaScript variable declaration and logging.
*   **Timestamp Proximity:** Many changes occur within short timeframes, suggesting active, continuous development sessions.

## 8:01:26 PM
The changes primarily focus on the frontend application, specifically concerning routing, booking confirmation, customer management, and API endpoints.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\App.js`**
    *   **1/2/2026, 2:26:45 PM:** Extensive additions of new route imports and route definitions. This update significantly expands the application's navigation and introduces new screens for various functionalities such as:
        *   New tracking screens (FCL, LCL, Rail, Air Tracking).
        *   Booking related screens (`AgentBookingFormScreenExtend`, `BookingDashbaordScreenExtend`, `CngBookingScreen`, `CngBookingFormScreen`, `HblListDetails`).
        *   Report and scheduler screens (`ReportSchedulerScreen`, `NewReportScreen`, `EditReportScreen`).
        *   Dashboard and admin terminal screens (`Dashboard7501Screen`, `BackOfficeAdminTerminal`).
        *   ALC related screens (`AlcScreen`, `AlcFormScreen`, `AlcGenerated`, `SprAlcScreen`, `AlcExceptionDashboard`, `AlcDestinationCostRecord`).
        *   New master data screens (`CityMaster`, `PortmasterScreen`).
        *   PDF parsing (`PdfParserScreen`).
        *   Auth0 logout handler (`Auth0LogoutHandler`).
        *   General shipping orders (`ShippingOrdersScreen`).
        *   Container reports (`ContainerReportScreen`).
        *   SPR Invoice (`SprInvoiceScreen`).
        *   ISF Dashboard (`ISFDashboardScreen`).
        *   Updates to existing routes (e.g., `booking/form` now uses `AgentBookingFormScreenExtend` instead of `AgentBookingFormScreen`).
    *   **1/2/2026, 2:26:51 PM:** A minor change occurred, primarily un-commenting and changing the root path (`/`) to point to `LoginScreen` instead of `Auth0Login` (which was previously commented out). This makes the login screen the default entry point.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\pages\booking\AgentBookingConfirmation.jsx`**
    *   **1/2/2026, 2:59:06 PM:** This file was created or heavily updated to implement the `AgentBookingConfirmation` component. Key functionalities include:
        *   Form for booking confirmation using Formik and Material-UI components.
        *   State management for selected/deselected packing lists (`pl`).
        *   API integrations for fetching booking details (`useGetBookingConfirmQuery`, `useFetchBookingPlListQuery`), updating DO (`useUpdateDoMutation`), and generating/uploading booking XML (`useCreateBookingXmlMutation`, `useUploadBookingXmlMutation`).
        *   Error handling, including displaying toast messages and a `WarningToast` for non-critical issues during form submission or XML generation/upload.
        *   Conditional logic for handling "save and next" and "send-to-otm" actions.
        *   Includes components for file uploads (`SingleFileDropzone`, `UploadFile`), vessel forms, SCAC code forms, and a keyword search for linked POs.
        *   Responsiveness adjustments for page size based on screen size.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\code\customer\CustomerForm.jsx`**
    *   **1/2/2026, 3:46:26 PM:** Initial commit/update of the `CustomerForm` component. It uses Formik for form handling, various Material-UI components, and `ApiManager` for fetching autocomplete options (Sales Rep, Descartes Customer Mapping, ISF Party Mapping, City). It handles file uploads and includes `CustomerMapping` for managing customer associations. The initialValues for `customer_mapping` are set based on whether they exist.
    *   **1/2/2026, 3:48:00 PM:** Minor adjustment to Formik's `initialValues` property to directly use the `initialValues` prop, instead of using the spread operator on `initialValues` and then re-assigning `customer_mapping`. This might be a refactoring to ensure `customer_mapping` is always initialized correctly, potentially fixing a bug where it might not have been.
    *   **1/2/2026, 3:48:14 PM:** Reverted the previous change, re-adding `customer_mapping: initialValues.customer_mapping?.length ? initialValues.customer_mapping : [],` to explicitly ensure `customer_mapping` is an array, even if `initialValues` is not spread. This indicates a focus on robust initialization of array-type form fields.
    *   **1/2/2026, 3:54:30 PM:** Added a `console.log("initialValues123456", initialValues);` statement, likely for debugging purposes.
    *   **1/2/2026, 4:36:47 PM:** The `console.log` statement from the previous change was removed. No other functional changes observed in this specific log entry.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\code\customer\CustomerMapping.jsx`**
    *   **1/2/2026, 3:47:04 PM:** Initial commit of the `CustomerMapping` component. This component manages a dynamic list of customer mappings within a form, allowing users to add and delete rows. It uses `AppAutocomplete` for selecting customers and `ApiManager` for fetching customer options. It ensures at least one mapping row exists.
    *   **1/2/2026, 4:03:31 PM:** Introduced a change in the `deleteRow` function. It now attempts to call an `ApiManager.deleteCustomerOption` if a `customer` value exists in the row being deleted. If the API call fails, the UI delete is prevented. This adds backend integration to the row deletion logic.
    *   **1/2/2026, 4:04:17 PM:** Changed the API call in `deleteRow` from `ApiManager.deleteCustomerOption` to `ApiManager.deleteCustomerOptions`. This indicates a renaming of the API function or a correction of the function name.
    *   **1/2/2026, 4:09:07 PM:** Reverted the `deleteRow` logic back to only remove the row from the formik state, removing the API call to `ApiManager.deleteCustomerOptions` and the associated error handling. This suggests the deletion logic might be handled differently or was temporarily removed.
    *   **1/2/2026, 4:21:23 PM:** Re-introduced backend deletion logic to `deleteRow`. The API call is now `ApiManager.deleteCustomerOption(row.customer_id)`, indicating the API expects a `customer_id`. A `try...catch` block is used to handle potential errors during deletion.
    *   **1/2/2026, 4:21:38 PM:** Added a `console.log(row, "rowdata====");` statement in `deleteRow` for debugging purposes.
    *   **1/2/2026, 4:34:47 PM:** Enhanced the `deleteRow` function with user feedback (toast messages). It now shows a success toast on successful API deletion and an info toast if the row is removed from the UI without a backend ID. Error toasts are also added for API failures.
    *   **1/2/2026, 4:35:01 PM:** Imported `toast` from 'react-hot-toast' to support the toast messages added in the previous change.
    *   **1/2/2026, 4:35:58 PM:** No functional changes, primarily reformatting of comments to be above the corresponding code blocks.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\services\Endpoints.js`**
    *   **1/2/2026, 4:01:34 PM:** Updated the `GET_MENU` endpoint to support optional `v2_menu` and `ismenudrawer` parameters. Added `DELETE_CUSTOMER_OPTION` endpoint for deleting customer options by `accountName`.
    *   **1/2/2026, 4:08:51 PM:** Removed the `DELETE_CUSTOMER_OPTION` endpoint definition from `Endpoints.js`. This suggests a change in how customer deletion is handled or that the endpoint was deemed unnecessary at this level.
    *   **1/2/2026, 4:20:10 PM:** Re-added the `DELETE_CUSTOMER_OPTION` endpoint, but its implementation `(search = "") => \`/getCustomerOptions${search ? `?search=${encodeURIComponent(search)}` : ""}\`` is identical to `GET_CUSTOMER_OPTIONS`, implying a potential mistake or temporary placeholder. It's still a GET request.
    *   **1/2/2026, 4:20:25 PM:** Corrected the `DELETE_CUSTOMER_OPTION` endpoint to `(customerId) => \`/deleteCustomerOption/${customerId}\``. This correctly defines it as an endpoint for deleting a customer by ID and implies it's a DELETE operation.
    *   **1/2/2026, 4:25:35 PM:** Modified `DELETE_CUSTOMER_OPTION` endpoint to `(customerId) => \`/delete/${customerId}\``. This changes the base path for customer deletion.
    *   **1/2/2026, 4:32:00 PM:** Changed `DELETE_CUSTOMER_OPTION` endpoint back to `(customerId) => \`/getCustomerOptions/delete/${customerId}\``. This is a more specific path for deleting a customer option.
    *   **1/2/2026, 4:36:10 PM:** No functional changes, appears to be a re-save or minor whitespace change, as the code for `DELETE_CUSTOMER_OPTION` is identical to the previous entry.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\services\ApiManager.js`**
    *   **1/2/2026, 4:01:42 PM:** Added `getCustomerOptions` and `deleteCustomerOption` static methods. The `deleteCustomerOption` method was defined twice with the same name, but the second one was implicitly a `deleteCustomerOption` method that uses the `DELETE_CUSTOMER_OPTION` endpoint, with a bug as it was calling `ApiMethods.get` instead of `ApiMethods.delete`.
    *   **1/2/2026, 4:01:51 PM:** Renamed the second `getCustomerOptions` to `deleteCustomerOptions`. Corrected `deleteCustomerOptions` to use `ApiMethods.get` with `DELETE_CUSTOMER_OPTION` endpoint. This still seems incorrect for a "delete" operation if the endpoint is meant to be a DELETE.
    *   **1/2/2026, 4:06:54 PM:** Corrected the `deleteCustomerOptions` method to correctly use `ApiMethods.delete(url)` and accept `accountName` as a parameter. This aligns the `ApiManager` with a true DELETE operation for customer options.
    *   **1/2/2026, 4:08:09 PM:** Removed the `deleteCustomerOptions` method from `ApiManager.js`. This aligns with the temporary removal of the `DELETE_CUSTOMER_OPTION` endpoint from `Endpoints.js` around the same time.
    *   **1/2/2026, 4:19:58 PM:** Re-introduced `deleteCustomerOption` (singular name) method, now correctly using `ApiMethods.delete` and taking `customerId` as a parameter, matching the `Endpoints.js` definition.
    *   **1/2/2026, 4:36:34 PM:** No functional changes, appears to be a re-save or minor whitespace change, as the code for `deleteCustomerOption` is identical to the previous entry.

**Patterns and Recurring Elements:**

1.  **React Frontend Development:** All changes are within a React frontend application (`t360-frontend`).
2.  **Routing (`App.js`):**
    *   Heavy reliance on `react-router-dom` for navigation.
    *   Extensive use of `ProtectedRoute` and `AuthGuard` components to enforce role-based access control (`UserRoleEnum`). This is a strong, recurring pattern across almost all defined routes.
    *   Consistent naming convention for routes: `/app/{module}/{screen}` (e.g., `/app/code/customer`, `/app/spr/packing_list`).
    *   Continuous expansion of the application's feature set, indicated by the high number of new screen imports and route definitions.
3.  **Form Management (`CustomerForm.jsx`, `AgentBookingConfirmation.jsx`):**
    *   `Formik` is consistently used for handling form state, validation, and submission.
    *   `@mui/material` components are heavily utilized for UI (Grid, InputBox, AppAutocomplete, SelectBox, IconButton).
    *   `react-hot-toast` is used for displaying user feedback (success, error, loading, warning messages).
    *   `ApiManager` is the central service for making API calls.
4.  **API Integration (`ApiManager.js`, `Endpoints.js`, component files):**
    *   A clear separation of concerns between `Endpoints.js` (defining API URLs) and `ApiManager.js` (implementing static methods for API calls using `ApiMethods`).
    *   Frequent additions/modifications to `Endpoints.js` and `ApiManager.js` indicate active development of new backend functionalities or refinement of existing ones.
    *   Specific focus on customer-related API operations, particularly around fetching and deleting customer mapping entries, which saw several iterations and corrections.
    *   `useCallback` and `useEffect` hooks are used in components like `CustomerMapping` for efficient data fetching and lifecycle management.
5.  **Data Handling:**
    *   `FormData` is used for form submissions that include file uploads.
    *   JSON stringification (`JSON.stringify`) is used for submitting complex objects (like `mapping` or `customer_mapping` arrays) within `FormData`.
6.  **Debugging:** Occasional `console.log` statements appear in the code, especially in the `CustomerForm` and `CustomerMapping` components, suggesting active development and debugging sessions.
7.  **Customer Mapping:** The `CustomerMapping.jsx` and related API changes (in `ApiManager.js` and `Endpoints.js`) show a recurring theme of managing customer-to-customer relationships or mappings, including adding and deleting these mappings with backend synchronization. The deletion logic underwent several refinements to ensure correct API calls and error handling.