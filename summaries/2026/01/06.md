# Activity Summary for 1/6/2026

## 8:43:41 AM
The development log primarily details changes across two files within a `javascript-learning` directory.

**File: `c:\Users\ridap\OneDrive\Documents\javascript-learning\index.html`**
*   **Initial Setup (1/4/2026, 3:18:32 PM):** An HTML document was created with a basic structure, including a `<h1>` tag displaying "Hello world!" and an empty `<button>` element configured to show an alert "welcome to my js tutorials" when clicked.
*   **Button Text Added (1/4/2026, 3:18:41 PM):** Shortly after creation, the button's visible text was updated to "Click me".

**File: `c:\Users\ridap\OneDrive\Documents\javascript-learning\0_variables.js`**
*   **Initial Code and Correction (1/4/2026, 3:36:06 PM - 1/4/2026, 3:36:47 PM):** The file was first created with a `console.log("Hello my first js code!";)` statement containing a syntax error (extra semicolon). This error was corrected within a minute to `console.log("Hello my first js code!");`.
*   **Variable Introduction (1/4/2026, 3:38:49 PM - 1/4/2026, 3:38:57 PM):** The code was expanded to include a `var` declaration for `myAge = 25;` and its subsequent `console.log()`. A comment `// camel` was added and then refined to `// camel case`.
*   **Exploring Variable Naming (1/4/2026, 3:45:07 PM):** Significant additions demonstrated various variable naming conventions using `var`:
    *   `my_firtsName = "Rida";`
    *   `_lastName = "Parveen";`
    *   `$myAge = 25;`
    *   Attempts were made to declare invalid variables like `123data` (starting with a number) and `my@email` (containing a special character), followed by `console.log()` for each.
*   **Invalid Variable Declarations Commented Out (1/4/2026, 3:45:32 PM - 1/4/2026, 3:45:41 PM):** The previously added invalid variable declarations (`123data` and `my@email`) were commented out, indicating a learning or debugging step to understand valid JavaScript variable names. The final entry at 3:45:41 PM shows no functional change.

**Patterns and Recurring Elements:**
*   **Learning Progression:** The changes reflect a clear learning path for JavaScript, starting with basic HTML interaction, then moving to fundamental JavaScript concepts like `console.log` and variable declarations.
*   **Iterative Development and Refinement:** There are multiple small, incremental changes, including syntax corrections, comment refinements, and the process of attempting invalid code and then commenting it out, suggesting an iterative approach to understanding and writing code.
*   **Focus on Fundamentals:** The `0_variables.js` file specifically explores `var` declarations and variable naming rules, a core concept for beginners.
*   **Use of `console.log()`:** `console.log()` is used extensively throughout the JavaScript file to output and presumably test the values of declared variables.
*   **Consistent File Naming Convention:** The JavaScript file `0_variables.js` suggests a structured learning sequence (e.g., "0_" for the first topic).

## 1:46:47 PM
The changes log details development activities primarily within a `javascript-learning` directory, focusing on basic HTML structure and JavaScript variable concepts. All significant modifications occurred on **1/4/2026**.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\javascript-learning\index.html`**:
    *   Initiated on **1/4/2026, 3:18:32 PM**, with a basic HTML5 page containing an `<h1>Hello world!</h1>` and an empty `<button>` that triggers an `alert('welcome to my js tutorials')` on click.
    *   Shortly after, on **1/4/2026, 3:18:41 PM**, the button was updated to display "Click me" as its text content.

*   **`c:\Users\ridap\OneDrive\Documents\javascript-learning\0_variables.js`**:
    *   Started on **1/4/2026, 3:36:06 PM**, with a `console.log` statement that initially contained a syntax error (an extra semicolon inside the string).
    *   The syntax error was corrected by **1/4/2026, 3:36:47 PM**.
    *   By **1/4/2026, 3:38:49 PM**, the file began exploring JavaScript variables, introducing a `var myAge = 25;` and a comment `// camel`. The comment was slightly refined to `// camel case` by **1/4/2026, 3:38:57 PM**.
    *   A significant expansion occurred at **1/4/2026, 3:45:07 PM**, where multiple `var` declarations were added to demonstrate various naming conventions (e.g., `my_firtsName`, `_lastName`, `$myAge`). This also included attempts to declare invalid variable names like `123data` (starting with a number) and `my@email` (containing a special character).
    *   These invalid variable declarations were subsequently commented out by **1/4/2026, 3:45:32 PM**, indicating an understanding or demonstration of JavaScript variable naming rules.
    *   The final entry at **1/4/2026, 3:45:41 PM** shows no functional change, retaining the previously commented-out lines.

**Patterns and Recurring Elements:**

*   The file names (`0_variables.js`) and content suggest a structured learning process for JavaScript fundamentals, starting with basic output and progressing to variable declaration rules.
*   Frequent use of `console.log()` is observed across the `0_variables.js` file, indicating a common method for output and debugging during learning.
*   The progression in `0_variables.js` from basic `console.log` to exploring valid and invalid variable naming conventions highlights a focus on core language syntax.
*   All activities recorded occurred within a short timeframe on the same day, `1/4/2026`, suggesting an active learning or development session.

## 1:47:03 PM
The provided log details significant updates across multiple files related to data querying and analytics in a backend system. The changes primarily focus on how company names are handled in SQL queries, transitioning from a single company name string to a list of company names, likely to support multi-company filtering.

### File-Specific Updates:

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\transit.query.ts`**
    *   **Timestamp: 1/2/2026, 4:59:40 PM**: Initial comprehensive update of the `transitQueryBuilder` function. It now constructs queries for various transit-related reports (e.g., "country\_of\_origin", "ScheduledTransitVsActualTransit") based on `columnName` and `type` parameters. The function dynamically sets `customizer` properties (like `calType`, `chartType`, `selectedColumns`, `calColumnConfig`, `additionalData`) and generates complex SQL queries involving `mtr_tracking_data` and `portmaster` tables. It includes logic to handle `mblwiseCondition` and date filtering.
    *   **Timestamp: 1/5/2026, 8:32:12 PM & 1/5/2026, 8:34:19 PM & 1/5/2026, 8:42:52 PM**: Introduced `companyList` generation from `CompanyName` by splitting it by comma, trimming, lowercasing, and joining with commas for use in SQL's `IN` clause. This change was applied to the `LOWER(account_name) = ANY (regexp_split_to_array(LOWER('${CompanyName}'), '\\s*,\\s*'))` condition, changing it to `LOWER(account_name) IN (${companyList})`.
    *   **Timestamp: 1/6/2026, 10:33:35 AM & 1/6/2026, 10:33:41 AM**: The `companyList` generation logic was modified to split `CompanyName` by `"||"` instead of `","`.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\services\analytics\teuService.ts`**
    *   **Timestamp: 1/2/2026, 5:00:42 PM & 1/2/2026, 5:00:53 PM**: These entries show the `getTEUReports` service function. It fetches TEU (Twenty-foot Equivalent Unit) reports, grouping data by `columnName` (e.g., `country_of_origin`, `country_of_discharge`, or other columns). It dynamically builds SQL queries to calculate TEU values and percentages, handling different grouping criteria and date ranges. It also includes logic for container type parsing (`t49_cont_type`, `cont_type`) and port name normalization (e.g., "LONG BEACH" to "LOS ANGELES"). The service also initializes a `customizer` object for report display settings.
    *   **Timestamp: 1/5/2026, 8:41:46 PM & 1/5/2026, 8:42:05 PM**: Introduced `companyList` generation from `CompanyName` using comma splitting, trimming, lowercasing, and joining for use in SQL's `IN` clause, replacing `LOWER(account_name) = ANY (...)`.
    *   **Timestamp: 1/6/2026, 10:34:11 AM**: The `companyList` generation logic was modified to split `CompanyName` by `"||"` instead of `","`.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\departure.query.ts`**
    *   **Timestamp: 1/2/2026, 5:01:49 PM**: This file defines `departureQueryBuilder` for generating queries related to departure analytics. It supports multiple report types such as "BLReleaseKPI" (Stacked Bar Chart for BL Release), "DelayedPOLDepartures" (Delayed Departures at Port of Loading, container-wise and MBL-wise), and "OriginalETAvsActualETA" (Original vs Actual ETA, container-wise and MBL-wise). Each type has specific date columns, calculation types, and `getColumnsByCategory` configurations, generating complex SQL queries with date difference calculations and percentage reporting.
    *   **Timestamp: 1/5/2026, 2:45:27 PM & 1/5/2026, 3:11:08 PM**: Implemented `companyList` from `CompanyName` using comma splitting, trimming, lowercasing, and joining for use in SQL `IN` clause, replacing `LOWER(account_name) = ANY (...)`.
    *   **Timestamp: 1/6/2026, 10:32:55 AM**: The `companyList` generation logic was modified to split `CompanyName` by `"||"` instead of `","`.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\general.query.ts`**
    *   **Timestamp: 1/2/2026, 5:03:05 PM**: The `generalQueryBuilder` function was updated to handle "TotalShipments" and "TotalShipmentsMblWise" reports. It counts distinct `fileno` and `mblno`/`voyage` respectively. Queries include date range filtering and account name filtering using `regexp_split_to_array`. The results are processed to calculate percentages relative to a maximum value.
    *   **Timestamp: 1/5/2026, 1:56:51 PM & 1/5/2026, 1:58:41 PM & 1/5/2026, 2:13:45 PM & 1/5/2026, 2:16:07 PM & 1/5/2026, 2:17:37 PM & 1/5/2026, 2:18:01 PM & 1/5/2026, 2:18:07 PM & 1/5/2026, 3:13:21 PM**: Introduction of `companyList` construction for dynamically generating SQL `IN` clauses for `LOWER(account_name)`. This replaces the `regexp_split_to_array` approach.
    *   **Timestamp: 1/6/2026, 10:33:28 AM**: The `companyList` generation logic was modified to split `CompanyName` by `"||"` instead of `","`.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\container.query.ts`**
    *   **Timestamp: 1/2/2026, 5:03:44 PM**: This file defines `containerQueryBuilder` for generating queries related to container lifecycle events. It handles reports like "ContainerDischargevsContainerAvailable", "ContainerDischargeVsFinalDeliveryDate", "ContainerGateOutVsGateIn", and "ContainerOrVesselDischargeVsGateOut". Each report type sets specific `customizer` properties, including date columns, calculation types (`avg`), and uses `getColumnsByCategory` to define required columns. Complex SQL queries calculate time differences (e.g., `EXTRACT(DAY FROM date1 - date2)`) and percentages.
    *   **Timestamp: 1/5/2026, 2:42:51 PM**: Introduced `companyList` generation from `CompanyName` using comma splitting, trimming, lowercasing, and joining for use in SQL's `IN` clause, replacing `LOWER(account_name) = ANY (...)`.
    *   **Timestamp: 1/6/2026, 10:32:49 AM**: The `companyList` generation logic was modified to split `CompanyName` by `"||"` instead of `","`.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\booking.query.ts`**
    *   **Timestamp: 1/2/2026, 5:09:05 PM & 1/2/2026, 5:09:30 PM & 1/2/2026, 5:11:03 PM & 1/2/2026, 5:46:22 PM & 1/2/2026, 5:47:08 PM**: This file defines `bookingQueryBuilder` for generating queries related to booking analytics. It supports multiple report types including "BookingDatetoActualDeparture" (container and MBL-wise, as well as stacked bar versions). These queries involve joining `mtr_tracking_data` and `agent_booking_entry` tables to calculate time differences between booking dates and actual departure dates, then computing percentages. `customizer` properties like `dateRange`, `calType`, `dateColumns`, `booking`, `mblwise`, and `chartType` are dynamically set.
    *   **Timestamp: 1/5/2026, 2:11:12 PM & 1/5/2026, 2:35:38 PM & 1/5/2026, 2:36:53 PM & 1/5/2026, 3:15:46 PM & 1/5/2026, 3:16:18 PM & 1/5/2026, 3:18:06 PM & 1/5/2026, 3:33:22 PM & 1/5/2026, 8:36:00 PM**: Introduction of `companyList` construction for dynamically generating SQL `IN` clauses for `LOWER(account_name)`. This replaces the `regexp_split_to_array` approach. A `console.log` for "company90877" is present in most of these logs.
    *   **Timestamp: 1/6/2026, 10:27:27 AM**: The `companyList` generation logic was modified to split `CompanyName` by `"||"` instead of `","`.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\services\analytics\customerAutosearchOptions.ts`**
    *   **Timestamp: 1/5/2026, 10:14:20 AM - 1/5/2026, 12:43:34 PM (multiple logs)**: This file `getAllCustomerOptions` handles fetching customer and agent options for autosearch.
        *   Initially, it retrieves distinct `cname` for `AGENT` role and distinct `account_name` for `CUSTOMER` role, with pagination and search capabilities being progressively commented out and re-implemented.
        *   Between **10:14:20 AM** and **11:27:01 AM**, the `CUSTOMER` role query was commented out and then re-enabled, transitioning from `COUNT(DISTINCT account_name)` to `COUNT(*) FROM (SELECT 1 FROM ... GROUP BY account_name)` for total count, and using `GROUP BY account_name` for data fetching.
        *   At **11:32:39 AM**, the `CUSTOMER` role query changed to use `Account_Master_Customer_MAP` to fetch `customer_name` and an aggregated `customer_map` array for search.
        *   At **11:35:07 AM & 11:35:15 AM**, the `CUSTOMER` role logic was again commented out, then an alternative query using `PO_AccountMaster_Customer_Master` and `unnest(customer_map)` was implemented to search both `cname` and `mapped` customers.
        *   At **11:59:52 AM**, this `PO_AccountMaster_Customer_Master` query was refined to select `cname AS main_customer` and `COALESCE(customer_map, '{}') AS mapped_customers`, with client-side logic to flatten and deduplicate the results (main customer + mapped customers).
        *   At **12:10:43 PM**, the `PO_AccountMaster_Customer_Master` query was further modified to separate `cname` and `customer_map` columns explicitly for mapping, and a parsing logic for `{A,B}` string arrays was added.
        *   At **12:13:07 PM**, the `PO_AccountMaster_Customer_Master` query was changed to use `UNION` to search both `cname` directly and within the `customer_map` array, ensuring results include both primary and mapped names.
        *   At **12:15:06 PM & 12:21:35 PM & 12:23:52 PM**, the `CUSTOMER` role logic was reverted to the `Account_Master_Customer_MAP` table query, using `ARRAY[cname] || COALESCE(ARRAY(SELECT DISTINCT mapped ...)) AS customer_array` to combine the main customer name with its mapped names, and a mapping function to format the output.
        *   At **12:42:32 PM & 12:43:34 PM**: The `CUSTOMER` role query reverted to the `mtr_tracking_data` table, querying `account_name` with `DISTINCT` and pagination, commenting out the complex `Account_Master_Customer_MAP` logic again.
    *   **Timestamp: 1/5/2026, 5:24:26 PM & 1/5/2026, 5:30:33 PM**: The `CUSTOMER` role logic was updated to use the `PO_AccountMaster_Customer_Master` table, creating an array (`customer_array`) containing the main customer name and its distinct mapped customer names, ordered by `cname`. It includes handling for `customer_array` being a string or an array in the mapping logic. The previous `mtr_tracking_data` logic for CUSTOMER was commented out.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\chasis.query.ts`**
    *   **Timestamp: 1/5/2026, 2:38:19 PM & 1/5/2026, 2:38:29 PM & 1/5/2026, 2:39:36 PM**: Introduced `companyList` generation from `CompanyName` using comma splitting, trimming, lowercasing, and joining for use in SQL's `IN` clause, replacing `LOWER(account_name) = ANY (...)`. Added `console.log` with `company90877@@`.
    *   **Timestamp: 1/6/2026, 10:32:32 AM & 1/6/2026, 10:32:38 AM**: The `companyList` generation logic was modified to split `CompanyName` by `"||"` instead of `","`.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\export.query.ts`**
    *   **Timestamp: 1/5/2026, 3:20:59 PM - 1/5/2026, 4:24:15 PM (multiple logs)**: Modified multiple SQL queries within the `bookingQuery` function to use `LOWER(account_name) IN (${companyList})` instead of `LOWER(account_name) = '${CompanyName}'`. This applies to various "Booking Date" reports (Actual/Estimated Departure, POD Arrival, and Stacked Bar variations).
    *   **Timestamp: 1/6/2026, 10:33:04 AM & 1/6/2026, 10:33:16 AM**: The `companyList` generation logic was modified to split `CompanyName` by `"||"` instead of `","`.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\services\analytics\cbmService.ts`**
    *   **Timestamp: 1/5/2026, 8:38:09 PM**: Introduced `companyList` generation from `CompanyName` using comma splitting, trimming, lowercasing, and joining for use in SQL's `IN` clause, replacing `LOWER(mtd.account_name) = ANY (...)`. Also, adjusted the `mblwiseCondition`'s `select` and `condition` properties to explicitly reference `mblno` with a table alias (`mtd.mblno`).
    *   **Timestamp: 1/6/2026, 10:33:48 AM**: The `companyList` generation logic was modified to split `CompanyName` by `"||"` instead of `","`.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\services\analytics\containerService.ts`**
    *   **Timestamp: 1/5/2026, 8:38:59 PM**: Introduced `companyList` generation from `CompanyName` using comma splitting, trimming, lowercasing, and joining for use in SQL's `IN` clause, replacing `LOWER(account_name) = ANY (...)`.
    *   **Timestamp: 1/6/2026, 10:33:57 AM**: The `companyList` generation logic was modified to split `CompanyName` by `"||"` instead of `","`.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\services\analytics\kgsService.ts`**
    *   **Timestamp: 1/5/2026, 8:40:08 PM**: Introduced `companyList` generation from `CompanyName` using comma splitting, trimming, lowercasing, and joining for use in SQL's `IN` clause, replacing `LOWER(mtd.account_name) = ANY (...)`. Also, adjusted the `mblwiseCondition`'s `select`, `condition`, and `groupBy` properties to explicitly reference `mblno` with a table alias (`mtd.mblno`).
    *   **Timestamp: 1/6/2026, 10:34:04 AM**: The `companyList` generation logic was modified to split `CompanyName` by `"||"` instead of `","`.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\services\shipmentService.ts`**
    *   **Timestamp: 1/6/2026, 10:59:39 AM**: In the `SqlQueryBuilder` class, the `buildFilterConditions` method for `CompanyName` in `oceanFilters` and `airFilters` was modified. It now handles `CompanyName` as a potentially comma-separated string, converting it into a `companyList` for an `IN` clause, replacing the single value comparison.
    *   **Timestamp: 1/6/2026, 11:00:59 AM & 1/6/2026, 11:03:31 AM & 1/6/2026, 11:03:49 AM & 1/6/2026, 11:07:01 AM & 1/6/2026, 11:07:22 AM & 1/6/2026, 1:28:48 PM**: The company list generation in `buildFilterConditions` was updated to split `CompanyName` by `"||"` and apply `REGEXP_REPLACE` to remove commas from `account_name` in the database before comparison. This specifically targets the `LOWER(REGEXP_REPLACE(TRIM(mtr.account_name), '[,]', '', 'g')) IN ($$)` and `LOWER(TRIM(air.customer_name)) = $$` conditions.

### Patterns and Recurring Elements:

1.  **Transition to Multi-Company Filtering**: A significant and recurring pattern is the change in how `CompanyName` is handled in SQL queries across multiple utility and service files.
    *   Initially, many queries used `LOWER(account_name) = ANY (regexp_split_to_array(LOWER('${CompanyName}'), '\\s*,\\s*'))` or `LOWER(account_name) = '${CompanyName}'`.
    *   This was consistently replaced with a pattern of constructing a `companyList` array: `CompanyName.split(",").map(v => `'${v.trim().toLowerCase()}'`).join(",")` and then using `LOWER(account_name) IN (${companyList})`.
    *   **Latest Change (1/6/2026)**: A further refinement was introduced where `CompanyName` is split by `"||"` instead of `","`. This suggests a change in the expected delimiter for multiple company names. In some cases, `REGEXP_REPLACE(TRIM(mtr.account_name), '[,]', '', 'g')` was added to handle commas within the stored company names in the database for ocean shipments in `shipmentService.ts`.
2.  **Date Range Filtering**: All query builders (`transit`, `departure`, `general`, `container`, `booking`) consistently apply date range filters using `departure_date BETWEEN '${fromDate}'::timestamp AND '${toDate}'::timestamp + INTERVAL '1 day'`.
3.  **Dynamic Column Selection**: Most query builders use `getColumnsByCategory` to dynamically select columns for reporting, often ignoring common fields like `bookingdate`, `est_cargo_ready_date`, `country_name`, `networkdays`, `bl_release_date`, and requiring specific `must` columns relevant to the report type.
4.  **Customizer Object Usage**: A `customizer` object is universally used to store and pass configuration details for how data should be presented (e.g., `chartType`, `calType`, `dateColumns`, `calColumnConfig`, `selectedColumns`).
5.  **Percentage Calculation**: Reports often calculate a `percentage` by dividing a `value` by a `max_total` (or `max_value`) and rounding to two decimal places.
6.  **`DISTINCT ON` Clause**: Many queries, particularly in `container.query.ts` and `departure.query.ts`, use `DISTINCT ON (voyage, contno, CASE WHEN t49_cont_type IS NOT NULL ... ELSE cont_type END)` to ensure uniqueness at a container or voyage level, often considering container type variations.
7.  **Null/Empty Date Handling**: There's a repetitive pattern of checking for `IS NOT NULL` and `!= '0001-01-01 00:00:00 BC'` for date columns in SQL queries to filter out invalid or unset dates.
8.  **Error Handling**: All service and utility functions include basic error handling with `try...catch` blocks and logging errors using `logger.error`, returning a 500 status code on failure.

## 1:47:07 PM
The provided log details changes across several frontend JavaScript files within a T360_Api project, primarily focusing on customer management, booking, and API endpoint configurations.

### File-Specific Updates:

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\App.js`**
    *   **Timestamp: 1/2/2026, 2:26:45 PM & 1/2/2026, 2:26:51 PM**
        *   Both entries show nearly identical, extensive updates to the main `App.js` file, which is responsible for defining the application's routing.
        *   Numerous new imports for various screens and components were added, indicating a significant expansion of features. These include:
            *   Tracking screens: `FCLScreen`, `LCLScreen`, `AddMtrForm`, `GetTruckingDetails`, `RailScreen`, `AirTrackingScreen`
            *   Booking related screens: `AgentBookingFormScreenExtend`, `AgentPoFormExtend`, `CngBookingScreen`, `BookingDashbaordScreenExtend`, `CngBookingFormScreen`, `CngBookingScreenExtend`
            *   Master data screens: `CityMaster`, `PortmasterScreen`
            *   Report/Scheduler screens: `ReportSchedulerScreen`, `NewReportScreen`, `EditReportScreen`
            *   ALC related screens: `AlcExceptionDashboard`, `AlcDestinationCostRecord`, `SprAlcScreen`, `AlcGenerated`
            *   Other features: `PdfParserScreen`, `SprInvoiceScreen`, `ISFDashboardScreen`, `BackOfficeAdminTerminal`, `ShipmentsScreen`
        *   The routing configuration within the `<Routes>` component was heavily updated to include paths for these new screens, often protected by `ProtectedRoute` components with specific `UserRoleEnum` permissions (e.g., ADMIN, CUSTOMER, AGENT).
        *   A new root path `/` was added pointing to `LoginScreen` (previously commented out `Auth0Login`).
        *   Existing routes like `booking/form` were updated to use `AgentBookingFormScreenExtend` and `AgentPoFormExtend`, suggesting an extension or refactoring of booking forms.
        *   Routes for "Customer" (e.g., `/code/customer`, `/code/customer/form`), "Party," and "Agent" screens were also present, indicating these are core entities in the application.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\pages\booking\AgentBookingConfirmation.jsx`**
    *   **Timestamp: 1/2/2026, 2:59:06 PM**
        *   This file details a component for agent booking confirmation.
        *   It imports various UI components (MUI, custom buttons, input boxes, date picker, file dropzone, grids), utility hooks (`useFormat`), and Redux API mutations (`useCreateBookingXmlMutation`, `useUploadBookingXmlMutation`, `useUpdateDoMutation`, `useFetchBookingPlListQuery`, `useGetBookingConfirmQuery`).
        *   The component manages state for selected/deselected packing lists (`selectedPl`, `deselectedPl`), pagination, sorting, and file uploads (`selectedFile`).
        *   A `formik` instance is used for form handling with `bookingConfirmationValidation`.
        *   The `onSubmit` logic handles saving booking data, including file uploads, and conditionally triggers XML generation and upload based on `userAction` ("save_and_next" or "send-to-otm"). It also includes toast notifications for success/failure and a `WarningToast` for non-critical issues.
        *   Initial values for the form and selected PLs are loaded from `confirmData` and updated on component mount.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\code\customer\CustomerForm.jsx`**
    *   **Timestamp: 1/2/2026, 3:46:26 PM to 1/5/2026, 4:48:32 PM (multiple minor changes)**
        *   This component represents a form for managing customer details, including various input fields (IES Client code, Name, Email, Contact Person, Address, City, State, Postal Code, Country, Status, Sales Rep., Descartes Customer Mapping, ISF Party Mapping).
        *   It uses `formik` for form state management and validation with `CustomerValidationSchema`.
        *   Multiple `AppAutocomplete` components fetch dynamic options from `ApiManager` for Sales Rep, Descartes Customers, ISF Party, and City.
        *   File upload functionality is integrated (though commented out `useDropzone` code suggests a previous or alternative implementation).
        *   The `onSubmit` handler constructs `FormData` to send customer data, files, and stringified `mapping` and `customer_mapping` arrays to the `addCustomer` API mutation.
        *   **Key changes observed:**
            *   Initially, `customer_mapping` in `formik`'s `initialValues` was initialized to either existing data or an empty array.
            *   On `1/5/2026, 10:44:05 AM`, the `onSubmit` logic for `formData.append("mapping", ...)` was temporarily modified to process `customer_mapping` into a simple array of customer names (`customerArray`) before stringifying it, implying `mapping` and `customer_mapping` might have been intended to be linked or confused.
            *   On `1/5/2026, 10:45:28 AM`, the logic was reverted, correctly mapping `customer_mapping` to `formData.append("customer_mapping", JSON.stringify(customerArray))`.
            *   `console.log` statements for debugging `initialValues` and form submission values were added and removed.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\code\customer\CustomerMapping.jsx`**
    *   **Timestamp: 1/2/2026, 3:47:04 PM to 1/5/2026, 5:53:40 PM (multiple minor changes)**
        *   This component handles a dynamic list of customer mappings using `AppAutocomplete`.
        *   It allows adding and deleting rows of customer mappings.
        *   `fetchCustomers` is a useCallback function to fetch customer options for the autocomplete from `ApiManager.getCustomerOptions`.
        *   **Significant changes:**
            *   **Initial version (1/2/2026, 3:47:04 PM):** `deleteRow` directly modified `formik` state. Initial `customer_mapping` was set to `[{ customer: "" }]` if empty.
            *   **API integration for delete (1/2/2026, 4:03:31 PM):** The `deleteRow` function was updated to conditionally call `ApiManager.deleteCustomerOption(rowToDelete.customer)` before updating the formik state, with error handling. This also led to a change in `ApiManager.js` to correctly define the `DELETE_CUSTOMER_OPTION` endpoint and method.
            *   **API integration refinement (1/2/2026, 4:21:23 PM, 4:21:38 PM):** The `deleteRow` logic was further refined to check for `row.customer_id` before attempting a backend deletion, implying that `customer_id` is the identifier used for deletion. `toast` messages were added for user feedback.
            *   **Revert of API delete (1/5/2026, 5:34:05 PM, 5:34:40 PM, 5:34:55 PM):** The explicit API call within `deleteRow` was removed, reverting to simply modifying the local formik state. This suggests the API deletion is handled elsewhere (possibly when the main `CustomerForm` is submitted).
            *   **Initialization logic refinement (1/5/2026, 5:15:15 PM, 5:15:23 PM, 5:16:17 PM, 5:21:21 PM):** A new `useEffect` was introduced to handle cases where `customer_mapping` might initially be an array of strings (e.g., `["customer1", "customer2"]`) and transform it into the expected object format `[{ customer: "customer1" }]` for `AppAutocomplete`. `console.log` statements were added for debugging the `mapping` and `formik` state.
            *   **Refinement of empty state handling (1/5/2026, 5:51:09 PM, 5:51:30 PM, 5:52:01 PM, 5:52:15 PM, 5:52:45 PM, 5:53:40 PM):** The conditional rendering was updated to `(mapping || []).map(...)` to safely handle `mapping` being undefined. The logic for initializing `customer_mapping` to `[{ customer: "" }]` when empty was revisited and moved to a separate `useEffect` to ensure it only runs once during initialization. Also, an earlier `deleteRow` simplification was partially reverted, bringing back more robust state management.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\services\Endpoints.js`**
    *   **Timestamp: 1/2/2026, 4:01:34 PM to 1/2/2026, 4:36:10 PM (multiple changes)**
        *   This file defines API endpoints used throughout the application.
        *   **Key changes:**
            *   **`GET_CUSTOMER_OPTIONS`:** This endpoint's definition was added to fetch customer options for autocompletion.
            *   **`DELETE_CUSTOMER_OPTION`:** This endpoint saw several changes:
                *   Initially defined as a GET request `DELETE_CUSTOMER_OPTION: (accountName) => `/deleteCustomerOption?account_name=${encodeURIComponent(accountName)}`.
                *   Temporarily redefined as `DELETE_CUSTOMER_OPTION: (search = "") => `/getCustomerOptions${search ? \`?search=${encodeURIComponent(search)}\` : ""}` (1/2/2026, 4:20:10 PM), which was incorrect as it pointed to the GET customer options endpoint.
                *   Corrected to `DELETE_CUSTOMER_OPTION: (customerId) => `/deleteCustomerOption/${customerId}` (1/2/2026, 4:20:25 PM), indicating a RESTful DELETE endpoint for a specific customer ID.
                *   Later changed to `DELETE_CUSTOMER_OPTION: (customerId) => `/delete/${customerId}` (1/2/2026, 4:25:35 PM), suggesting a change in the base path for customer deletion.
                *   Finally settled on `DELETE_CUSTOMER_OPTION: (customerId) => `/getCustomerOptions/delete/${customerId}` (1/2/2026, 4:32:00 PM and subsequent), indicating a more specific path for deleting customer options.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\services\ApiManager.js`**
    *   **Timestamp: 1/2/2026, 4:01:42 PM to 1/2/2026, 4:36:34 PM (multiple changes)**
        *   This file provides static methods for interacting with the defined API endpoints.
        *   **Key changes:**
            *   **`getCustomerOptions`:** The method to fetch customer options was consistently defined.
            *   **`deleteCustomerOptions` / `deleteCustomerOption`:** This method underwent several revisions mirroring the `Endpoints.js` changes:
                *   Initially, there was a duplicate `getCustomerOptions` definition that incorrectly used the `DELETE_CUSTOMER_OPTION` endpoint with a GET method.
                *   The method was correctly named `deleteCustomerOptions` and later `deleteCustomerOption` and updated to use `ApiMethods.delete(url)` (1/2/2026, 4:06:54 PM), which is the appropriate HTTP method for deletion, finally pointing to the correct `DELETE_CUSTOMER_OPTION` from `Endpoints.js`.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\pages\code\CustomerFormScreen.jsx`**
    *   **Timestamp: 1/5/2026, 4:56:34 PM to 1/5/2026, 5:21:21 PM (multiple minor changes)**
        *   This screen component renders the `CustomerForm` and fetches initial customer data.
        *   It uses `useLocation` to get `initialValues` from navigation state and `useFetchCustomerQuery` to fetch `mappingData` based on the `acode`.
        *   **Key changes:**
            *   Initial state for `customer_mapping` varied, sometimes set from `state.initialValues?.customer_map` (which could be a string or array) and sometimes initialized as an empty array.
            *   **Crucially (1/5/2026, 5:21:21 PM):** The `useEffect` that sets `initialValues` was significantly refactored. It now explicitly checks if `apiRow.customer_mapping` is an array and, if so, maps each string element to an object `{ customer: c }` to ensure compatibility with `CustomerMapping` component's expected format. If `apiRow.customer_mapping` is not an array or is empty, it initializes to `[{ customer: "" }]`. The `mapping` array also gets similar robust initialization. This change directly addresses the formatting inconsistency seen in `CustomerMapping.jsx`.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\pages\dashboard\ShipmentTrackingScreen.jsx`**
    *   **Timestamp: 1/5/2026, 5:37:02 PM**
        *   This file displays shipment tracking information.
        *   It fetches shipment and vessel tracking data using `useFetchShipmentTrackingQuery`.
        *   The UI includes a map, a tracking stepper, and detailed shipment information, with a "More Details" toggle to expand additional fields like Customer Ref No., Notify, Commodity, Consignee, Service, Piece count, and Weight.
        *   The header was updated to include "Shipment123 #{params.mblno}" suggesting a minor text change or placeholder.

### Timestamps of Significant Changes:

*   **1/2/2026, 2:26:45 PM - 2:26:51 PM:** Major application routing overhaul in `App.js`, introducing many new screens and extending existing booking flows.
*   **1/2/2026, 2:59:06 PM:** `AgentBookingConfirmation.jsx` was committed, indicating the completion or significant update of a complex booking confirmation component with XML generation/upload capabilities and comprehensive form handling.
*   **1/2/2026, 3:47:04 PM - 4:36:47 PM:** A series of iterative changes in `CustomerForm.jsx`, `CustomerMapping.jsx`, `Endpoints.js`, and `ApiManager.js` to implement customer mapping functionality, including:
    *   Defining API endpoints for getting and deleting customer options.
    *   Implementing API methods in `ApiManager`.
    *   Integrating `CustomerMapping` component into `CustomerForm`.
    *   Attempting to add client-side deletion with backend API call in `CustomerMapping.jsx`, then reverting it (suggesting deletion might be handled upon main form submission).
*   **1/5/2026, 5:21:21 PM:** A critical fix in `CustomerFormScreen.jsx` to correctly initialize and format `customer_mapping` data when loaded from the API, ensuring proper display and interaction within `CustomerMapping.jsx`.
*   **1/5/2026, 5:34:05 PM - 5:53:40 PM:** Further refinements in `CustomerMapping.jsx` regarding the handling of mapping data (initialization, deletion logic, ensuring `mapping` is an array), likely in response to the changes in `CustomerFormScreen.jsx`.

### Patterns or Recurring Elements:

*   **Frontend Technologies:** Consistent use of React, `formik` for form management, `@mui/material` for UI components, `react-router-dom` for routing, `react-hot-toast` for notifications, and `redux` (`@reduxjs/toolkit`) for state management and API interactions.
*   **API Interaction:** Frequent use of `ApiManager` for making API calls and Redux Toolkit Query (`useMutation`, `useQuery`) for data fetching and modification. Endpoint definitions are centralized in `Endpoints.js`.
*   **Customer Management Focus:** A significant portion of the changes revolves around the "Customer" entity, specifically `CustomerForm.jsx`, `CustomerMapping.jsx`, and related API endpoints. This suggests ongoing development or refinement of customer data management features, particularly the dynamic "customer mapping" functionality.
*   **Form Data Handling:** The pattern of preparing `FormData` with stringified JSON objects for complex arrays (like `mapping` and `customer_mapping`) and appending actual files (e.g., `do_document`, `files`) is evident in `AgentBookingConfirmation.jsx` and `CustomerForm.jsx`.
*   **Role-Based Access Control:** `ProtectedRoute` and `UserRoleEnum` are widely used in `App.js` to enforce access permissions for various routes, indicating a robust authorization system.
*   **Debugging/Logging:** `console.log` statements appear frequently across different files, often added during development phases to inspect variable states (`initialValues`, `mappingData`, `rowdata`, `formik` object, `queryParams`, etc.). Some of these are removed in subsequent commits, while others persist.
*   **Responsive Design:** `useMediaQuery` from `@mui/material` is used in `AgentBookingConfirmation.jsx` to adjust UI elements (like `pageSize`) based on screen size.
*   **Incremental Refinement:** Several files, especially `CustomerForm.jsx`, `CustomerMapping.jsx`, `Endpoints.js`, and `ApiManager.js`, show a series of rapid, small commits. This pattern indicates an iterative development process, where features are implemented, tested, refined, and corrected over short periods. This is particularly noticeable in the `deleteCustomerOption` endpoint and method, and the `customer_mapping` data structure handling.

## 2:46:49 PM
The code changes primarily occurred within the `javascript-learning` directory, specifically affecting `index.html` and `0_variables.js`. All recorded modifications took place on January 4, 2026, between approximately 3:18 PM and 3:45 PM, suggesting a concentrated learning or development session.

**File-specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\javascript-learning\index.html`**
    *   Initial creation (Timestamp: 1/4/2026, 3:18:32 PM) included a basic HTML5 structure with a `<h1>Hello world!</h1>` and an empty `<button>` that triggers an `alert('welcome to my js tutorials')` on click.
    *   A quick update (Timestamp: 1/4/2026, 3:18:41 PM) added the text "Click me" to the button, making it visible and actionable.

*   **`c:\Users\ridap\OneDrive\Documents\javascript-learning\0_variables.js`**
    *   The file began with a simple `console.log("Hello my first js code!";)` statement (Timestamp: 1/4/2026, 3:36:06 PM), which contained a syntax error.
    *   This syntax error was promptly corrected (Timestamp: 1/4/2026, 3:36:47 PM) to `console.log("Hello my first js code!");`.
    *   Shortly after (Timestamp: 1/4/2026, 3:38:49 PM), the file started introducing JavaScript variables, with `var myAge = 25; console.log(myAge);` and a comment `// camel`. The comment was then slightly refined to `// camel case` (Timestamp: 1/4/2026, 3:38:57 PM).
    *   A significant expansion of content occurred (Timestamp: 1/4/2026, 3:45:07 PM) where multiple variables were declared and logged, demonstrating different naming conventions (`my_firtsName`, `_lastName`, `$myAge`). This update also included examples of *invalid* variable names (`123data`, `my@email`).
    *   Immediately following, the lines with invalid variable declarations were commented out (Timestamp: 1/4/2026, 3:45:32 PM), indicating a process of experimentation and correction regarding JavaScript variable naming rules.
    *   The final entry for this file (Timestamp: 1/4/2026, 3:45:41 PM) shows no content change, only an updated timestamp.

**Patterns and Recurring Elements:**

*   **Learning Progression:** The changes reflect a clear learning path, starting with basic HTML structure and JavaScript output, then moving on to variable declaration and an exploration of valid/invalid naming conventions.
*   **Immediate Corrections:** Errors or omissions (like the empty button text or JS syntax error) were often corrected very soon after being introduced. Invalid code examples were added and then commented out, suggesting hands-on learning and self-correction.
*   **`console.log()` Usage:** The JavaScript file heavily utilizes `console.log()` for outputting messages and variable values, characteristic of a development environment focused on immediate feedback and understanding.
*   **Timestamp Proximity:** Many changes for a single file occur within seconds or minutes of each other, reinforcing the idea of an active, focused coding session.

## 2:47:11 PM
The log details changes across two primary frontend components and one analytics utility file, all occurring between January 5th and 6th, 2026, indicating a focused period of development or refinement.

**File: `c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\SelectCustomer.tsx`**

*   **Initial Update (1/5/2026, 5:28 PM):** The component `SelectCustomerPanel` was updated to enable customer searching within the dropdown by modifying a `useEffect` hook. Previously, it loaded the full customer list when the dropdown opened; now, it loads based on the `search` state. The `handleAdd` function was initially adjusted to process selected customer values by filtering and trimming, then joining them with a comma before passing to `onSelect` and storing in `localStorage`. A brief period saw two similar `useEffect` hooks, which was then resolved to keep only the search-dependent one.
*   **Normalization Logic (1/6/2026, 10:20 AM - 10:22 AM):** A `normalizeCustomerNames` function was introduced to handle variations in customer names (e.g., removing commas for deduplication or alternate representations) for internal storage. The `handleAdd` logic was updated to use this, creating an array of normalized names.
*   **`onSelect` Separator Change (1/6/2026, 10:26 AM):** The delimiter used when passing selected customer values to the `onSelect` callback was changed from a comma (`,`) to `||`. Notably, the `normalizeCustomerNames` function introduced in earlier commits for value deduplication and variant storage was removed in this final commit for this file, simplifying the `handleAdd`'s value processing back to basic filtering and trimming before the `onSelect` call.

**File: `c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\analytics\methods.ts`**

*   **Excel Export Client Naming (1/6/2026, 10:52 AM - 10:56 AM):** The `downloadReportSpreadsheet` function received several updates for formatting the "Client" field in Excel exports. The `selectedCustomer` string is now split by `||`, each segment is trimmed, lowercased, enclosed in single quotes, and then re-joined with a comma for the Excel sheet. Nullish coalescing (`?? ""`) was added for safer handling of potentially undefined `selectedCustomer`. A further refinement specifically removed commas from individual client names during the mapping process for the Excel output. Additionally, the `user` parameter was explicitly typed for improved code clarity and safety.

**File: `c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\pages\shipment\tracking-stepper.tsx`**

*   **Timeline Logic Refinements (1/6/2026, 1:33 PM - 2:00 PM):** The `getTrackingDetails` function within the `TrackingStepper` component underwent numerous small, iterative adjustments. These changes primarily focused on the logic for determining the completion status and percentage of the "Port of Loading" (POL) stage. This involved multiple slight modifications and subsequent reverts to the boolean conditions (e.g., `!!trackingInfo.atd` versus `trackingInfo.atd || (trackingInfo.etd && trackingInfo.atd)`) and percentage calculations. A temporary debug label ("ATD123:") was briefly added and then removed.
*   **Icon Styling Updates (1/6/2026, 2:40 PM - 2:45 PM):** The default colors for the `LocationPinIcon` and `TerminalIcon` components were adjusted. The `LocationPinIcon`'s default color changed from a semi-transparent black to a gray (`#71717A`), then to black (`#000000`), and similarly, `TerminalIcon` had its default color changed to gray (`#71717A`). These indicate minor visual styling adjustments.

**Key Patterns and Recurring Elements:**

*   **Iterative Development:** There's a clear pattern of frequent, small commits, especially for `tracking-stepper.tsx`, with some changes being reverted or immediately refined in subsequent commits. This suggests an iterative or trial-and-error approach to fine-tuning component logic and UI.
*   **Frontend Focus:** All changes are within the frontend application, concerning user interface components (`SelectCustomer.tsx`, `tracking-stepper.tsx`) and client-side data processing/reporting (`methods.ts`).
*   **Data Handling and Formatting:** Recurring elements involve parsing and formatting data strings (`selectedCustomer` in `methods.ts`, customer values in `SelectCustomer.tsx`) and managing component state/logic based on various data availability (dates in `tracking-stepper.tsx`).
*   **Date Formatting:** Consistent use of a `formatDate` helper and `moment` library for date formatting is present across the `methods.ts` and `tracking-stepper.tsx` files.
*   **Styling Adjustments:** Multiple small changes to icon colors in `tracking-stepper.tsx` indicate ongoing UI polish.

## 3:46:47 PM
The changes log details an active development session on **1/4/2026**, focusing on introductory HTML and JavaScript concepts.

**File-specific updates:**

*   **`c:\Users\ridap\OneDrive\Documents\javascript-learning\index.html`**:
    *   Initiated at **3:18:32 PM** with a basic HTML structure, including an `h1` tag displaying "Hello world!" and an empty button configured with an `onclick` alert.
    *   A minor refinement followed at **3:18:41 PM**, adding the text "Click me" to the button element, making it visible to the user.

*   **`c:\Users\ridap\OneDrive\Documents\javascript-learning\0_variables.js`**:
    *   The file was first created at **3:36:06 PM** with a `console.log` statement containing a syntax error (an extra semicolon).
    *   This error was corrected moments later at **3:36:47 PM**.
    *   Subsequent updates at **3:38:49 PM** and **3:38:57 PM** introduced a `var` declaration for `myAge` (initialized to 25) and a `console.log` statement, along with a comment about "camel case" variable naming.
    *   A significant expansion occurred at **3:45:07 PM**, where multiple `var` declarations were added to explore different naming conventions, including `my_firtsName`, `_lastName`, and `$myAge`. This update also initially included attempts to declare invalid variable names like `123data` and `my@email`.
    *   Immediately after, at **3:45:32 PM**, the lines containing the invalid variable declarations (`123data` and `my@email`) were commented out, indicating a learning process where valid variable naming rules were being identified.
    *   The final entry at **3:45:41 PM** shows no functional change, mirroring the previous state.

**Patterns and Recurring Elements:**

*   All recorded changes occurred on the same day, **1/4/2026**, within a short span, suggesting a focused learning or development session.
*   The updates are characterized by small, iterative refinements, often correcting syntax or adding basic functionality/explorations (e.g., adding button text, correcting semicolons, experimenting with variable names).
*   The content in `0_variables.js` specifically demonstrates an exploration of JavaScript variable declaration and naming conventions, including testing both valid and invalid identifiers.

## 3:47:02 PM
`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\analytics\query\booking.query.ts`
- **Timestamp**: 1/2/2026, 2:35:49 PM
- The file defines an interface `QueryBuilderI` and an asynchronous function `bookingQueryBuilder` for constructing SQL queries related to booking analytics.
- It includes logic for various `type`s of queries, such as `'BookingDatetoActualDeparture'`, `'BookingDatetoActualDepartureMblWise'`, `'BookingDatetoActualDepartureStackedBar'`, and `'BookingDatetoActualDepartureMblWiseStackedBar'`.
- The queries calculate the average day difference between booking date and actual departure date, often grouped by file number and container number or MBL number.
- Stacked bar chart queries categorize these day differences into time ranges (e.g., "Less than 1 week", "1 - 2 weeks").
- It uses utility functions `getColumnsByCategory` and `getFilterQueryByDisplayValue` for dynamic column selection and filtering.
- Date comparisons specifically exclude '0001-01-01 00:00:00 BC' values.

`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\getCustomerOptions.ts`
- **Timestamp Changes**:
    - **1/2/2026, 3:58:49 PM**: Initial implementation of `getAllCustomerOptions` and `deleteCustomerOption`. `getAllCustomerOptions` fetches distinct customer names with search capability and a limit of 10. `deleteCustomerOption` removes a customer by `account_name` from `mtr_tracking_data`. A significant portion of commented-out code suggests previous, more complex logic for pagination and role-based filtering (`AGENT`, `CUSTOMER`).
    - **1/2/2026, 4:17:54 PM**: The `deleteCustomerOption` function was modified. It now expects `customer_id` from `req.params` instead of `account_name` from `req.body`, and the DELETE SQL query targets `customer_id` in `mtr_tracking_data`.
    - **1/2/2026, 4:22:36 PM**: `deleteCustomerOption` was further updated. The DELETE SQL query now targets the `id` column in `mtr_tracking_data`, likely assuming `customer_id` from `req.params` maps to this `id`.
    - **1/2/2026, 4:28:41 PM**: Added `console.log` statements within `deleteCustomerOption` to debug `customer_id` from `req.params`. No functional change.
    - **1/2/2026, 4:28:50 PM**: Added `console.log` statements within `deleteCustomerOption` to debug `customer_id` and `req.params`. No functional change.
    - **1/2/2026, 4:29:40 PM**: Added `console.log` statements within `deleteCustomerOption` to debug `customer_id` and `req.params`. No functional change.
    - **1/2/2026, 4:31:23 PM**: The `deleteCustomerOption` function was significantly changed. The DELETE SQL query now targets the `id` column in `Account_Master_Customer_MAP` instead of `mtr_tracking_data`. This implies a change in which table customer deletion affects.

`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\routes\getCustomerOptionsRoute.ts`
- **Timestamp Changes**:
    - **1/2/2026, 3:59:33 PM**: Defines routes for customer options: `GET /` for `getAllCustomerOptions` and `DELETE /` for `deleteCustomerOption`.
    - **1/2/2026, 3:59:43 PM**: The `DELETE` route path was changed from `/` to `/delete`, indicating a more specific endpoint for deletion.
    - **1/2/2026, 4:18:20 PM**: The `DELETE` route path was updated to include a dynamic parameter: `/delete/:customer_id`, aligning with the controller's expectation of a `customer_id` from `req.params`.
    - **1/2/2026, 4:28:07 PM**: No functional changes, re-saving the identical route configuration.

`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\code.controller.ts`
- **Timestamp Changes**:
    - **1/2/2026, 4:12:38 PM**: The `createCustomer` function was introduced, implementing a complex logic for creating/modifying customer data. This includes:
        - Handling file uploads via `upload` middleware.
        - Sanitizing `cname`.
        - Database transaction management (`BEGIN`).
        - Checking for existing customers by `acode` to determine `NEW` or `Modify` mode.
        - Deleting related records (types, shippers, pics) if in `Modify` mode.
        - Generating new `acode` and `subcode` if creating a new customer.
        - Inserting data into `PO_AccountMaster_Customer_Master` and `agent_po_account_master_type`.
        - Parsing and inserting `mapping` (shipper details) into `Account_Master_Shipper_MAP`.
        - Fetching `polcode`, `shippercode`, and `agentcode` from other master tables.
    - **1/2/2026, 4:14:13 PM**: In `getAllCustomer`, the `customerMapData` now includes `customer_id` from the `Account_Master_Customer_MAP` table. The `createCustomer` function remains the same.
    - **1/5/2026, 10:23:34 AM**: In `createCustomer`, the `insertCustomerQuery` was updated to include `customer_map` as a column for insertion into `PO_AccountMaster_Customer_Master`. The `insertCustomerValues` array was also extended to pass the `customer_mapping` value.
    - **1/5/2026, 10:47:37 AM**: No functional changes, identical code to the previous commit, likely a re-save.
    - **1/5/2026, 11:06:52 AM**: Added a `console.log` for `customer_mapping` in the `createCustomer` function body. No functional change.
    - **1/5/2026, 11:15:27 AM**: In `createCustomer`, a new helper function `parseCustomerMapping` was introduced to handle the `customer_mapping` input, which could be an array or string. This parsed array (`customerArray`) is then used in the `insertCustomerValues`.
    - **1/5/2026, 11:17:44 AM**: The `parseCustomerMapping` function was refactored to handle cases where `customer_mapping` might be an array with duplicate keys, ensuring only the first valid JSON array string is parsed. It also includes error handling for JSON parsing.
    - **1/5/2026, 11:18:45 AM**: No functional changes, identical code to the previous commit, likely a re-save.
    - **1/5/2026, 11:21:00 AM**: Further refinement of `parseCustomerMapping` function to ensure robust parsing of `customer_mapping`, including a `tryParse` helper and explicit checks for array and string types, returning an empty array if parsing fails. In `createCustomer`, the `customerArray` is now explicitly parsed from `req.body.customer_mapping`.
    - **1/5/2026, 11:22:13 AM**: No functional changes, identical code to the previous commit, likely a re-save.
    - **1/5/2026, 12:41:04 PM**: In `getAllCustomer`, the `dataQuery` was updated to `SELECT customer_map` from `PO_AccountMaster_Customer_Master`. No other functional changes.
    - **1/5/2026, 1:51:23 PM**: No functional changes, identical code to the previous commit, likely a re-save.
    - **1/5/2026, 4:47:49 PM**: In `getAllCustomer`, a new `normalizePgArray` helper function was added to correctly parse PostgreSQL array strings (e.g., `{A,B,C}`) into JavaScript arrays. This function is then used to process `row.customer_map` in the `customerData` object before returning the response.
    - **1/5/2026, 4:50:05 PM**: The `normalizePgArray` helper function was commented out in `getAllCustomer` and replaced by directly assigning `chkStr(row.customer_map)` to `customer_map` in `customerData`. This reverts the explicit array parsing for retrieval. The console log for `row` was added.
    - **1/5/2026, 4:51:59 PM**: In `getAllCustomer`, the `customer_map` field in `customerData` is now explicitly checked (`chkStr(row.customer_mapr) ? normalizePgArray(row.customer_map) : []`) to conditionally apply `normalizePgArray`, and a typo `customer_mapr` was introduced. Also, the `customer_mapping` in the final return object for `getAllCustomer` uses `customerMapData` (from `Account_Master_Customer_MAP`) instead of the `customer_map` from `PO_AccountMaster_Customer_Master`.
    - **1/5/2026, 4:52:07 PM**: The `customer_map` field in `customerData` was corrected to use `row.customer_map` (removing the typo `customer_mapr`). The logic for `customer_mapping` in the final return object for `getAllCustomer` still uses `customerMapData`.
    - **1/5/2026, 5:00:11 PM**: In `getAllCustomer`, the `normalizePgArray` function was commented out. The `customer_map` in `customerData` now directly uses `chkStr(row.customer_map)`. The `customer_mapping` field in the response for `getAllCustomer` (the top-level return object) now explicitly uses `Array.isArray(row.customer_map) ? row.customer_map : []` instead of `customerMapData`. This implies a change in how `customer_mapping` is retrieved and structured in the response. The `customerQuery` and `customerMapData` are commented out, indicating they are no longer used for the `getAllCustomer` response, but `customer_mapping` is still present in the `createCustomer` logic.
    - **1/5/2026, 5:19:58 PM**: In `getAllCustomer`, the logic for `customer_map` in `customerData` and `customer_mapping` in the final return object both now explicitly ensure an array is returned: `Array.isArray(row.customer_map) ? row.customer_map : []`. The `customerQuery` and `customerMapData` are still commented out in `getAllCustomer`.
    - **1/5/2026, 5:38:15 PM**: No functional changes, identical code to the previous commit, likely a re-save.
    - **1/5/2026, 5:38:44 PM**: No functional changes, identical code to the previous commit, likely a re-save.
    - **1/5/2026, 5:39:13 PM**: The `parseCustomerMapping` function was moved from inside `createCustomer` to the top level, making it a module-level utility function. The `customerQuery` and `customerMapData` are commented out in `getAllCustomer`, indicating a complete removal of the `Account_Master_Customer_MAP` table mapping for the `getAllCustomer` response. The `customer_mapping` key in the response for `getAllCustomer` explicitly falls back to an empty array if `row.customer_map` is not an array.
    - **1/5/2026, 5:39:47 PM**: No functional changes, identical code to the previous commit, likely a re-save.
    - **1/5/2026, 5:40:00 PM**: No functional changes, identical code to the previous commit, likely a re-save.
    - **1/5/2026, 5:40:32 PM**: The `customerQuery` and `customerMapData` and their related `logger.info` calls were completely removed (commented out) from the `getAllCustomer` function, confirming they are no longer part of the customer retrieval logic.
    - **1/5/2026, 5:40:56 PM**: No functional changes, identical code to the previous commit, likely a re-save.

**Patterns and Recurring Elements:**

- **Timestamp Increment**: All timestamps are from January 2, 2026, or January 5, 2026, suggesting concentrated development bursts on these days. The `code.controller.ts` file shows particularly frequent, minor saves on January 5th.
- **File Structure**: `controllers` directory contains business logic, and `routes` directory defines API endpoints, a common pattern in backend development.
- **Database Interaction**: All files extensively use `query` (presumably a database query function) and construct SQL queries as strings, often with parameterization (`$1`, `$2`).
- **Error Handling**: `try...catch` blocks are consistently used, returning 500 status codes for internal server errors and logging errors.
- **Request/Response Objects**: Express `Request` and `Response` objects (or `AuthenticatedRequest`) are consistently used in controller functions.
- **Customer Management Focus**: A significant portion of changes revolves around customer data management: fetching, creating, updating, and deleting customer records and their associated mappings and documents.
- **Data Transformation/Sanitization**: Functions like `chkStr` are used to ensure string values are handled safely, and `cname` is sanitized. There's an evolving `parseCustomerMapping` function for robust input handling.
- **Conditional Logic**: Heavy use of `if/else if` statements to handle different types of queries or different operational modes (e.g., `modetype = 'NEW'` vs. `='Modify'`).
- **Logging**: `logger.info` and `console.log` statements are frequently used for debugging and tracing request/response data and query details.
- **Customer ID/Account Code**: `acode` and `customer_id` are key identifiers for customer records, with logic for generating new codes.
- **PostgreSQL Array Handling**: A pattern of dealing with PostgreSQL's array representation (e.g., `{A,B,C}`) for the `customer_map` field emerged and then reverted, suggesting iteration on how to best retrieve and represent this data type in the API response.