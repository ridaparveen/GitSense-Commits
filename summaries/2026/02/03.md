# Activity Summary for 2/3/2026

## 1:47:10 PM
The changes primarily focus on enhancing data querying and export functionalities related to booking and tracking reports within the `t360-backend-v2` project. The modifications center around generating dynamic SQL queries and preparing data for export, particularly for analytical reports showing time differences in the shipping lifecycle.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\booking.query.ts`**
    *   **Timestamp: 2/2/2026, 4:51:42 PM**
    *   This file introduces the `bookingQueryBuilder` function, which is responsible for constructing dynamic PostgreSQL queries for various booking analytics. It defines interfaces for `CalColumn`, `CalColumnConfig`, `Customizer`, and `QueryBuilderI`.
    *   The `bookingQueryBuilder` supports different report `type`s, including:
        *   "BookingDatetoActualDeparture": Calculates the average day difference between `t49_vessel_actualdeparted_date` and `bookingdate` for file and container numbers.
        *   "BookingDatetoActualDepartureMblWise": Similar to the above, but aggregated by MBL number instead of container.
        *   "BookingDatetoActualDepartureStackedBar" and "BookingDatetoActualDepartureMblWiseStackedBar": These generate queries for stacked bar charts, categorizing day differences into predefined weekly buckets (e.g., 'Less than 1 week', '1 - 2 weeks') and grouping by time periods (month, week, quarter).
    *   Queries incorporate filtering by `account_name` (derived from `CompanyName`), date range, and exclude invalid date entries (`'0001-01-01 00:00:00 BC'`). It also dynamically fetches `selectedColumns` based on user ID and report name.
    *   Subsequent log entries for this file on **2/2/2026** (4:52:50 PM, 5:24:53 PM) and **2/3/2026** (10:11:53 AM, 10:48:41 AM, 1:39:21 PM, 1:43:50 PM, 1:46:23 PM) show identical content, indicating no further code changes in these specific revisions but rather repeated logs of the same file state.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\export.query.ts`**
    *   **Timestamp: 2/3/2026, 10:39:44 AM**
    *   This file was introduced to provide SQL query fragments specifically for exporting data based on different report names.
    *   It includes a `getMonthValue` helper function to convert textual month names or numbers to integer month values.
    *   The `bookingQuery` function returns a dictionary of SQL string fragments keyed by `reportName`. These fragments define the `SELECT` and `WHERE` clauses for various booking-related reports, similar to `booking.query.ts` but tailored for export.
    *   Supported report names include "Booking Date to Actual Departure" (and its MBL Wise and Stacked Bar variants), "Booking Date to Estimated Departure" (and MBL Wise variant), and "Booking Date to POD Arrival" (and its MBL Wise and Stacked Bar variants).
    *   Conditional logic is applied for `stackedExport` to filter by `displayBy` (month, week, quarter) and `stackedGroup` (e.g., 'Less than 1 week'), allowing for detailed data export from stacked charts.
    *   Similar to `booking.query.ts`, all subsequent log entries for this file on **2/3/2026** (10:42:00 AM, 10:50:18 AM, 10:56:20 AM, 11:51:25 AM, 11:56:13 AM, 12:02:32 PM, 12:10:05 PM, 12:53:02 PM, 12:53:49 PM, 12:54:46 PM, 1:18:51 PM, 1:21:54 PM, 1:28:11 PM, 1:39:47 PM, 1:40:24 PM) show identical content, implying no functional code changes were made after the initial introduction.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\utils\analytics.ts`**
    *   **Timestamp: 2/3/2026, 10:51:20 AM**
    *   This utility file provides several functions to support analytics and data export:
        *   `defaultDateRange`: Supplies a default date range (last 365 days).
        *   `replaceValueInQuery`: A helper to conditionally replace values in specific columns (`pod`, `place_of_delivery`).
        *   `getUserObject`: Fetches or constructs a user object, handling admin-level company data.
        *   `getFilterQueryByDisplayValue`: Generates SQL `groupBy`, `orderBy`, `dateTrunc`, and `select` clauses based on how data should be displayed (month, week, quarter).
        *   `getExcelSelectedColumns`: Dynamically selects a set of columns for Excel export based on the report name and whether it's a booking report, including special handling for "Cargo-Ready Date to ETD" (calculates `networkdays`) and "BL Release KPI" (calculates `bl_release_date`).
        *   `isValidDate`: Validates date strings to ensure they are parsed correctly and are not '0000-01-01T00:00:00.000Z'.
        *   `dateFilterOnExport`: Processes data items to filter and format specific date fields for export, replacing invalid dates with `null`.
        *   `EXCEL_EXPORT_COLUMNS`: A large, static array defining key-name pairs for all columns intended for Excel export, covering comprehensive tracking and booking details.
    *   Subsequent log entries for this file on **2/3/2026** (11:00:58 AM, 11:46:21 AM) also show identical content.

**Timestamps of Significant Changes:**

*   **2/2/2026, 4:51:42 PM**: Initial introduction of the `bookingQueryBuilder` logic in `booking.query.ts`.
*   **2/3/2026, 10:39:44 AM**: Initial introduction of `getMonthValue` and `bookingQuery` export logic in `export.query.ts`.
*   **2/3/2026, 10:51:20 AM**: Initial introduction of various analytics utility functions and Excel export column definitions in `analytics.ts`.

**Patterns or Recurring Elements:**

*   **Focus on Date Differences and KPIs**: A primary theme across `booking.query.ts` and `export.query.ts` is the calculation and analysis of time differences between key booking/tracking dates (e.g., booking date to actual departure, booking date to POD arrival). This is often presented as averages or categorized into weekly buckets for stacked bar charts.
*   **Dynamic SQL Query Generation**: Both `booking.query.ts` and `export.query.ts` extensively generate dynamic SQL, incorporating company-specific filtering, date range constraints, and conditional clauses for different report types and display preferences.
*   **Robust Date Handling**: There's a consistent pattern of handling dates, including:
    *   `EXTRACT(DAY FROM ...)` and `DATE_PART('day', ...)` for calculating day differences.
    *   `DATE_TRUNC` for grouping by month, week, or quarter.
    *   Explicit checks for `IS NOT NULL` and `!= '0001-01-01 00:00:00 BC'` to filter out default/invalid date entries in database queries.
    *   Specific date validation (`isValidDate`) and formatting (`moment().format("MM/DD/YYYY")`) for data export.
*   **Customization and Configurability**: The use of `customizer` objects in `bookingQueryBuilder` and parameters like `displayBy`, `stackedMonth`, `startWeek`, `endWeek`, `quarter`, `stackedGroup`, and `stackedExport` indicate a design favoring customizable reports and export options.
*   **Repeated Log Entries with Identical Content**: A noticeable pattern is the frequent logging of files (`booking.query.ts`, `export.query.ts`, `analytics.ts`) with identical content across multiple timestamps within the same day. This suggests either frequent, minor (unlogged) saves, automated backup processes, or a version control system logging every save operation, rather than substantive code changes in each instance. The actual code evolution is captured at the first timestamp where new content for a file appears.

## 1:47:38 PM
The provided log details a series of changes across several frontend components and an API service, primarily focusing on analytics, booking, and dashboard functionalities within the T360-V2 frontend application.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\analytics\metricBox.tsx`**:
    *   **Early Changes (around 2:00 PM - 2:25 PM)**: Initially, the component `MetricsBox` was adjusted to dynamically determine chart height. The `getChartComponent` utility's `sizeInfo.height` logic was modified multiple times, oscillating between `700`, `null`, and `350` pixels for non-enlarged charts.
    *   **Mid-afternoon Refactor (around 3:37 PM - 3:55 PM)**: A significant refactor was attempted, introducing a `sizeInfo` prop to `MetricsBoxProps` for external control over dimensions and removing local `chartView` and `enlarge` states, as well as the `ThemedModal` and some `MetricToolbar` functionalities. This refactor then saw some immediate partial reverts.
    *   **Late-afternoon Refinement (around 4:00 PM - 4:23 PM)**: The major refactor from mid-afternoon was largely reverted, restoring the `chartView` and `enlarge` states, the internal `getChartComponent` logic, and the `ThemedModal`. Subsequent changes focused on how the chart's title and the chart component itself are rendered within the `chart-wrapper` div, particularly adding a `key` prop (`key={`${item.columnSpan}-${item.rowSpan}`}`) to force re-renders upon size changes and refining the CSS for layout (`flex: 1`, `minHeight: 0`) to ensure proper display of the footer. A brief, likely accidental, commenting out of the main `MetricToolbar` was also observed and quickly restored.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\analytics\analyticsContainer.tsx`**:
    *   **Mid-afternoon Updates (around 3:32 PM - 3:34 PM)**: The `MetricItem` interface was expanded to include `chartType` and `data`. The `fetchSingleReport` function saw `period` and `viewBy` filters made optional and a new `EndpointType` interface introduced to improve type safety with `unknown as EndpointType` type assertions.
    *   **Late-afternoon Logic Change (around 4:06 PM)**: The `saveSize` function was modified to dispatch UI updates (`setAllMetric`) *before* making the API call to `saveMetricSize`, improving UI responsiveness. Error handling for the API call was also added.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\store\api\analytics-api.ts`**:
    *   **Early Changes (around 2:07 PM - 2:13 PM)**: The `saveMetricSize` mutation's cache invalidation (`invalidatesTags`) was modified three times. It started by invalidating `["VIEW","SIZE"]`, then changed to `["SIZE"]`, removed `invalidatesTags` completely, and finally re-added `["SIZE"]`. This indicates an adjustment in caching strategy for metric size updates.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\analytics\resizableGridItem.tsx`**:
    *   **Throughout the day (2:11 PM - 4:11 PM)**: This component experienced recurring changes related to its internal state management for `columnSpan` and `rowSpan`. The `useEffect` hook responsible for re-initializing these states from props was repeatedly added and removed. Debugging `console.log` statements were frequently inserted. The `handleResize` logic, which determines grid spans based on width/height thresholds (400px), also saw minor adjustments, sometimes simplifying or restricting column span values.
    *   **Mid-afternoon Refactor and Reversion (around 3:42 PM - 4:02 PM)**: A significant refactor simplified the component by removing `useState` for `columnSpan`/`rowSpan` and making grid spans purely prop-driven. This refactor was subsequently reverted, bringing back the `useState` hooks and the more complex internal state management, as well as the `width` and `height` props for the `Resizable` component.
    *   **Late-afternoon UI Fixes (around 4:07 PM - 4:11 PM)**: `CommonComp`'s JSX styling was explicitly updated to ensure the content correctly spans grid columns and rows (`gridColumn: \`span ${columnSpan} / span ${columnSpan}\``, `width: "100%"`, `height: "100%"`), indicating an effort to resolve layout issues within the grid.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\analytics\Charts\BarChart.tsx`**:
    *   **Early Changes (around 2:19 PM - 2:21 PM)**: The component initially handled chart height from `sizeInfo` and then briefly introduced a `useEffect` to dynamically update it, which was then removed again. Chart `events` were also temporarily commented out.
    *   **Late-afternoon Refactor and Reversion (around 3:56 PM - 4:00 PM)**: A major refactor introduced `key={height}` to `ReactApexChart` to force re-renders on height changes, simplified data access, and explicitly set `width="100%"`. This entire refactor was subsequently reverted, bringing the component back to its earlier state, without the forced re-render key or explicit width.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\analytics\Charts\PieChart.tsx`**:
    *   **Late-afternoon Refactor and Reversion (around 3:57 PM - 4:01 PM)**: Similar to `BarChart.tsx`, this component underwent a substantial refactor (3:58 PM) to make props optional, add a `key={height}` to `ReactApexChart` for forced re-renders on height changes, and simplify data handling. This refactor was then fully reverted (4:01 PM).

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\pages\dashboard\dashboard-page.tsx`**:
    *   **No Functional Changes (2:25 PM - 10:51 PM)**: This file remained largely stable, with a direct copy observed at 10:41 PM, indicating no functional code modifications during the logged period. It provides the main dashboard structure, data fetching logic for shipments and deliveries, and calendar functionality.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\booking\booking-dashboard.tsx`**:
    *   **Minor UI & Navigation Adjustments (6:22 PM - 10:50 PM)**: The "New Booking" button's navigation `state` was repeatedly changed. Initially it passed `false`, then an object `{isBookingDashboard: false}`, and finally `{isBookingDashboard: true}`. A temporary text change ("New Booking123") was introduced and reverted. These indicate minor adjustments to navigation behavior or flags.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\booking\booking-form.tsx`**:
    *   **No Functional Changes (6:27 PM - 10:51 PM)**: This file also remained stable, with several direct copies observed, indicating no functional code modifications during the logged period. It handles booking form logic, validation, and data submission.

**Patterns and Recurring Elements:**

*   **Debugging via Console Logs**: Frequent addition and removal of `console.log` statements across `metricBox.tsx`, `resizableGridItem.tsx`, and `analyticsContainer.tsx` suggest ongoing debugging efforts for layout, data flow, and chart rendering issues.
*   **Iterative Refactoring and Reversion**: A significant pattern is the repeated cycle of introducing substantial refactors (e.g., in `metricBox.tsx`, `resizableGridItem.tsx`, `BarChart.tsx`, `PieChart.tsx`) and then either partially or fully reverting those changes in subsequent commits. This indicates an experimental or exploratory development approach, possibly grappling with complex state management or component design, especially concerning chart resizing and data propagation.
*   **Chart Resizing and Data Propagation**: There's a persistent challenge with how chart components (`BarChart`, `PieChart`) receive and react to size changes, particularly from their parent `ResizableGridItem` and `MetricsBox`. This is evident in:
    *   The frequent adjustments to how `sizeInfo` is passed and consumed.
    *   The attempts to force re-renders using `key` props on chart components or their wrappers.
    *   The dynamic height calculations within `getChartComponent` in `metricBox.tsx`.
*   **Redux Toolkit Query Cache Invalidation**: The changes in `analytics-api.ts` reflect a careful tuning of how mutations invalidate cached data, specifically for metric size updates, to balance data freshness and performance.
*   **Navigation State Management**: Small, iterative changes to the `state` object passed during navigation in `booking-dashboard.tsx` highlight a precise refinement of how contextual information is transferred between different parts of the application.

## 2:47:09 PM
The changes log primarily revolves around analytics and reporting functionalities within the `t360-backend-v2` project, focusing on booking-related data.

### File-Specific Updates:

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\booking.query.ts`**
    *   **Timestamps:** Multiple entries from 2/2/2026, 4:51:42 PM to 2/3/2026, 1:55:37 PM.
    *   **Content:** This file contains the `bookingQueryBuilder` function, which dynamically generates PostgreSQL queries for various booking analysis reports. It defines interfaces for column configuration and customizer settings (`CalColumn`, `CalColumnConfig`, `Customizer`, `QueryBuilderI`). The function handles different report types such as "Booking Date to Actual Departure", "Booking Date to Actual Departure MblWise", and their "Stacked Bar" chart variations. It integrates with `getColumnsByCategory` and `getFilterQueryByDisplayValue` from `analytics.ts` to customize selected columns and query grouping/ordering. Each report type sets specific customizer flags like `dateRange`, `calType`, `dateColumns`, `booking`, `mblwise`, and `chartType`. The SQL queries consistently calculate `day_diff` (difference between actual departure and booking dates), join `mtr_tracking_data` with `agent_booking_entry` on `mblno`, and filter results by company name and a date range. Stacked bar queries further categorize `day_diff` into week-based buckets (e.g., 'Less than 1 week', '1 - 2 weeks').

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\export.query.ts`**
    *   **Timestamps:** Numerous entries from 2/3/2026, 10:39:44 AM to 2/3/2026, 2:46:13 PM.
    *   **Content:** This file exports the `bookingQuery` function which generates specific SQL query fragments for various reports intended for data export. It includes a `getMonthValue` helper to convert month strings to numeric values. The `bookingQuery` function uses `reportName` to return predefined SQL snippets. Reports covered include "Booking Date to Actual Departure" (and its Stacked Bar/MBL Wise variants), "Booking Date to Estimated Departure" (and MBL Wise variant), and "Booking Date to POD Arrival" (and its MBL Wise/Stacked Bar variants). Similar to `booking.query.ts`, these query fragments join `mtr_tracking_data` and `agent_booking_entry` and filter by company name and date validity. Conditional logic is present for stacked bar exports to filter by month, week, or quarter and group by `day_diff` ranges.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\utils\analytics.ts`**
    *   **Timestamps:** Multiple entries from 2/3/2026, 10:51:20 AM to 2/3/2026, 11:46:21 AM.
    *   **Content:** This utility file provides several functions to support analytics and data handling:
        *   `defaultDateRange`: Generates a default one-year date range for queries.
        *   `replaceValueInQuery`: A utility to replace specific column values (e.g., `pod`).
        *   `getUserObject`: Constructs a user object, handling admin-specific company name and usercode retrieval.
        *   `getFilterQueryByDisplayValue`: Generates `GROUP BY`, `ORDER BY`, `DATE_TRUNC`, and `SELECT` clauses based on `displayBy` (month, week, quarter), which is crucial for dynamic report generation.
        *   `getExcelSelectedColumns`: Determines which columns to select for Excel exports based on the report name and if it's a booking report, with special handling for "Cargo-Ready Date to ETD" and "BL Release KPI" to calculate specific metrics (`networkdays`, `bl_release_date`).
        *   `dateFilterOnExport`: Filters and formats date fields in data for export, converting invalid dates to `null` and formatting valid dates to 'MM/DD/YYYY'. It maintains a comprehensive list of `dateKeys` for this purpose.
        *   `EXCEL_EXPORT_COLUMNS`: An array defining the default key-value pairs for column names in Excel exports, covering various shipping and booking attributes.

### Patterns and Recurring Elements:

*   **Date Handling:** A significant recurring theme is the extensive handling and manipulation of dates, including calculating date differences (`day_diff`), validating date formats (`isValidDate`), filtering by date ranges (`fromDate`, `toDate`, `departure_date`), truncating dates for grouping (`DATE_TRUNC`), and formatting dates for display or export.
*   **Company-Specific Filtering:** All query generation functions (`bookingQueryBuilder`, `bookingQuery`) consistently include a filter based on `account_name` and a `companyList` derived from the `CompanyName` parameter. This suggests a multi-tenant or company-specific data access model.
*   **Report Type-Driven Logic:** The code heavily relies on `type` or `reportName` parameters to conditionally build SQL queries and configure report-specific settings. This indicates a flexible reporting system where different analytics views are generated from a common dataset.
*   **MBL-Wise Reporting:** There's a clear distinction and specific logic for "MBL Wise" (Master Bill of Lading-wise) reports, often adding filters for `mblno` to ensure it's not empty or null.
*   **Stacked Bar Chart Data Preparation:** Reports designed for stacked bar charts involve categorizing day differences into predefined week-based ranges ('Less than 1 week', '1 - 2 weeks', etc.) and using dynamic `GROUP BY` and `ORDER BY` clauses provided by `getFilterQueryByDisplayValue`.
*   **Consistent Data Validity Checks:** SQL queries frequently include `IS NOT NULL` and `!= '0001-01-01 00:00:00 BC'` checks for date fields, indicating a robust approach to handling potentially invalid or default date values in the database.
*   **Utility Integration:** `booking.query.ts` and `export.query.ts` extensively use helper functions from `analytics.ts` for common tasks like column selection, date range filtering, and query parameter generation, promoting code reusability.
*   **Timestamp Pattern:** The multiple, closely spaced timestamps for `booking.query.ts`, `export.query.ts`, and `analytics.ts` on February 3, 2026, suggest a period of active development, refinement, or possibly repeated saving without substantial functional changes between each log entry.

## 2:47:44 PM
The code changes primarily focus on refining the analytics dashboard, particularly around metric chart display and resizing behavior, and making minor adjustments to booking-related components.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\analytics\metricBox.tsx`**
    *   **2/2/2026, 2:02:24 PM**: Initial chart height logic for non-enlarged charts was made dynamic (from fixed 700px to `null`), suggesting reliance on child chart defaults.
    *   **2/2/2026, 2:22:09 PM - 2:22:27 PM**: A console statement typo (`console` to `console.log`) was corrected, indicating active debugging.
    *   **2/2/2026, 2:25:36 PM**: The default non-enlarged chart height was set to a fixed 350px.
    *   **2/2/2026, 3:30:09 PM - 3:30:26 PM**: A temporary change that made enlarged and non-enlarged chart heights identical was reverted.
    *   **2/2/2026, 3:37:50 PM - 3:39:10 PM**: The `MetricsBox` component's props (`MetricsBoxProps`) were extended to accept `sizeInfo` (height and width) from a parent, and its root `Box` styling was updated to respect these passed dimensions, with some minor toggles on the `height` fallback (`'100%'` vs `null`).
    *   **2/2/2026, 3:43:13 PM - 3:55:42 PM**: The file underwent two significant refactoring attempts to simplify the component's internal state and chart rendering logic, only to be largely reverted. These attempts aimed to directly pass height to child charts and remove complex `getChartComponent` logic.
    *   **2/2/2026, 4:00:44 PM - 4:16:13 PM**: A key pattern emerged for addressing chart resizing issues in grid layouts. The `chart-wrapper` div's inner container was given a `key` prop based on `item.columnSpan` and `item.rowSpan`. This forces React to re-render the chart component when its allocated grid space changes, which is crucial for some charting libraries to redraw correctly. This change was added, removed, and repositioned several times before settling into its final form.
    *   **2/2/2026, 4:17:51 PM**: The `chart-wrapper`'s styling was updated to use flexbox (`flex: 1`, `minHeight: 0`), allowing the chart area to dynamically fill available space while keeping the footer visible.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\analytics\analyticsContainer.tsx`**
    *   **2/2/2026, 3:32:47 PM**: The `MetricItem` interface was expanded to include `chartType` and `data`. The `fetchSingleReport` function parameters were made optional, and `fromDate`/`toDate` date formatting logic was enhanced to handle custom date filters.
    *   **2/2/2026, 3:33:37 PM - 3:34:15 PM**: Type safety for endpoint objects was improved by introducing and applying an `EndpointType` interface, with subsequent adjustments to type assertions (`as unknown as EndpointType`).
    *   **2/2/2026, 4:06:35 PM**: The `saveSize` function was refactored to implement optimistic UI updates, dispatching state changes immediately before the API call to save metric size, thereby improving user experience. Error handling for the API call was also added.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\store\api\analytics-api.ts`**
    *   **2/2/2026, 2:08:47 PM - 2:13:26 PM**: The `invalidatesTags` property for the `saveMetricSize` mutation was adjusted multiple times, initially removing `VIEW` then `SIZE` tag invalidation, before finally settling on `["SIZE"]`. This indicates careful consideration of cache invalidation strategies for metric size changes.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\analytics\resizableGridItem.tsx`**
    *   **2/2/2026, 2:12:30 PM**: A `useEffect` hook was added to synchronize the internal `columnSpan` and `rowSpan` state with incoming `initialColumnSpan` and `initialRowSpan` props, ensuring the component reacts to parent-driven size changes. This `useEffect` was also added and removed multiple times.
    *   **2/2/2026, 3:20:40 PM - 3:23:11 PM**: Several rapid changes occurred in the `handleResize` function, correcting a bug where `colS` (column span) was incorrectly calculated, preventing proper horizontal resizing (specifically setting a 2-column span).
    *   **2/2/2026, 3:42:49 PM - 4:11:15 PM**: This component also went through significant refactoring and reversion cycles, similar to `metricBox.tsx`. Key changes included simplifying state management (moving from `useState` to direct prop usage) and then reverting, modifying `useDrag`/`useDrop` collect functions, and refining the `Box` styling for grid placement (`gridColumn: \`span ${columnSpan} / span ${columnSpan}\``) to ensure correct rendering within the grid.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\analytics\Charts\BarChart.tsx`**
    *   **2/2/2026, 2:20:32 PM**: A `useEffect` was added to dynamically update the chart height, making it reactive to `sizeInfo` prop changes, instead of being fixed in initial state. This was later reverted.
    *   **2/2/2026, 3:56:03 PM**: A major refactor introduced `key={height}` to `ReactApexChart`, explicitly forcing chart re-renders when its height prop changes, a critical fix for responsive charts. This change was also later reverted.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\analytics\Charts\PieChart.tsx`**
    *   **2/2/2026, 3:58:42 PM**: Similar to `BarChart.tsx`, the `PieChart` component was refactored to make its `item` and `sizeInfo` props optional and to include `key={height}` on `ReactApexChart` for dynamic resizing. This too was later reverted.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\booking\booking-dashboard.tsx`**
    *   **2/2/2026, 6:23:16 PM - 10:50:48 PM**: Updates primarily involved how navigation is handled for "New Booking" button clicks. The `state` parameter passed to `useNavigate` evolved from a simple boolean (`false`) to a more structured object (`{isBookingDashboard:false}`, then `{isBookingDashboard:true}`). This allows the target booking form to receive context about its origin (e.g., if it's initiated from the dashboard). A temporary text change for the "New Booking" button was also noted.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\booking\booking-form.tsx`**
    *   **2/2/2026, 6:27:10 PM**: The `BookingForm` component received validation schema definitions using Yup for key fields like "Port of Loading," "Port of Discharge," "Booking Date," and "Shipper Name." A `recoverValue` utility was introduced. Initial form values were refined to handle existing booking data, and an `useEffect` was added to trigger approximate transit time fetching based on selected POL and POD values.

**Patterns and Recurring Elements:**

*   **Chart Resizing Complexity**: A significant recurring theme is the struggle to correctly implement dynamic resizing for chart components within a resizable grid. This is evident in the repeated adding and removing of `sizeInfo` props, `useEffect` hooks for height, and especially the use of `key` props on `ReactApexChart` or its wrappers to force re-renders. The reverts suggest difficulties in finding a stable and performant solution.
*   **Debugging with `console.log`**: Numerous `console.log` statements are added and removed across analytics components (`metricBox.tsx`, `resizableGridItem.tsx`), indicating iterative debugging of layout, state, and data flow.
*   **Refactoring and Reversion Cycles**: Both `metricBox.tsx` and `resizableGridItem.tsx` show patterns of substantial refactoring attempts to simplify component logic or structure, followed by immediate or near-immediate reversions. This highlights the challenges of implementing complex UI interactions (like drag-and-drop resizing and dynamic chart rendering) and the iterative process of finding a robust solution.
*   **Gradual Type Safety Improvements**: In `analyticsContainer.tsx`, there's a pattern of incrementally improving type safety through the introduction of specific interfaces (`EndpointType`) and more explicit type assertions, moving away from `any` where possible.
*   **Optimistic UI Updates**: The `analyticsContainer.tsx` demonstrated a best practice for frontend development by implementing an optimistic UI update for saving grid item sizes, where the UI reflects the change immediately, and the server sync happens in the background.