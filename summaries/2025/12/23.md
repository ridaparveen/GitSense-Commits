# Activity Summary for 12/23/2025

## 9:43:50 AM
The file `c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\services\analytics\customerAutosearchOptions.ts`, last modified on 12/18/2025, 3:54:52 PM, introduces a new `getAllCustomerOptions` function. This function handles requests to fetch customer or agent options for autosearch. It dynamically queries either `agent_po_account_master` (for "AGENT" role) or `mtr_tracking_data` (for "CUSTOMER" role), selecting distinct names. For the "CUSTOMER" role, it also supports pagination, calculating `total` and applying `LIMIT` and `OFFSET` based on query parameters. Errors are logged, and a 500 status is returned for internal server errors.

The file `c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\constants\Paths.ts`, updated on 12/18/2025, 3:55:32 PM, expands the application's API routing definitions. It adds new base paths for `CustomerOptions` (`/getCustomerOptions`), `Menu` (`/menus` with `GetUserMenus` endpoint), and `CO2Emission` (`/co2emission` with a `Get` endpoint). Existing paths for various modules like Users, Auth, Shipment, Dashboard, Analytics, and Reports remain in place.

The main router configuration file `c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\routes\index.ts`, timestamped 12/18/2025, 3:56:44 PM, integrates the newly defined routes and services. Specifically, it imports `MenuRoutes`, `Co2EmissionRoutes`, and `getAllCustomerOptions` and mounts them to their respective base paths (`Paths.Menu.Base`, `Paths.CO2Emission.Base`, `Paths.CustomerOptions.Base`) using `apiRouter.use`. This makes the new customer options, menu management, and CO2 emission functionalities accessible via the API.

Significant changes occurred in `c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\export.query.ts` on 12/19/2025, 7:53:25 AM. This file now includes a `getMonthValue` helper function and a robust `bookingQuery` function. The `bookingQuery` function dynamically generates complex SQL queries for various reports, such as "Booking Date to Actual Departure" and "Booking Date to POD Arrival," including "Stacked Bar" and "MBL Wise" variations. These queries involve joining `mtr_tracking_data` and `agent_booking_entry` tables, calculating date differences (`day_diff`), and applying filters based on `CompanyName` and date validity. Crucially, it incorporates conditional logic to dynamically filter by month, week, or quarter and uses `CASE` statements to categorize `day_diff` into specific time ranges (e.g., "Less than 1 week", "1 - 2 weeks") for stacked bar reports.

**Key Patterns and Recurring Elements:**
*   **API Expansion:** The changes consistently indicate an expansion of API capabilities, particularly around customer options, user-specific menus, CO2 emissions, and detailed booking/analytics reports.
*   **Role-Based Data Access:** The `customerAutosearchOptions.ts` file demonstrates fetching data tailored to specific user roles (AGENT vs. CUSTOMER).
*   **Dynamic SQL Generation:** The `export.query.ts` file heavily utilizes dynamic SQL construction, adapting queries based on report parameters, date ranges, and display preferences, with a focus on calculating and categorizing date differences.
*   **Database Interaction:** All files imply direct or indirect interaction with a PostgreSQL database, frequently querying tables like `agent_po_account_master`, `mtr_tracking_data`, and `agent_booking_entry`.
*   **Date Handling:** SQL queries consistently involve extracting date parts, calculating date differences, and validating dates against `NULL` or placeholder values like `'0001-01-01 00:00:00 BC'`.
*   **Timestamp Proximity:** All changes occurred within a short period (December 18-19, 2025), suggesting a concentrated development effort on related features.

## 3:23:51 PM
For the file `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\pages\dashboard\ShipmentTrackingScreen.jsx`, the following changes and information are notable as of **12/23/2025, 10:08:25 AM**:

This file defines the `ShipmentTrackingScreen` React component, which is responsible for displaying comprehensive shipment tracking details.

**Key Features and Structure:**
*   **Data Fetching**: The component retrieves shipment data using `useFetchShipmentTrackingQuery` from a Redux Toolkit API, passing `mblno` and `fileno` obtained from URL query parameters. It displays a `Loader` while data is being fetched.
*   **Layout**: The screen is structured with a `ScreenToolbar` at the top for navigation (back button and title) and two main content columns below:
    *   A wider left column (74%) contains the main shipment information.
    *   A narrower right column (26%) is dedicated to `MilestonesContainer`.
*   **Shipment Details Display**:
    *   **Map and Tracking Stepper**: Incorporates `MapTrackingContainer` to display geographical tracking and `TrackingStepper` to visualize the shipment's progress through various stages.
    *   **Core Shipment Info**: Presents essential details like 'File No', 'BL', 'Supplier', and 'MBL No' using `CardField` components.
    *   **Expandable "More Details" Section**: An interactive section allows users to toggle the visibility of additional shipment information, including 'Customer Ref No.', 'Notify', 'Commodity', 'Consignee', 'Service', 'Piece count', and 'Weight', using `ExpandMoreIcon` and `ExpandLessIcon`.
*   **Navigation**: Provides a `goBack` function using `useNavigate` to return to the previous screen.
*   **Component Usage**: Relies heavily on Material-UI components (`Box`, `Stack`, `Typography`, `IconButton`, etc.) for its UI, along with custom components like `ScreenToolbar`, `Badge`, `OutlinedButton`, `ThemeButton`, `CardField`, `MapTrackingContainer`, `TrackingStepper`, `TrackingInfoContainer`, `MilestonesContainer`, and `Loader`.
*   **Styling Patterns**: Recurring use of white backgrounds, rounded borders, and subtle box shadows (`boxShadow: '0px 1px 8px 0px #0000001A'`) for card-like containers, indicating a consistent design language.
*   **Data Formatting**: Includes a `fieldFormater` utility to handle specific data fields, like extracting `key` from a `status` object. A `formatDate` utility is also defined for date presentation.
*   **Debugging**: Contains `console.log` statements for `PARAMS` and `shipment page info`, suggesting ongoing development or debugging efforts.
*   **Import Pattern**: Imports for API hooks (`useFetchShipmentTrackingQuery`, `useFetchVesselTrackingQuery`) and utility functions (`appDateFormat`) are standard for Redux Toolkit and date formatting.

## 3:23:56 PM
The provided logs detail a series of backend code changes primarily focused on expanding analytics, reporting, and data retrieval capabilities, along with significant API route additions.

**Key Changes by File:**

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\services\analytics\customerAutosearchOptions.ts` (Timestamp: 12/18/2025, 3:54:52 PM)**
    This file introduces the `getAllCustomerOptions` service function. Its primary role is to fetch distinct customer names for autosearch functionalities, tailored by user `role` (AGENT or CUSTOMER). For AGENTs, it queries `agent_po_account_master`, while for CUSTOMERs, it queries `mtr_tracking_data` and includes pagination support. Results are consistently formatted as `[{ value: name, label: name }]`.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\constants\Paths.ts` (Timestamp: 12/18/2025, 3:55:32 PM)**
    This file, which defines application API endpoints, has undergone significant expansion. New base paths and endpoints have been added for:
    *   `CustomerOptions`: A new base path `/getCustomerOptions`.
    *   `CO2Emission`: A new module with base path `/co2emission` and a `/get` endpoint.
    *   `Planboard`: A new module with base path `/planboard` and a `/get` endpoint.
    *   `Menu`: A new module with base path `/menus` and a `/getusermenus` endpoint.
    *   `Audit`: A new `/audit` get endpoint.
    *   Existing modules like `Analytics` have seen a substantial increase in endpoints, adding paths for various metrics (`GetCbm`, `GetKgs`, `GetTeu`, `GetContainers`, `GetTransit`), table data (`GetTablesData`), and other reporting features.
    *   `Shipment` now includes specific milestone endpoints for `air` (`GetAirMilestone`).
    *   `User` gained a `GetUserSettings` endpoint.

*   **`c:\Users\ridap\OneDrive\T360-V2\t360-backend-v2\src\routes\index.ts` (Timestamp: 12/18/2025, 3:56:44 PM)**
    This central routing file has been updated to integrate the newly defined paths and services. It now imports and uses `PlanbaordRoutes`, `MenuRoutes`, `Co2EmissionRoutes`, and directly links the `getAllCustomerOptions` and `getAllAudit` service functions to their respective API paths (`Paths.CustomerOptions.Base` and `Paths.Audit.Get`). This signifies the activation and accessibility of the new features through the API.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-backend-v2\src\common\util\export.query.ts` (Timestamp: 12/19/2025, 7:53:25 AM)**
    This file focuses on generating dynamic SQL queries for various booking-related reports. It introduces a `getMonthValue` helper function for month name-to-number conversion. The core `bookingQuery` function accepts numerous parameters (report name, company, date filters, stacking options) to construct specific SQL queries. These queries consistently involve joins between `mtr_tracking_data` and `agent_booking_entry`, calculate day differences between various booking/departure/arrival dates, and include complex conditional logic for filtering by month, week, or quarter and categorizing time differences into predefined buckets (e.g., "Less than 1 week") for stacked bar charts. This file represents a significant enhancement to the reporting backend.

**Patterns and Recurring Elements:**

*   **Analytics and Reporting Expansion:** A dominant theme is the extensive development of analytics and reporting features, evidenced by new `Analytics` endpoints, dedicated reporting queries in `export.query.ts`, and customer autosearch options.
*   **API Route Proliferation:** The `Paths.ts` and `index.ts` changes show a rapid expansion of API endpoints, indicating the introduction of many new features or granular access to existing ones across different modules like Shipments, Booking, User, and entirely new modules such as CO2 Emission and Planboard.
*   **Database-Centric Operations:** The services heavily rely on direct database queries, joining tables like `mtr_tracking_data` and `agent_booking_entry` to retrieve and process data.
*   **Date/Time Manipulation in Queries:** SQL queries frequently use `EXTRACT` and `DATE_PART` functions for calculating date differences and filtering by specific time periods (month, week, quarter), especially for analytical reports.
*   **Role-Based Logic:** There's an instance of role-based data fetching (`getAllCustomerOptions`) which suggests differing data access based on user type.
*   **Structured Data Output:** Service functions tend to format their output consistently (e.g., `[{ value: ..., label: ... }]` for dropdowns).
*   **Error Handling and Logging:** Services include basic `try...catch` blocks and `logger.error` calls for robust error management.
*   **Future-Dated Timestamps:** All timestamps are from December 2025, indicating that these log entries might be from a planned or future development cycle.

## 3:24:43 PM
The changes log details a series of focused updates across several frontend files, primarily on December 23, 2025, suggesting a single, intensive development session. The main areas of focus are booking approval functionality and a shipment tracking stepper component, with a recurring theme of refactoring and visual adjustments.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\booking\booking-view.tsx`**
    *   **12/23/2025, 10:01:40 AM**: This component handles the booking approval process. It uses `Formik` for form management and displays PO details, inventory requirements, and vessel details in dynamic editable tables. It includes logic for adding/editing/deleting vessel data, saving booking status (approve/cancel), and validating rejection reasons. A `LocationPath` component visualizes POL/POD.
    *   **12/23/2025, 10:15:06 AM**: A minor cleanup occurred, specifically the removal of a `console.log` statement related to `booking approve container` data. The provided code snippet also extended to include the "Vessel Details" card, indicating more of the component's structure in the log.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\pages\shipment\shipment-details-page.tsx`**
    *   **12/23/2025, 10:15:23 AM**: This page displays detailed shipment information, fetching both ocean and air shipment details based on query parameters. It features a `MapContainer`, tabs for messages and documents, and renders milestone containers. A previous inline display of location markers and arrows was present.
    *   **12/23/2025, 10:27:36 AM**: The `TrackingStepper` component was imported and integrated into the shipment details page. The previous inline display for location markers (`HiLocationMarker`, `MdOutlineArrowForward`) was commented out, indicating that the new `TrackingStepper` component took over the responsibility for visualizing the shipment route.
    *   **12/23/2025, 2:37:36 PM & 2:37:50 PM**: Continued refinement on the shipment details page. The section responsible for displaying "Port of Lading" and "Port of Discharge" using `HiLocationMarker` and `MdOutlineArrowForward` was commented out, further confirming the `TrackingStepper` as the primary component for route visualization. A `div` that wrapped the `TrackingStepper` and other info was slightly restructured.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\utils\utils.ts`**
    *   **12/23/2025, 10:26:14 AM**: This file contains various utility functions, notably `appDateFormat` for date formatting, `parseRawString` for string manipulation, `useDateFormate` for dynamic date formatting based on user preferences, `dateFilterHandle` for date range filtering, and `showLessText` for truncating text. This file remained unchanged throughout the logged period, suggesting its utilities were stable and reused.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\pages\shipment\tracking-stepper.tsx`**
    *   **12/23/2025, 10:25:42 AM**: Initial implementation of `TrackingStepper`. It calculates travel progress, generates a timeline (POL, POD, potentially rail/truck moves), and validates completion. It uses `RadioButtonCheckedIcon` and locally imported SVG icons for transport modes.
    *   **12/23/2025, 10:30:10 AM**: Refactored icon imports to `assets/svg-list` for better organization.
    *   **12/23/2025, 10:39:50 AM**: Introduced `LocationPinIcon` (SVG) to replace `RadioButtonCheckedIcon` for step markers, changing the visual style.
    *   **12/23/2025, 11:09:06 AM**: A significant refactor introduced `getScope` and `getFinalDates` helpers to abstract shipment scope (Port-Port, Port-Rail, Port-Door) and inland date calculations. The `getTrackingDetails` logic was rewritten to leverage these, and `LocationPinIcon`'s size was slightly reduced.
    *   **12/23/2025, 11:50:11 AM**: Major attempt to switch to `@iconify/react` for transport icons (Vessel, Port, Rail) via a new `TransportIcon` component. This version removed the `LocationPinIcon` from the main map iteration, implying a visual change in how step markers were rendered.
    *   **12/23/2025, 11:53:47 AM - 12:00:00 PM (approx)**: A series of partial reverts and minor adjustments. The `@iconify/react` icon system was largely reverted, bringing back the custom SVG imports for `VesselSVGIcon`, `TruckSVGIcon`, `TrainSVGIcon`, while `LocationPinIcon` remained. `getTrackingDetails` reverted to an earlier, more complex state. Duplicate timeline entries were briefly introduced and removed.
    *   **12/23/2025, 12:04:08 PM**: Re-attempted to streamline the timeline into three core steps (POL, POD, Final Destination). `getFinalInlandDates` was properly integrated, using `trackingInfo.shipment_scope` (with "P-R" and "P-D" values). `TrainSVGIcon` and `TruckSVGIcon` were redefined using `@iconify/react` for better control, and their placement on the connecting line was refined.
    *   **12/23/2025, 12:06:21 PM**: The "Final Destination" label was made dynamic, using `trackingInfo.place_of_delivery`.
    *   **12/23/2025, 12:13:04 PM - 12:17:02 PM**: Further minor adjustments and apparent bugs, such as `TruckSVGIcon` temporarily displaying an anchor icon. Duplicate POD entries were re-added and removed again.
    *   **12/23/2025, 12:18:40 PM**: Another significant refactor: simplified `LocationPinIcon` to use `@iconify/react`, introduced `ShipIcon`, `AnchorIcon`, `TrainIcon` as `@iconify/react` components. The timeline generation in `getTrackingDetails` was simplified, focusing on essential steps. JSX was restructured for clearer icon placement on the line.
    *   **12/23/2025, 12:20:22 PM - 12:24:25 PM**: More reversions and micro-adjustments. The `getTrackingDetails` logic was reverted to an earlier state, and `LocationPinIcon` returned to raw SVG. The `CalendarMonthOutlinedIcon` in the subtitle was commented out, indicating a design change for date display.
    *   **12/23/2025, 2:30:10 PM**: A major overhaul of the component's styling (`s` object) and JSX rendering. It introduced a distinct visual for the "Departed" date, and refined the progress line with separate "completed" and "remaining dotted" sections, alongside repositioned vehicle icons.
    *   **12/23/2025, 2:30:32 PM - 2:45:25 PM**: A series of iterative style and logic tweaks. This included commenting/uncommenting style properties, adjusting `minWidth` for rows, and adding hardcoded fallback dates (`'2025-04-29'`) for ETA/ATA in the POD subtitle, possibly for testing scenarios.

**Patterns and Recurring Elements:**

*   **Intensive Refactoring in `tracking-stepper.tsx`**: The `tracking-stepper.tsx` file experienced continuous and often cyclical changes. This indicates an active development process involving repeated attempts to refine the component's logic, data handling, icon system, and visual presentation. There were notable shifts between custom SVG icons and `@iconify/react`.
*   **Debugging and Testing**: Frequent addition/removal of `console.log` statements and brief introductions of hardcoded fallback data (e.g., `'2025-04-29'`) suggest active debugging and testing during the development session.
*   **Date Handling**: The `appDateFormat` utility is consistently used for presenting dates. Regular expressions in `validateTimelineCompletion` are used to check for date patterns, and there's a clear effort to define and use `finalETA`/`finalATA` based on shipment scope.
*   **Styling Iteration**: Numerous small adjustments to `sx` properties within MUI `Box` and `Typography` components, as well as commenting/uncommenting blocks of CSS-in-JS styles, highlight continuous UI/UX refinement. The move to a more structured styling in the final entries shows a more resolved design.
*   **Shipment Scope Logic**: The introduction and refinement of `getFinalInlandDates` and its `shipment_scope` logic (`P-R`, `P-D`) signify an ongoing effort to make the tracking stepper dynamic and accurate for different logistics scenarios.
*   **Visual Evolution**: The change from simple `RadioButtonCheckedIcon` to custom `LocationPinIcon` (SVG), and then the experimentation with various transport icons (`VesselSVGIcon`, `TruckSVGIcon`, `TrainSVGIcon`, and later `@iconify/react` versions) shows a clear focus on enhancing the visual clarity and appeal of the tracking interface. The final styling updates in the 2 PM range significantly improve the aesthetic of the progress line.

## 4:31:38 PM
The provided log details recent code changes primarily focused on frontend components for booking and shipment tracking.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\screen\booking\booking-view.tsx`**
    *   **Timestamp: 12/23/2025, 10:01:40 AM & 10:15:06 AM**
    *   This component (`BookingApproveContainer`) manages the approval process for bookings. Changes include handling PO details, inventory requirements, and vessel details.
    *   It features dynamic editable tables for PO and inventory.
    *   Key logic involves fetching booking details (`useFetchCustomerApproveDetailsQuery`), managing vessel data with states (`vesselData`, `editingRowId`), and mutations for adding/saving vessel information (`useAddVesselMutation`, `useSaveBookingStatusMutation`).
    *   An approval/cancellation flow is implemented, requiring a reason for rejection.
    *   A `LocationPath` component visually represents the origin (POL) and destination (POD) of the shipment.
    *   No significant functional changes were recorded between the two timestamps for this file; the second entry appears to be a slight re-save or minor, non-functional alteration.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\pages\shipment\shipment-details-page.tsx`**
    *   **Timestamp: 12/23/2025, 10:15:23 AM**
    *   Initial version of the `ShipmentDetailsPage` component, displaying shipment information, a map, tracking progress, and tabs for messages and documents. It distinguishes between air and ocean shipments and loads data accordingly (`useFetchAirShipmentDetailsQuery`, `useFetchShipmentDetailsQuery`).
    *   **Timestamp: 12/23/2025, 10:27:36 AM**
    *   Introduced and integrated the `TrackingStepper` component, importing it from `./tracking-stepper`. This new component is rendered within the page, replacing or complementing previous shipment progress indicators.
    *   **Timestamp: 12/23/2025, 2:37:36 PM, 2:37:50 PM, 2:38:05 PM**
    *   Further refined the display by commenting out an inline `div` for location details (`HiLocationMarker`, `MdOutlineArrowForward`) and adjusted the positioning of the `TrackingStepper` within the UI. This indicates a shift towards centralizing location visualization within the `TrackingStepper` itself.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\utils\utils.ts`**
    *   **Timestamp: 12/23/2025, 10:26:14 AM**
    *   This utility file provides date formatting (`appDateFormat`, `useDateFormate`, `dateFilterHandle`) and text truncation (`showLessText`) functions.
    *   Changes specifically involve the `appDateFormat` helper being used in `tracking-stepper.tsx`, demonstrating consistency in date representation across the application.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\assets\svg-list.tsx`**
    *   **Timestamp: 12/23/2025, 10:29:34 AM**
    *   This file initially defines `VesselSVGIcon`, `TruckSVGIcon`, and `TrainSVGIcon` as React components rendering inline SVG paths. These are visual assets for transport modes.
    *   **Timestamp: 12/23/2025, 10:35:36 AM**
    *   `VesselSVGIcon` and `TrainSVGIcon` were temporarily commented out.
    *   **Timestamp: 12/23/2025, 10:35:51 AM**
    *   `VesselSVGIcon` and `TrainSVGIcon` were uncommented, restoring their definitions.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\pages\shipment\tracking-stepper.tsx`**
    *   This file underwent the most significant and frequent changes, indicating an active phase of development and refinement for shipment tracking visualization.
    *   **Initial Implementation (10:25:42 AM - 10:30:10 AM):** Introduced `TrackingStepper` with functions like `polToPodcompletedValidation`, `getTravelProgress`, `getTrackingDetails`, and `validateTimelineCompletion`. It initially used direct SVG imports for transport icons, later switching to import from `assets/svg-list`.
    *   **Iterative Refinements & Reverts (10:37:10 AM - 12:17:02 PM):**
        *   Repeated commenting/uncommenting of the `iconRow` (visual display of vehicle icons on the line).
        *   Introduction of a custom `LocationPinIcon` and changes to its coloring logic (e.g., using `"#e76ab7ff"` then reverting to `"#2E7D32"` for completed states).
        *   Several refactors to the core logic of `getTrackingDetails`, including the introduction of `getScope` and `getFinalDates` helpers to handle different shipment scopes (e.g., "PORT_PORT", "PORT_RAIL", "PORT_DOOR").
        *   Transitions between defining transport icons as local SVG JSX components and using `@iconify/react` for more flexible icon management.
        *   Temporary additions of duplicate timeline steps (e.g., multiple POD or POL entries) for debugging, followed by their removal.
        *   Adjustments to inline styles, particularly `minWidth` for visual rows and `vehicleBox` positioning.
    *   **Major Restructure (12:18:40 PM):**
        *   Simplified the `TrackingStepper` by removing the `module` prop, hardcoded `notCompletedLabelColor`, and most of the `polToPodcompletedValidation`, `getTravelDetails`, and `validateTimelineCompletion` logic into a more streamlined `getTrackingDetails` function.
        *   Adopted `Icon` component from `@iconify/react` for all transport icons, defining `ShipIcon`, `AnchorIcon`, `TrainIcon` constants.
        *   Completely rewrote the component's styling (`s` object) for a cleaner, more adaptive layout.
    *   **Revert & Further Refinement (12:20:22 PM - 2:45:25 PM):**
        *   Reverted to a more complex structure, re-introducing many of the previously removed functions and logic (e.g., `polToPodcompletedValidation`, `getFinalInlandDates`, `validateTimelineCompletion`).
        *   Continued to refine how icons are handled (e.g., `ShipIcon` vs `VesselSVGIcon` for POL).
        *   Introduced `getFinalInlandDates` as a helper function *outside* the component, calculating final ETA/ATA based on `shipment_scope` values like "P-R" and "P-D".
        *   Modified the label for the final destination step to use `trackingInfo.place_of_delivery`.
        *   Temporarily hardcoded dates for ETA/ATA in POD subtitles for testing.
        *   Commented out the `CalendarMonthOutlinedIcon` from the subtitle display.
    *   **Final Styling & Logic Polish (2:30:10 PM - 4:05:18 PM):**
        *   Reintroduced a `departedText` display.
        *   Significant overhaul of styling for the progress line, utilizing `lineCompleted` and `lineRemaining` with dashed backgrounds to visually represent completion.
        *   Continued minor adjustments to positioning and sizing in styles.
        *   Final adjustments to how `finalInlandATA` is formatted and displayed in subtitles for rail-based shipments, ensuring correct date object handling.
        *   Small adjustments to `minWidth` for `iconRow` and `infoRow` between `600px` and `800px`.

**Patterns and Recurring Elements:**

*   **Iterative Development and Refactoring:** The `tracking-stepper.tsx` file clearly shows a pattern of rapid iteration, including significant refactoring, temporary code additions/removals (like commented-out blocks or duplicate elements), and frequent adjustments to logic and styling. This suggests an active development phase focused on optimizing the component.
*   **Shipment Tracking Focus:** A core theme is the development and refinement of a visual shipment tracking stepper, including calculation of progress, dynamic display of transport icons (vessel, train, truck), and detailed date information for various points in the journey (POL, POD, final destination, inland rail).
*   **Icon Management:** There's an evolution in how SVG icons are handled, from inline SVGs to imports from a dedicated `svg-list.tsx` file, and then further to using the `@iconify/react` library for more versatile icon integration.
*   **Date Handling:** Consistent use of custom date formatting utilities (`appDateFormat`) for display purposes across all relevant components.
*   **Conditional Rendering/Logic:** Heavy reliance on conditional logic (e.g., `if (trackingInfo.inland_rail_move !== 'Yes')`, `if (scope === "P-R")`) to adapt the tracking display based on shipment characteristics.
*   **Debugging Practices:** Frequent use of `console.log` statements and commenting out blocks of code indicates active debugging during development.
*   **Styling Refinement:** Continuous adjustments to MUI `sx` props for visual layout, spacing, and element appearance, aiming for a polished user experience.

## 5:59:06 PM
The changes primarily focus on refactoring and enhancing the `TrackingStepper` component, which is used to display shipment tracking progress.

**File-specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\utils\utils.ts` (12/23/2025, 10:26:14 AM)**
    *   This file introduces two new utility functions: `parseRawString` for cleaning and splitting raw string data (e.g., removing braces, backslashes, quotes, and newlines before splitting by comma/whitespace) and `showLessText` for truncating strings with an ellipsis.
    *   The `appDateFormat` function remains, handling date formatting to "MM/DD/YYYY" or "YYYY-MM-DD".
    *   A `useDateFormate` hook is added to dynamically format dates based on user preferences fetched from an API.
    *   A `dateFilterHandle` function is added to generate `fromDate` and `toDate` based on common date filters (e.g., "today", "this\_week", "last\_month", "custom").

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\pages\shipment\tracking-stepper.tsx` (Multiple timestamps from 12/23/2025, 10:26:39 AM to 4:59:39 PM)**
    *   **Initial Refactoring (10:26:39 AM):** The `TrackingStepper` component is introduced, replacing an older `Stepper` component in `shipment-details-page.tsx`. It imports `appDateFormat` and `showLessText` from `utils`. It defines `polToPodcompletedValidation` for determining completion status, `getTravelProgress` for calculating percentage, and `getTrackingDetails` to build the timeline. Icons (Vessel, Truck, Train) are initially imported from `../../../assets/svg`.
    *   **SVG Import Path Change (10:30:10 AM):** The import path for `TrainSVGIcon`, `TruckSVGIcon`, and `VesselSVGIcon` is updated from `../../../assets/svg` to `assets/svg-list`.
    *   **SVG Definition Relocation (10:29:34 AM, 10:35:36 AM, 10:35:51 AM):** The SVG icons (Vessel, Truck, Train) are defined directly in `src\assets\svg-list.tsx`. The `VesselSVGIcon` definition is temporarily commented out, then uncommented shortly after, while `TrainSVGIcon` definition is also temporarily commented out in one commit but remains defined.
    *   **UI Changes and Icon Replacement (10:37:10 AM, 10:37:18 AM, 10:39:50 AM - 12:23:31 PM):**
        *   The visual representation of tracking points changes from `RadioButtonCheckedIcon` to a custom `LocationPinIcon` SVG.
        *   There are iterative changes to the `getTrackingDetails` logic, specifically around how the timeline is constructed and how icons are assigned based on `trackingInfo` properties like `inland_rail_move`.
        *   Introduction of new helper functions `getScope` and `getFinalDates` to determine the shipment scope (PORT\_PORT, PORT\_RAIL, PORT\_DOOR) and calculate final ETA/ATA.
        *   Consolidation of icon handling by introducing `TransportIcon` component using `@iconify/react` library, and then reverting to direct SVG/component imports.
        *   Further changes in icon logic, introducing `ShipIcon`, `AnchorIcon`, and `TrainIcon` (using `@iconify/react` for the latter two) directly within the `tracking-stepper.tsx` file instead of importing `TrainSVGIcon` and `TruckSVGIcon` from `svg-list`.
        *   Modifications to the `polToPodcompletedValidation` logic, simplifying the date comparison.
        *   The `getTrackingDetails` function is rewritten multiple times, simplifying the timeline generation and directly using the new icon components.
        *   Changes in styling for `lineWrapper` and `vehicleBox` and adjustment of `minWidth` for `iconRow` and `infoRow`.
        *   Temporary comments of `CalendarMonthOutlinedIcon` in rendering for `item.subtitle`.
        *   Introduction of `trackingInfo.shipment_scope` for `getFinalInlandDates` and using "P-R" and "P-D" as scope identifiers.
        *   Multiple adjustments to the `subtitle` formatting in `getTrackingDetails`, including hardcoded fallback dates ('2025-04-29') during testing/development.
        *   Re-introduction of the original `polToPodcompletedValidation` and `getTravelProgress` functions, indicating a reversion or alternative approach to the simplified logic.
        *   Multiple back-and-forth changes on what icons (`TruckSVGIcon`, `TrainSVGIcon`, `VesselSVGIcon`) are imported and used, and how percentages are calculated.
        *   Temporary removal of `Rail Destination` timeline entry when `inland_rail_move` is "Yes", replacing it with a modified "Consignee Location" entry.
        *   Refinement of `getTrackingDetails` logic specifically for rail moves, to handle `podReached` and `isRailOntheWay` conditions for icon and percentage display.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\pages\shipment\shipment-details-page.tsx` (12/23/2025, 10:27:36 AM, 2:37:36 PM, 2:37:50 PM, 2:38:05 PM)**
    *   **Integration of `TrackingStepper` (10:27:36 AM):** The `ShipmentDetailsPage` component is updated to import and use the new `TrackingStepper` component, replacing a commented-out `Stepper`. It also introduces `MilestoneContainerV2`.
    *   **Styling and Layout Adjustments (2:37:36 PM - 2:38:05 PM):** Comments for a div with `HiLocationMarker` and `MdOutlineArrowForward` are added, indicating a previous or alternative display for location information. The `TrackingStepper` is wrapped in a `div` with `py-4` padding, and then the parent `div` containing `getPriorityDateLabel` is also subject to `py-4` adjustments.

**Patterns and Recurring Elements:**

*   **Date Formatting and Handling:** The `appDateFormat` utility is consistently used across relevant files. There's a clear pattern of parsing and displaying dates in "MM/DD/YYYY" or "YYYY-MM-DD" formats. Dynamic date formatting based on user preferences is introduced.
*   **Shipment Tracking Logic:** The `TrackingStepper` component is the central focus, undergoing numerous iterations.
    *   **Timeline Generation:** The `getTrackingDetails` function consistently constructs a `timeline` array containing shipment points (POL, POD, Final Destination/Consignee Location) with associated labels, subtitles (dates), completion status, and visual icons.
    *   **Completion Logic:** The `polToPodcompletedValidation` and `validateTimelineCompletion` functions are frequently modified, indicating ongoing refinement of how shipment stages are marked as "completed" and how progress percentages are calculated. The `hasValidDate` helper is used to check for date presence in subtitles to determine completion.
    *   **Iconography:** There's an evolution in how transport icons (Vessel, Truck, Train) are handled, moving from direct SVG imports to using a more abstract `TransportIcon` with an `Icon` component from `@iconify/react`, then back to direct SVG components defined within `svg-list.tsx` or `tracking-stepper.tsx`. The styling of the progress line with vehicle icons is a recurring element.
    *   **Conditional Rendering/Logic:** Heavy use of conditional logic (`if`/`else` statements, ternary operators) within `getTrackingDetails` to adapt the timeline and icon display based on shipment attributes like `inland_rail_move`, `trucker`, `delivery_customer_location`, and `delivery_customer_date`.
    *   **Console Logging:** Frequent `console.log` statements throughout `tracking-stepper.tsx` suggest active debugging and development of the tracking logic.
*   **Component Structure:** The use of `Box`, `Tooltip`, `Typography` from `@mui/material` is consistent for UI layout and presentation.
*   **Styling:** A common pattern of using a `s` object for inline styling (`sx` prop in MUI) is observed.
*   **Percentage Calculation:** An `useEffect` hook in `TrackingStepper` consistently calculates and reports the overall shipment completion percentage.

## 5:59:11 PM
The provided log details a single significant update to the `ShipmentTrackingScreen.jsx` file at `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\pages\dashboard\ShipmentTrackingScreen.jsx` on `12/23/2025, 10:08:25 AM`.

**File-Specific Updates (`ShipmentTrackingScreen.jsx`):**

This file represents a React component responsible for displaying detailed shipment tracking information. Key changes and features include:

*   **Imports and Component Structure:** Extensive use of Material-UI components (e.g., `Box`, `Card`, `Stack`, `Typography`, `IconButton`) for building the user interface. It also imports several custom components like `ScreenToolbar`, `MapTrackingContainer`, `TrackingStepper`, `TrackingInfoContainer`, `MilestonesContainer`, `CardField`, and a `Loader`.
*   **Data Fetching:** The component leverages `useFetchShipmentTrackingQuery` to fetch shipment data, and potentially `useFetchVesselTrackingQuery` (though only `useFetchShipmentTrackingQuery` is actively used in the provided code snippet). Data is fetched based on `mblno` and `fileno` extracted from URL query parameters. A `Loader` component is displayed while data is loading or fetching.
*   **Layout and Information Display:**
    *   A `ScreenToolbar` is used at the top, featuring an `ArrowBackIcon` for navigation and displaying a dynamic shipment number (`Shipment123 #{params.mblno}`).
    *   The main content is structured into two columns: a wider (74%) left column for primary tracking details and a narrower (26%) right column dedicated to milestones.
    *   The left column includes:
        *   `MapTrackingContainer`: To display map-based tracking and vessel information.
        *   `TrackingStepper`: To visualize the progress of the shipment.
        *   A detailed information `Box` which displays core shipment data (`File No`, `BL`, `Supplier`, `MBL No`) using `CardField` components. This section includes a "More Details" toggle (`showMore` state, controlled by `ExpandLessIcon` and `ExpandMoreIcon`) to conditionally reveal additional fields like `Customer Ref No.`, `Notify`, `Commodity`, `Consignee`, `Service`, `Piece count`, and `Weight`.
        *   `TrackingInfoContainer`: For further detailed tracking information.
    *   The right column contains `MilestonesContainer` to show shipment milestones.
*   **State Management and Navigation:** `useLocation` and `useNavigate` from `react-router-dom` are used for URL parameter handling and navigation. `React.useState` manages UI-specific states like `showMore`.
*   **Helper Functions:** Includes `formatDate` (though not directly used in the visible render) and `fieldFormater` to safely access and format data fields, particularly handling the 'status' field to display its `key` property.

**Patterns and Recurring Elements:**

*   **Material-UI for UI Development:** The code heavily relies on Material-UI components for layout, styling, and interactive elements, indicating a consistent design system.
*   **Component-Based Architecture:** Information is broken down into smaller, reusable components (e.g., `CardField`, `ScreenToolbar`, `TrackingStepper`, `MapTrackingContainer`), promoting modularity.
*   **Data-Driven UI:** The user interface is dynamically rendered based on data fetched from API calls, with clear handling for loading states.
*   **URL Query Parameters:** `mblno` and `fileno` are consistently used as primary identifiers extracted from the URL to fetch and display specific shipment data.
*   **Conditional Rendering:** Elements like the "More Details" section are conditionally rendered, enhancing user experience by allowing toggling of detailed views.
*   **Styling Consistency:** Uses `sx` prop for Material-UI components to apply styles, often including common patterns like `backgroundColor: "#fff"`, `borderRadius: "8px"`, and `boxShadow`.