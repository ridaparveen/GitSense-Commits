# Activity Summary for 12/6/2025

## 11:40:30 AM
The changes log details updates across two main files: `config.js` and `modules\login-req-notify\nofifyAdmin.js`.

**File: `c:\Users\ridap\OneDrive\Documents\cng-batches\cng-batches\config\config.js`**

This file, which manages configuration for both development and production environments, saw frequent modifications related to email recipient lists, database credentials, and file paths.

*   **12/5/2025, 2:06:15 PM:** The initial state defined comprehensive configurations including database credentials, numerous file paths for various batch processes (e.g., ISF XML, CLB XML, Excel reports), OTM integration credentials, and extensive email notification lists for different reports and events. SFTP configurations were also present.
*   **12/5/2025, 2:13:27 PM:** The `userRegistrationApproval` email configuration in the `development` environment was updated. A specific email address (`ridaparveen679@gmail.com`) was moved from the `to` list to the `cc` list, while the primary `to` list was streamlined to include other administrative contacts.
*   **12/5/2025, 2:14:56 PM:** A new `customer` field was added to the `userRegistrationApproval` email configuration within the `development` environment, specifying a customer email address.
*   **12/5/2025, 2:18:39 PM:** Further adjustments were made to the `cc` list within `development.email.userRegistrationApproval`, removing some addresses and adding `rida@dyneinfotech.com`. Formatting of the `support_team` email list was also subtly changed.
*   **12/5/2025, 2:21:30 PM:** Significant changes were made to the `development` environment settings:
    *   The database name was updated from `Rida_Database` to `tmodal`.
    *   The database password was changed.
    *   The `googleTokenPath` was updated from a local `C:` drive path to a `D:/Projects` path.
    *   The `all` email recipient list was reduced, removing `rida@dyneinfotech.com`.
*   **12/5/2025, 2:24:48 PM:** New file paths were introduced in both `development.paths` (`cngInvXmlPath`, `sprInvXmlPath`) and `production.paths` (same new paths, but with empty strings for production). Additionally, a seemingly misconfigured `to` email entry was added directly under the `development.email` object, outside of a specific report or approval type.

**File: `c:\Users\ridap\OneDrive\Documents\cng-batches\cng-batches\modules\login-req-notify\nofifyAdmin.js`**

This file, responsible for notifying administrators about new user registrations and requesting additional information, underwent refactoring and logging improvements.

*   **12/5/2025, 2:09:33 PM:** The initial version of the `notifyAdmin` class was present. It fetched new users, generated an email for general notification, updated an `emailcounter` for users, and then sent a second email for "additional information required" to eligible users (those with `emailcounter` less than or equal to 2). The HTML content for this second email was embedded directly within the `notifyAdmin` method.
*   **12/5/2025, 2:10:02 PM:** The logic for generating the "additional information required" email was refactored. The embedded HTML was replaced with a call to the existing `this.generateUserRegisterApprovalEmailContent()` method, improving code organization. The support team contact email in the template was updated to use a configured value (`config.email.userRegistrationApproval.support_team`) instead of dynamically mapping user emails.
*   **12/5/2025, 2:15:39 PM:** An attempt was made to personalize the "additional information required" email by dynamically inserting the customer's name from `config.email.userRegistrationApproval.customer` into the greeting (`Dear [Customer Name]`).
*   **12/5/2025, 2:16:45 PM:** The dynamic customer name insertion was reverted, and the greeting in the "additional information required" email was hardcoded to "Dear Rajeev,".
*   **12/5/2025, 2:20:06 PM:** Several `console.log` statements throughout the `notifyAdmin` method were replaced with `logger.info` calls, indicating an upgrade in logging practices to use a more structured logging framework.
*   **12/5/2025, 2:20:20 PM:** No functional changes were observed at this timestamp, likely a save operation.

**Patterns and Recurring Elements:**

*   **Email Configuration Focus:** A significant portion of the changes across both files revolves around email notifications, including recipient lists, sender details, and the content of email templates. There is an ongoing effort to refine who receives which notifications and the personalization of these emails.
*   **Development Environment Adjustments:** Many specific value changes in `config.js`, such as database settings and local paths, pertain to the `development` environment, suggesting active local development and testing.
*   **Refactoring and Logging Improvements:** The `nofifyAdmin.js` file shows a pattern of code refactoring to improve modularity (moving HTML content to a dedicated function) and a clear shift towards using a more robust logging mechanism (`logger.info` instead of `console.log`).
*   **Iterative Refinement:** Multiple timestamps show small, consecutive changes to the same lines of code (e.g., email recipient lists, email template content), indicating an iterative development process.

## 11:41:11 AM
The code change log reveals significant development and refactoring primarily focused on the House Bill of Lading (HBL) and Purchase Order (PO) forms within a booking application, alongside updates to an API service and a cargo management component.

### File-Specific Updates:

**1. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblPoForm.jsx`**
- **12/3/2025, 12:25 PM - 12:27 PM**: The `PODetailsExtend` component was initially defined, using `formik.values.client_name` to conditionally render "Basic PO" or "Linked PO" tabs. It was quickly renamed to `HblPODetails` and updated to receive `values` directly as a prop instead of `formik`.
- **12/3/2025, 1:01 PM - 3:23 PM**: Minor debugging `console.log` statements were added to inspect `values`.
- **12/3/2025, 3:25 PM**: The `BasicPoExtend` sub-component was replaced with a new component, `BasicPoForHbl`, for the "Basic PO" tab.
- **12/3/2025, 3:49 PM**: A significant logic change occurred in the `useEffect` hook. Instead of `values.client_name`, the tab selection now depends on `values.basicPoList?.[0]?.customer`, meaning the initial tab is set based on the customer associated with the first basic PO entry. The dependency array was also updated to `[values.basicPoList]`.

**2. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLform.jsx`**
- **12/3/2025, 12:26 PM**: This file saw a comprehensive initial commit or major overhaul, introducing the main `HBLForm` component. It integrates `Formik` for form management, React Router for navigation, Redux for state management, and custom components for various form sections (HBL Header, Parties). It supports saving and updating HBL bookings via API mutations (`useSaveHblBookingMutation`, `useUpdateHblBookingMutation`).
- **12/3/2025, 1:38 PM - 1:55 PM**: Extensive changes and refinements were made to the `initialValues` prop for `Formik`, particularly for `agent_booking_id` and `booking_no`. These adjustments aimed to correctly handle booking IDs during "add", "edit", and "copy" actions, often prioritizing `initialValues` or `location.state`.
- **12/3/2025, 1:46 PM - 1:47 PM**: There was a brief change and subsequent reversion of the `Formik` `enableReinitialize` prop logic, suggesting experimentation with form reinitialization behavior.
- **12/3/2025, 1:46 PM - 1:47 PM**: Imports for `HblPODetails` were temporarily removed and re-added.
- **12/3/2025, 2:37 PM - 2:49 PM**: Introduction and iterative refinement of Redux Toolkit Query's `useFetchPoFormDetailsQuery` to fetch `poDetails` based on `agent_booking_id` from `location.state`. The `basicPoList` initialization within `Formik`'s `initialValues` was adjusted multiple times to correctly merge or prioritize `poDetails` data with existing `initialValues`. At one point, `basicPoList` initialization was commented out, then re-added and refined.
- **12/3/2025, 4:56 PM**: `linkedPoList: poDetails?.data?.linkedPoList || []` was added to `initialValues`, indicating that linked PO data is now fetched and integrated into the form.

**3. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\store\api\agentBookingApi.js`**
- **12/3/2025, 2:38 PM**: A new Redux Toolkit Query endpoint `fetchPoFormDetails` was added. This endpoint is responsible for fetching PO details related to HBL entries from the `/hblEntry/get-po-details` API. The `useFetchPoFormDetailsQuery` hook was also exported. This directly supports the data fetching seen in `HBLform.jsx`.

**4. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblHeaderForms.jsx`**
- **12/3/2025, 1:42 PM**: Added an "Add Vessel" feature, including state management for a modal, a button to open it, and a keyboard shortcut (`ctrl+x`). Minor corrections/typos related to the `onChange` prop for `booking_no` input box were introduced and fixed.

**5. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLListDetails.jsx`**
- **12/3/2025, 1:43 PM - 1:54 PM**: The navigation logic for the "Add HBL" button was corrected. Initially, it mistakenly passed `formAction: "copy"` when navigating to the HBL form, which was then rectified to `formAction: "add"` to reflect the intended functionality.

**6. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\form\sub-components\BasicPoExtend.jsx`**
- **12/3/2025, 12:33 PM - 3:24 PM**: This component manages a list of basic PO items using Redux (`addList`, `removeList`, `updateList`). It includes UI for adding, editing, and deleting rows, and fetches supplier options via `ApiManager`. This component remained largely stable throughout the logs, acting as a reference or a base for a new, HBL-specific version.

**7. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\BasicPoForHbl.jsx`**
- **12/3/2025, 3:25 PM**: This new component was introduced, initially as a duplicate of `BasicPoExtend.jsx`.
- **12/3/2025, 3:27 PM - 3:37 PM**: Underwent rapid and significant changes:
    - All Redux list manipulation logic (`addRow`, `deleteRow`, `updateRow`) and their associated UI controls (Add/Delete buttons) were commented out or removed.
    - Imports for Redux actions (`addList`, `removeList`, `updateList`) and local utility functions (`recoverValue`) were removed.
    - The component shifted from managing its own list via Redux to *displaying* a `basicPoList` received directly through `formik` props (specifically `formik?.basicPoList?.map`). This indicates a change in how PO list data is sourced and modified, moving responsibility up to the parent `HBLForm` component which now manages `basicPoList` in its `Formik` state, potentially populated by the new `useFetchPoFormDetailsQuery`.
    - Minor layout adjustments for grid items were made.

**8. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\form_extend\CargoFormExtend.jsx`**
- **12/3/2025, 4:58 PM - 12/5/2025, 2:27 PM**: This component consistently manages a `cargoList` using Redux actions for adding, updating, and removing items. It displays cargo data in a table with edit/delete actions and uses a modal for detailed add/edit forms. Throughout the provided logs, the content of this file remained identical, indicating no functional changes after its initial appearance, but rather multiple save operations without alteration.

### Patterns and Recurring Elements:

*   **Redux Toolkit Query (RTKQ) Adoption**: There's a clear pattern of integrating RTKQ for data fetching and mutation, with several `builder.query` and `builder.mutation` definitions. Invalidating tags like "hbl", "booking", "bookingDetails" ensures data freshness.
*   **Formik for Form Management**: `Formik` is consistently used across the main forms (`HBLForm`) to manage form state, validation (`validationSchema`), and submission (`onSubmit`).
*   **Component Modularity**: The presence of `sub-components` and the creation of `BasicPoForHbl` indicate an effort towards modular and reusable UI components.
*   **Debugging Statements**: Frequent `console.log` statements with varying identifiers (e.g., "values===90", "locatioppppp", "hkkllll90000", "poDetails===890") appear throughout the logs, suggesting an active development phase with a focus on inspecting data flow and component props.
*   **Conditional Rendering/Logic**: Components frequently use conditional logic (e.g., `formAction === "copy"`, `values.client_name === 'SP RICHARDS COMPANY'`, `poDetails?.data?.basicPoList?.length`) to adapt UI and data initialization based on context.
*   **Keyboard Shortcuts**: The implementation of keyboard shortcuts (`ctrl+u`, `ctrl+d`, `ctrl+a`, `ctrl+s`, `ctrl+x`, `ctrl+p`) in `HBLForm` and `HblHeaderForms` shows a focus on improving user efficiency and accessibility for core functionalities.
*   **Data Source Migration**: The most significant pattern is the apparent shift in data management for lists like `basicPoList`. Initially managed directly by Redux state and modified by sub-components, it transitioned to being passed as a prop (`formik.basicPoList`) from the parent `Formik` component, which in turn populates it from an RTKQ fetch. This suggests centralizing data fetching and `Formik`'s `initialValues` for complex nested forms.

## 11:41:34 AM
The provided log details changes across three core files within the `t360-backend` project: `booking.controller.ts`, `hblEntry.controller.ts`, and analytics-related query files.

### File-Specific Updates:

1.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\booking.controller.ts`**
    *   **Timestamps**: Consistent changes from 12/3/2025, 12:06:34 PM to 12/3/2025, 12:15:30 PM.
    *   **Content**: This file primarily handles the `saveBooking` and `saveMaster` functionalities.
        *   The `saveBooking` function manages the creation and updating of agent bookings. It fetches existing booking data, constructs a payload, determines `EntryMode` (ADD/UPDATE), generates a new booking ID if adding, and performs multiple database operations (delete existing, then insert new data for `agent_booking_entry`, `agent_booking_cargolist`, `agent_booking_container_pre`, `agent_booking_vessel`, `agent_booking_po`, `agent_booking_linked_po`). It also updates `dso_order` for linked POs. Error handling with rollback is in place.
        *   The `saveMaster` function (partially visible) validates `account_type` against a predefined list of `BookingAtypeEnum` values.
        *   No significant code differences are apparent across the numerous commits within this file, suggesting minor, incremental, or re-saving changes. Comments indicate logging and transaction management (`// await query('BEGIN'); // await query('COMMIT'); // await query('ROLLBACK');`) which are commented out in the provided snippets.

2.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\hblEntry.controller.ts`**
    *   **Timestamps**: Changes from 12/3/2025, 2:04:59 PM to 12/5/2025, 1:56:46 PM.
    *   **Content**: This file deals with House Bill of Lading (HBL) master booking creation and updates.
        *   The `createHblMasterBooking` function initializes a payload, starts a database transaction, fetches `booking_serial_id` from `agent_booking_entry`, inserts data into `hbl_master`, `agent_booking_vessel`, and `agent_booking_hbl` tables. It also handles batch inserts for `routingList`, `containerList`, and `basicPoList`. Audit logs are created.
        *   The `updateHblMasterBooking` function updates various fields in the `hbl_master`, `agent_booking_vessel`, and `agent_booking_hbl` tables based on a `hbl_master_id`. It also includes audit logging for `hbl_master` changes.
        *   Similar to `booking.controller.ts`, multiple log entries for this file show nearly identical code, indicating minor non-functional changes or repeated saves.
        *   Introduces the `insertAudit` and `simpleAudit` functions from `../modules/AuditModule`, suggesting a robust auditing mechanism for HBL changes.

3.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\routes\hblEntry.route.ts`**
    *   **Timestamp**: 12/3/2025, 2:36:19 PM.
    *   **Content**: Defines API routes for HBL operations.
        *   `GET /`: `fetchHblFormDetails`
        *   `GET /get-hbl`: `getHbl`
        *   `POST /create`: `createHblMasterBooking`
        *   `POST /update`: `updateHblMasterBooking`
        *   `DELETE /delete`: `deleteHblForm` (protected by `authMiddleware`)
        *   `GET /get-po-details`: `fetchPoDetails`

4.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\analytics\query\booking.query.ts`**
    *   **Timestamps**: Frequent changes from 12/4/2025, 11:59:53 AM to 12/4/2025, 3:35:27 PM.
    *   **Content**: This file contains functions to build SQL queries for various booking-related analytics reports.
        *   The `bookingQueryBuilder` function constructs complex SQL queries based on `type` (e.g., 'BookingDatetoActualDeparture', 'BookingDatetoActualDepartureMblWise', 'BookingDatetoActualDepartureStackedBar').
        *   It uses common utilities like `getColumnsByCategory` and `getFilterQueryByDisplayValue` to customize queries.
        *   Queries involve joining `mtr_tracking_data` and `agent_booking_entry` tables.
        *   A recurring pattern in the SQL queries is the calculation of `day_diff` by `EXTRACT(DAY FROM ... - ...)` to determine time differences between various dates (e.g., vessel departed date vs. booking date).
        *   Stacked bar chart queries (`BookingDatetoActualDepartureStackedBar`, `BookingDatetoActualDepartureMblWiseStackedBar`) categorize `day_diff` into specific time ranges (e.g., 'Less than 1 week', '1 - 2 weeks').
        *   Conditions `t49_vessel_actualdeparted_date != '0001-01-01 00:00:00 BC'` are consistently used to filter out invalid date entries.
        *   The company name (`LOWER(account_name) = '${CompanyName}'`) and date range (`departure_date >= '${fromDate}'::timestamp AND departure_date < '${toDate}'::timestamp + INTERVAL '1 day'`) are used for filtering.
        *   There are many duplicate entries for this file, indicating repetitive saves without significant changes to the logic or structure of the queries themselves.

5.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\analytics\others.controller.ts`**
    *   **Timestamp**: 12/4/2025, 12:02:39 PM.
    *   **Content**: This controller acts as a dispatcher for various analytics reports.
        *   The `getTableDataReports` function takes `fromDate`, `toDate`, `mblwise`, `viewBy`, `type`, and `displayBy` as query parameters.
        *   It uses `getUserObject` to determine `CompanyName` and `user_id`.
        *   It routes the request to appropriate query builders (`chassisQueryBuilder`, `bookingQueryBuilder`, `containerQueryBuilder`, `departureQueryBuilder`, `generalQueryBuilder`) based on the `type` parameter.
        *   Logging of the generated SQL query is present for debugging.

6.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\analytics\query\export.query.ts`**
    *   **Timestamps**: Frequent changes from 12/4/2025, 3:39:54 PM to 12/5/2025, 1:57:27 PM.
    *   **Content**: This file defines SQL query snippets for exporting analytics data based on various report names.
        *   A `getMonthValue` helper function is included to convert month names (e.g., "Jan") or numerical month strings to numerical month values.
        *   The `bookingQuery` function returns a dictionary of SQL query parts, each corresponding to a specific `reportName` (e.g., "Booking Date to Actual Departure", "Carrier On-time delivery By carrier", "Containers Shipped (Mbl Wise)").
        *   Many queries include `EXTRACT(DAY FROM ... - ...)` for calculating day differences.
        *   Filtering based on `CompanyName` is consistent (`LOWER(account_name) = '${CompanyName}'`).
        *   Stacked bar chart queries (`Booking Date to Actual Departure (Stacked Bar)`, `Booking Date to Actual Departure ( MBL Wise Stacked Bar)`) contain conditional logic for filtering by month, week, or quarter and also by the `stackedGroup` (e.g., 'Less than 1 week').
        *   The `Carrier On-time delivery By carrier` query was modified to improve the `WHERE` clause conditions for ETA and actual arrival dates by including `TRIM(...) <> ''` checks and also changed `GROUP BY m.scac_code` to `GROUP BY LOWER(m.scac_code)`. Later, the `TRIM` was removed from the `COALESCE` clause.

7.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\analytics\core.export.controller.ts` (continued)**
    *   **Timestamps**: Changes from 12/5/2025, 10:52:08 AM to 12/5/2025, 1:56:56 PM.
    *   **Content**: This file handles the logic for exporting analytics data.
        *   The `getExportData` function retrieves query parameters, sets default date ranges, and fetches company details.
        *   It determines whether the report is `isBooking` related and then constructs `mainQuery` using `bookingQuery` or `nonBookingQuery` functions from `export.query.ts`.
        *   A `mblWiseQuery` part is dynamically added to the `mainQuery` to handle distinct MBL or container-specific data.
        *   A new conditional block was added to the `isBooking` section to fall back to `nonBookingQuery` if `bookingQuery` returns an empty string. This ensures that even if a `booking` report name is passed, but `bookingQuery` doesn't have a specific entry, it tries to generate a non-booking specific query.
        *   Includes specific logic for filtering TEU MBLwise reports (`reportName.toLowerCase().includes("teu") && reportName.toLowerCase().includes("mbl")`) to replace `teu` values with `'-'` for duplicate container entries.
        *   The `replaceColumnHandler` function is present, which standardizes 'LONG BEACH' to 'LOS ANGELES' for 'pod' and 'place_of_delivery' fields in the exported data.

### Patterns and Recurring Elements:

*   **Date Formatting and Filtering**: The `db_format = "YYYY-MM-DD"` is consistently used for database date operations. Many queries use `AppDateFormate` for incoming date strings and `EXTRACT(DAY FROM ... - ...)` for calculating time differences. Date range filtering using `FROM_DATE` and `TO_DATE` is standard across analytics queries.
*   **Data Sanitization**: `sanitizeString` and `sanitizeIntString` are frequently used when processing incoming request body parameters to prevent injection vulnerabilities.
*   **Database Interactions**: `insertMany`, `insertQuery`, `query`, and `updateQuery` functions from `../config/database` are heavily utilized across controllers for persistent data management. Transactions (`BEGIN`, `COMMIT`, `ROLLBACK`) are used for atomicity, though commented out in the initial `saveBooking` snippet.
*   **Audit Logging**: The `hblEntry.controller.ts` specifically uses `insertAudit` and `simpleAudit` from `AuditModule`, indicating a structured approach to track changes in critical data.
*   **Role-Based Location**: `locationByRole` is a common variable, determined by `req.user.role` (AGENT vs. ADMIN), to apply location-specific logic.
*   **Analytics Query Structure**: Analytics queries often involve `mtr_tracking_data` and `agent_booking_entry` tables, joining them on `mblno`. They include checks for `IS NOT NULL` and `!= '0001-01-01 00:00:00 BC'` for date fields to ensure valid data.
*   **Redundant Commits**: Multiple log entries for the same file with identical or near-identical code snippets suggest frequent saving or automated commit behavior rather than distinct functional changes in many cases. This is particularly noticeable in `booking.controller.ts` and the `booking.query.ts` and `export.query.ts` files.
*   **Port Name Normalization**: The `replaceColumnHandler` function in `core.export.controller.ts` indicates a recurring data quality or display requirement to standardize "LONG BEACH" to "LOS ANGELES" for port-related fields.

## 12:40:28 PM
The log details changes across two primary files: `config.js` and `nofifyAdmin.js`, occurring between 2:06 PM and 2:24 PM on December 5, 2025.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\cng-batches\cng-batches\config\config.js`**:
    *   **Timestamp: 12/5/2025, 2:06:15 PM**
        *   Initial comprehensive setup of development and production environments.
        *   Development `db` credentials (`user`, `host`, `database`, `password`, `port`) are defined for `Rida_Database`.
        *   Production `db` credentials point to an AWS RDS instance (`database.cluster-c5oa8ykwujxp.us-east-2.rds.amazonaws.com`).
        *   Numerous file `paths` are configured for both environments, pointing to directories for various XML, Excel, and CSV files (e.g., `isfXmlCng`, `clbXml`, `cngInvExcel`). Development paths use local `D:/Files` and `D:/Office` directories, while production uses Linux-style `/home/node/batches/` paths.
        *   `googleTokenPath` is set for development.
        *   `anchorJsonFilePath` and `anchorJsonArcFilePath` are added for development.
        *   `cngIntegration` details (username, password, URL) are set identically for both environments.
        *   Extensive `email` configurations are present, defining sender, service, various recipient lists (`all`, `office`, `execptionMailList`, `isfTeam`, `isf24HrReport`, `isfNotMatchReport`, `doBatchReport`, `openFileEmail`, `air_data_pulling_failure`, `userRegistrationApproval`). Recipient lists differ significantly between development and production, with development often using specific individual email addresses and production using a wider corporate distribution.
        *   `sftpConfig`, `sftpConfig7501`, and `anchorSftpConfigJSON` are defined for external SFTP connections.
        *   `t360Url` and other application-specific settings like `alc_7501_xml_validation`, `alcTolerance`, and `mtr_air_config` are present.
    *   **Timestamp: 12/5/2025, 2:13:27 PM**
        *   The `to` recipient for `development.email.userRegistrationApproval` is changed, moving `ridaparveen679@gmail.com` from `to` to `cc`.
    *   **Timestamp: 12/5/2025, 2:14:56 PM**
        *   A new `customer` property (`rajeev.kumar@transmodal.net`) is added to `development.email.userRegistrationApproval`.
    *   **Timestamp: 12/5/2025, 2:18:39 PM**
        *   The `cc` recipient list for `development.email.userRegistrationApproval` is updated to `rida@dyneinfotech.com, ridaparveen679@gmail.com`.
    *   **Timestamp: 12/5/2025, 2:21:30 PM**
        *   Changes to development `db` configuration: `database` is updated from "Rida\_Database" to "tmodal", and `password` is changed from "12345678" to "12345".
        *   `development.paths.googleTokenPath` is changed from `C:/Users/ridap/OneDrive/Documents/cng-batches/cng-batches/config` to `D:/Projects/cng-batches/config`.
        *   The `development.email.all` list is significantly truncated to only `ramshankar.maurya@transmodal.net`.
    *   **Timestamp: 12/5/2025, 2:24:48 PM**
        *   New paths `cngInvXmlPath` and `sprInvXmlPath` are added under `development.paths` with specific local paths, and corresponding empty paths are added for `production.paths`.
        *   A structural error is introduced in the `development.email` object where a `to` property is added directly under `email` (as a sibling to other email configurations), rather than within a specific sub-configuration.

*   **`c:\Users\ridap\OneDrive\Documents\cng-batches\cng-batches\modules\login-req-notify\nofifyAdmin.js`**:
    *   **Timestamp: 12/5/2025, 2:09:33 PM**
        *   Introduces the `NotifyAdmin` class responsible for handling new user registrations.
        *   It fetches new users with `status = 'NEW'`, sends an initial notification email to `config.email.all`, updates an `emailcounter` in the `mtr_user_registration` table, and sends a second "Additional Information Required" email to users whose `emailcounter` is less than or equal to 2.
        *   The HTML content for the second email is initially hardcoded directly within the `notifyAdmin` method's `sendEmail` call.
        *   A `generateUserRegisterApprovalEmailContent()` method exists but is not used.
    *   **Timestamp: 12/5/2025, 2:10:02 PM**
        *   The hardcoded HTML for the "Additional Information Required" email is refactored to call `this.generateUserRegisterApprovalEmailContent()`, improving modularity.
        *   The `generateUserRegisterApprovalEmailContent` method is updated to dynamically use `config.email.userRegistrationApproval.support_team` for the support contact.
    *   **Timestamp: 12/5/2025, 2:15:39 PM**
        *   The greeting in `generateUserRegisterApprovalEmailContent()` is made dynamic, changing `Dear [Customer Name],` to `Dear ${config.email.userRegistrationApproval.customer}`.
    *   **Timestamp: 12/5/2025, 2:16:45 PM**
        *   The dynamic greeting in `generateUserRegisterApprovalEmailContent()` is reverted to a hardcoded `Dear Rajeev,`.
    *   **Timestamp: 12/5/2025, 2:20:06 PM**
        *   Numerous `console.log` statements within `notifyAdmin` are replaced with `logger.info` calls for improved logging practices.

**Patterns and Recurring Elements:**

*   **Environment-Specific Configuration:** The `config.js` file consistently distinguishes between `development` and `production` settings for database, file paths, and email recipients, indicating a robust deployment strategy.
*   **Email-Centric Notifications:** A significant portion of the changes revolves around email configurations and the logic for sending various notifications, particularly for user registration and system alerts. Multiple email recipient lists are maintained for different purposes.
*   **File Path Management:** The `paths` object in `config.js` is continuously updated with new file locations, suggesting an evolving system that handles diverse input/output data (XML, Excel, CSV). The use of local `D:` drive paths in development and POSIX-style paths in production is consistent.
*   **User Registration Workflow Refinement:** The `nofifyAdmin.js` module shows ongoing development to its user registration and notification process, including refactoring email content and enhancing logging. The use of an `emailcounter` indicates a mechanism to control repeated notifications.
*   **Iterative Refinement:** There are several minor commits/saves to `config.js` without changes and small, quick iterations on the `nofifyAdmin.js` file, especially around email content and logging, which is typical during development and testing phases.
*   **Hardcoded vs. Dynamic Values:** A pattern of sometimes switching between dynamic configuration values (e.g., `Dear ${config.email.userRegistrationApproval.customer}`) and hardcoded values (e.g., `Dear Rajeev,`) for email content is observed, possibly reflecting testing or temporary changes.
*   **Logging Enhancement:** The move from `console.log` to `logger.info` demonstrates an effort to standardize and improve application logging.

## 12:41:17 PM
The following details summarize the recent code changes, highlighting file-specific updates, significant timestamps, and observed patterns:

**Overall Patterns and Recurring Elements:**

*   **Redux Toolkit Integration:** There's a strong reliance on Redux (specifically `useDispatch` and `useSelector`) to manage form-related lists such as `basicPoList`, `routingList`, `containerList`, and `cargoList` across multiple components.
*   **Formik for Form Management:** `Formik` is a central tool for handling form state, validation, and submission, especially in `HBLForm.jsx`.
*   **Material-UI Components:** Extensive use of Material-UI components (`Grid`, `Box`, `Card`, `TabContext`, `TabList`, `TabPanel`, `IconButton`, `Accordion`, etc.) alongside custom common components (`InputBoxExtend`, `AppDatePickerExtend`, `AppAutocompleteExtend`, `ThemedModal`).
*   **RTK Query for Data Fetching:** RTK Query is consistently used for API interactions (e.g., `useSaveHblBookingMutation`, `useUpdateHblBookingMutation`, `useFetchPoFormDetailsQuery`).
*   **Frequent Debugging/Refinement:** Many changes involve adding or modifying `console.log` statements, particularly within `HBLForm.jsx`, indicating ongoing debugging and development.
*   **Complex `initialValues` Logic:** In `HBLForm.jsx`, the `initialValues` object for `Formik` frequently undergoes complex conditional logic adjustments, especially concerning how `agent_booking_id`, `booking_no`, and nested lists (`basicPoList`, `linkedPoList`) are populated based on the form's action (`add`, `edit`, `copy`) and data availability from `initialValues`, `location.state`, or fetched `poDetails`. This suggests an evolving design for form reinitialization and data sourcing.
*   **"SP RICHARDS COMPANY" Specific Logic:** The `HblPoForm.jsx` component includes a specific condition to automatically switch to the "Linked PO" tab if the `client_name` (or later, a customer name from `basicPoList`) is 'SP RICHARDS COMPANY'.

**File-Specific Updates:**

**1. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblPoForm.jsx`**
    *   **12/3/2025, 12:25:57 PM**: Introduced `PODetailsExtend` to manage "Basic PO" and "Linked PO" tabs, with automatic tab switching based on `client_name`.
    *   **12/3/2025, 12:26:15 PM**: Renamed the component to `HblPODetails`.
    *   **12/3/2025, 12:27:09 PM**: Changed the component's primary prop from `formik` to `values`.
    *   **12/3/2025, 1:01:38 PM - 3:23:41 PM**: Added/modified `console.log` statements for debugging `values`.
    *   **12/3/2025, 3:25:22 PM**: Replaced the `BasicPoExtend` sub-component with a newly introduced `BasicPoForHbl` for the "Basic PO" tab.
    *   **12/3/2025, 3:49:19 PM**: Modified the `useEffect` logic to determine the default tab. It now checks the `customer` property within the `values.basicPoList` (if available) instead of `values.client_name` to switch to the "Linked PO" tab for 'SP RICHARDS COMPANY'.

**2. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLform.jsx`**
    *   **12/3/2025, 12:26:33 PM**: Initial implementation of the `HBLForm`, a complex component for creating/editing House Bill of Lading (HBL) forms. It integrates `Formik`, Redux state for list management (routing, containers, POs), and RTK Query for API calls. Keyboard shortcuts for party management and saving were also introduced.
    *   **12/3/2025, 1:39:29 PM - 1:55:49 PM**: This file saw multiple rapid changes and reverts to the `initialValues` logic for `agent_booking_id` and `booking_no`, especially regarding how these fields are set for "copy" and "add" form actions. This indicates an unstable or actively refined area of data initialization.
    *   **12/3/2025, 1:46:11 PM**: Briefly changed and then reverted `Formik`'s `enableReinitialize` prop.
    *   **12/3/2025, 2:40:01 PM**: Introduced `useFetchPoFormDetailsQuery` from RTK Query to fetch PO details and began using the fetched data (`poDetails?.data?.basicPoList`) to populate the `basicPoList` initial values, falling back to `initialValues` if no fetched data is present.
    *   **12/3/2025, 2:42:38 PM - 2:53:46 PM**: Continued to refine and adjust the `basicPoList` initial value logic, combining data from `poDetails` and `initialValues`, often with slightly different conditional checks.
    *   **12/3/2025, 2:49:21 PM**: Changed how `poDetails` was destructured from the query result (from `data: poDetails` to `poDetails`), impacting how it's referenced, but this was later implicitly reverted.
    *   **12/3/2025, 4:56:44 PM**: Added `linkedPoList` to `initialValues` and further refined the `basicPoList` initialization, reverting back to accessing `poDetails.data.basicPoList`, confirming the implicit reversion of the 2:49:21 PM change in `poDetails` destructuring.

**3. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblHeaderForms.jsx`**
    *   **12/3/2025, 1:42:46 PM**: Initial setup of the HBL header form, including various input fields, autocompletes for ports/vessel, and an "Add Vessel" modal accessible via a button or `ctrl+x` shortcut. Client options are fetched on component mount.
    *   **12/3/2025, 1:51:28 PM**: A typo (`onchange` instead of `onChange`) was introduced for the "Agent Booking #" input handler.

**4. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLListDetails.jsx`**
    *   **12/3/2025, 1:43:57 PM**: Initial component to display a list of HBLs, offering features like HBL deletion, auditing, and navigation to the HBL form. The "Add HBL" button initially set `formAction: "copy"`.
    *   **12/3/2025, 1:54:42 PM**: Changed the "Add HBL" button's `formAction` from `"copy"` to `"add"`, indicating a change in how new HBL forms are initialized.

**5. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\store\api\agentBookingApi.js`**
    *   **12/3/2025, 2:38:52 PM**: Significantly expanded the RTK Query API definition. A new tag type `"hbl"` was added, along with several new endpoints specifically for HBL entry (`saveHblBooking`, `fetchHblBookingFormDetails`, `fetchPoFormDetails`, `getHblDashboard`, `updateHblBooking`, `deleteHblBooking`). The `updateDo` and `getBookingConfirm` endpoints also received more precise tag invalidation logic.

**6. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\form\sub-components\BasicPoExtend.jsx`**
    *   **12/3/2025, 12:33:44 PM**: Initial component to manage basic PO details, providing full CRUD functionality (add, delete, update rows) via Redux state.
    *   **12/3/2025, 3:24:24 PM**: The `values` prop was changed to `formik`, implying it now expects the entire `formik` object, though its core logic still used Redux state directly.

**7. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\BasicPoForHbl.jsx`**
    *   **12/3/2025, 3:25:02 PM**: Created as a duplicate of `BasicPoExtend` but located in the HBL-specific directory.
    *   **12/3/2025, 3:27:29 PM - 3:37:58 PM**: Evolved significantly from its `BasicPoExtend` counterpart. All interactive elements and associated Redux dispatch functions (for adding, deleting, updating rows) were commented out or removed. The component's data source shifted from being managed by Redux state (`selector`) to directly consuming `formik?.basicPoList` from its props, making it a display-only component for PO details. Imports for `ApiManager`, `CustomDeleteIcon`, `AddCircleOutlined` were removed, reflecting this change.

**8. `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\form_extend\CargoFormExtend.jsx`**
    *   **12/3/2025, 4:58:45 PM**: Initial component for managing cargo details. It displays cargo items in a table, allows adding/editing via a modal, and handles deletion, all by dispatching actions to update the Redux `cargoList` state.
    *   **12/3/2025, 4:59:42 PM - 12/5/2025, 2:27:08 PM**: The code within this file remained unchanged across all provided log entries for this period, suggesting stability or no active modifications during this development cycle.