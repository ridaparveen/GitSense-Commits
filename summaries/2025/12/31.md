# Activity Summary for 12/31/2025

## 9:40:28 AM
`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\analytics\transit.controller.ts` (Timestamp: 12/30/2025, 9:54:51 AM)
This file defines the `getTransitReports` function, responsible for generating transit-related analytics reports. It extracts various parameters from the request query, such as grouping columns, date ranges, mbl-wise filtering, view options, and report names. If date ranges are not provided, it defaults to a predefined range. The controller dynamically builds a SQL query using `transitQueryBuilder` based on user-specific details (company name, user ID) and the `mblwiseCondition`, which adjusts the `SELECT`, `CONDITION`, and `GROUP BY` clauses for either `mblno` or `voyage`. The generated query is then executed against the database, and the results are returned with an HTTP 200 status. Error handling is implemented to catch and log issues, responding with a 500 status in case of server errors.

`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\code.controller.ts` (Timestamp: 12/30/2025, 10:23:43 AM)
This file handles customer-related operations, including retrieving and creating customer records.
The `getAllCustomer` function fetches customer details with pagination and dynamic search/sorting capabilities. It queries `PO_AccountMaster_Customer_Master`, dynamically identifies table columns for search, and then constructs SQL queries to retrieve customer data and count total records. For each customer, it also fetches related shipper mapping (`account_master_shipper_MAP`), document upload details (`document_upload_details`), and customer mapping (`Account_Master_Customer_MAP`), combining them into a comprehensive JSON response.
The `createCustomer` function manages the creation or modification of customer records. It supports file uploads and extracts numerous customer details from the request body. It begins a database transaction and first checks if a customer with the given `acode` already exists. If so, it updates the record by deleting and re-inserting into `PO_AccountMaster_Customer_Master` and associated tables (`agent_po_account_master_type`, `Account_Master_Shipper_MAP`, `account_master_pic`). Otherwise, it generates a new account code using `getAccountCode` and inserts a new record. It also handles specific customer types and processes a `mapping` array to insert data into `Account_Master_Shipper_MAP`, resolving `polcode`, `shippercode`, and `agentcode` from other master tables. The provided snippet ends during the processing of shipper mapping.

`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\booking.controller.ts` (Timestamps: 12/30/2025, 6:06:10 PM; 12/30/2025, 6:08:27 PM; 12/30/2025, 6:10:47 PM)
All three timestamps for this file contain identical code snippets, indicating no functional changes were introduced between these saves. The file focuses on auditing booking-related data changes.
It defines `auditDoUpdates`, a helper function designed to track specific updates to Delivery Order (DO) numbers, DO dates, booking dates, and booking numbers within `agent_booking_entry`. This function compares old and new values and only logs changes using `insertAudit` if actual differences are detected. Upon detecting changes, it sets the `booking_status` to `CONFIRMED`.
The `auditBookingChanges` function provides a more comprehensive auditing mechanism for an entire booking ID across several related tables. It logs changes for:
*   `agent_booking_entry` (main booking details).
*   `agent_booking_linked_po` (linked purchase orders), distinguishing between added, removed, and modified POs, and logging summary details for additions/removals using `simpleAudit` and field-level changes for modifications using `insertAudit`.
*   `agent_booking_vessel` (vessel details), similarly tracking additions and removals with summary details for vessel, voyage, line, and dates.
The provided snippet for `auditBookingChanges` ends during the auditing of `agent_booking_vessel`, implying further logic to handle modifications or other booking-related lists. Both auditing functions extensively use `logger.info` to record audit activities.

**Patterns and Recurring Elements:**
*   **Future Timestamps:** All timestamps are dated 12/30/2025, suggesting a future development timeline or placeholder dates.
*   **Database Interaction:** A consistent pattern of direct database interaction is observed, with frequent imports and usage of `query`, `insertQuery`, and `updateQuery` functions. Raw SQL queries are embedded within the controller logic.
*   **Audit Logging:** There's a strong emphasis on detailed audit logging across the booking controller, employing `simpleAudit` for summary changes (additions/removals) and `insertAudit` for granular, field-level tracking of modifications. `logger.info` is widely used to trace audit progress.
*   **Utility Functions:** Several common utility functions (e.g., `AppDateFormate`, `getAccountCode`, `getAccountSubCode`, `chkStr`, `sanitizeString`) are imported and utilized across different controllers for tasks like date formatting, ID generation, and data sanitization.
*   **Error Handling:** All controllers demonstrate robust error handling using `try...catch` blocks, logging errors with `logger.error`, and returning a 500 status with an error message in case of exceptions.
*   **Request/Response Handling:** The use of `AuthenticatedRequest` and `Response` from `express` is standard across all controllers for handling web requests.
*   **Modular Structure:** The codebase appears well-structured, separating concerns into controllers, requests, configuration, and utility modules.

## 3:16:34 PM
The development log details changes across several frontend files, primarily focusing on booking confirmation, file upload functionality, and menu configuration.

**File-Specific Summaries:**

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\pages\booking\AgentBookingConfirmation.jsx`**
    *   **Timestamps:** This file saw continuous updates on 12/30/2025 from 12:44:39 PM to 7:00:45 PM, and minor re-saves on 12/31/2025 morning.
    *   **Key Changes:**
        *   The `UploadFile` component was imported.
        *   Several Material-UI icon imports were either added (`FileDownload`) or removed (e.g., `Divider`, `IconButton`, `CloudDownload`, `Download`, `Folder`, `HourglassBottom`, `HourglassBottomTwoTone`).
        *   New icon imports `FiDownload` (from `react-icons/fi`) and `FaHourglass` (from `react-icons/fa`) were added.
        *   A `CardField` component import was removed.
        *   Multiple `console.log` statements (e.g., `console.log("kkkkggggg", confirmData);`, `console.log("pldata====",plData);`) were added or adjusted, suggesting active debugging and data inspection during development.
        *   No significant functional logic changes were introduced within the core `AgentBookingConfirmation` component itself, but its imports were modified to reflect changes in other components.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\common\UploadFile.jsx`**
    *   **Timestamps:** Significant changes occurred on 12/30/2025 from 12:50:28 PM to 6:44:51 PM.
    *   **Key Changes:**
        *   Underwent a major refactor from a basic drag-and-drop zone using `Paper` and `CloudUploadIcon` to a more structured UI.
        *   The new UI incorporates `Grid`, `Stack`, `IconButton`, and `ThemeButton` for a dedicated drag-and-drop area and a separate button to "Choose File".
        *   The `useDropzone` hook was configured with `noClick: true`, redirecting file selection to a button click.
        *   The display of the selected file was enhanced to include an `InsertDriveFile` icon and a `CustomDeleteIcon` for removal.
        *   Styling (`borderColor`, `backgroundColor`, font colors) for the drag-and-drop area and file display elements was frequently adjusted and refined.
        *   Temporary TypeScript type annotations (`interface UploadFileProps`, `React.FC<UploadFileProps>`) were briefly added and then reverted, indicating an experimental phase.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\common\Cards\CardField.jsx`**
    *   **Timestamps:** Minor changes on 12/30/2025 from 6:04:29 PM to 6:04:49 PM.
    *   **Key Changes:** Insignificant formatting changes within the `titleStyle` object, no functional impact.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\form\BookingFormExtend.jsx`**
    *   **Timestamps:** This file was saved multiple times on 12/30/2025 at 7:02:17 PM and on 12/31/2025 between 9:46:51 AM and 9:49:49 AM.
    *   **Key Changes:** No substantial functional or structural changes were introduced, primarily re-saves.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\core\admin-drawer-elements.jsx`**
    *   **Timestamps:** Minor changes on 12/31/2025 from 10:18:20 AM to 10:18:37 AM.
    *   **Key Changes:** A temporary debug string `kkk` was removed from the `ExpandableListItems` component.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\config\menu.js`**
    *   **Timestamps:** Changes on 12/31/2025 from 10:19:11 AM to 11:32:04 AM.
    *   **Key Changes:**
        *   The `AnalyticsOutlined` icon import and its corresponding `analyticsIcon` mapping were temporarily commented out and then restored.
        *   The label for the "Analytics" menu item was briefly changed to "Analytics123" and then reverted, suggesting minor iterations or tests on the navigation structure.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\code\customer\CustomerMapping.jsx`**
    *   **Timestamps:** Frequent updates on 12/31/2025 from 1:03:59 PM to 1:14:18 PM.
    *   **Key Changes:**
        *   Introduced `loading` state to manage the loading indicator for the `AppAutocomplete` component.
        *   Refactored the customer data fetching logic, moving it into a `useCallback` hook and utilizing a `search` state triggered by a `useEffect` for debounced API calls.
        *   Corrected the mapping of API response data to `label` and `value` for the `AppAutocomplete` component.
        *   The `updateRow` function was revised to correctly modify specific entries in the `customer_mapping` array.
        *   An explicit `onInputChange` prop was added to `AppAutocomplete` to handle search input.
        *   A `console.log` was added for debugging the API response.
        *   The `role: "CUSTOMER"` parameter was removed from the `getCustomerOptions` API call.

**Patterns and Recurring Elements:**

*   **Iterative UI Refinement:** The `UploadFile.jsx` component shows a clear pattern of iterative development, with continuous updates to its structure, styling, and integration of new icons. This indicates a focus on improving the user experience and visual design of file uploads.
*   **API Integration and State Management:** The changes in `CustomerMapping.jsx` demonstrate a pattern of refining data fetching, state management (`loading`, `search`), and how API responses are processed and integrated into form components. The use of `useCallback` and `useEffect` suggests adherence to React best practices for performance and data consistency.
*   **Debugging and Code Cleanup:** The presence and subsequent removal or adjustment of `console.log` statements and temporary strings (like `kkk`) across multiple files highlight an active debugging process and a commitment to keeping the codebase clean.
*   **Modular Component Design:** The frequent changes to common components like `UploadFile` and `CardField`, and their subsequent import/removal in pages like `AgentBookingConfirmation.jsx`, indicate a modular component-based architecture.
*   **Timestamp Clustering:** Changes often occur in quick succession within a short timeframe for a single file (e.g., `UploadFile.jsx`, `CustomerMapping.jsx`), suggesting focused development sessions on specific features or components.