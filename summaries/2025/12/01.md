# Activity Summary for 12/1/2025

## 6:54:17 AM
The provided log details changes to two core components of a dynamic form builder application, both timestamped on **11/28/2025**, indicating a cohesive set of updates.

**File-Specific Updates:**

1.  **`c:\Users\ridap\Downloads\dynamic-form-builder\components\form\dynamic-form.tsx` (Timestamp: 11/28/2025, 10:38:27 PM)**
    This file defines the main `DynamicForm` component responsible for generating and managing a form based on a provided schema.
    *   It utilizes `@tanstack/react-form` for form state management and `zod` for robust validation, integrated via `@tanstack/zod-form-adapter`.
    *   A key function, `buildValidationSchema`, dynamically constructs a Zod schema from the `FormSchema` prop. It supports various field types (`text`, `textarea`, `number`, `date`, `select`, `multi-select`, `switch`) and applies detailed validation rules such as `minLength`, `maxLength`, `regex`, `min`, `max`, `minDate`, `minSelected`, and `maxSelected`, along with general `required` checks.
    *   The component initializes form fields with appropriate default values (e.g., empty string, empty array, boolean false).
    *   It renders the form, including displaying success and error messages via `Alert` components.
    *   It iterates through the form schema fields, delegating the rendering of individual fields to the `FormFieldRenderer` component, passing down field state and change handlers.
    *   A submit button is included, showing a loading spinner and "Submitting..." text when `isLoading` is true.

2.  **`c:\Users\ridap\Downloads\dynamic-form-builder\components\form\form-field-renderer.tsx` (Timestamp: 11/28/2025, 10:39:45 PM)**
    This file contains the `FormFieldRenderer` component, which is responsible for rendering the specific UI element for each form field type.
    *   It uses a `switch` statement to conditionally render `Input`, `Textarea`, `Select`, `Switch`, or custom sub-components (`MultiSelectField`, `DateField`) based on the `field.type`.
    *   It integrates numerous UI components, likely from a shared component library (e.g., Shadcn UI), including `Label`, `Input`, `Textarea`, `Switch`, `Select`, `Command`, `Popover`, and `Calendar`.
    *   For complex fields:
        *   `MultiSelectField` provides a searchable multi-select experience using `Popover` and `Command` components, displaying the number of selected items and allowing selection toggling.
        *   `DateField` uses `Popover` and a `Calendar` component for date selection, formatting the displayed date and disabling future dates.
    *   Each field includes a label (with a `*` for required fields), an optional description, and displays validation errors directly below the input, also applying a `border-destructive` class to highlight erroneous inputs.

**Patterns and Recurring Elements:**

*   **Dynamic Form Generation**: The primary pattern is the dynamic generation of forms and their fields based on a `FormSchema`, making the form highly configurable.
*   **UI Component Library**: Both files extensively use UI components imported from `@/components/ui`, suggesting a consistent design system (likely Shadcn UI given the component names like `Input`, `Button`, `Alert`, `Calendar`, `Command`, `Popover`).
*   **Form Management and Validation Stack**: The combination of `@tanstack/react-form` for core form logic and `zod` for schema validation (via `@tanstack/zod-form-adapter`) is central to the form's functionality, providing robust and type-safe data handling.
*   **Client Components**: Both files include the `"use client"` directive, indicating they are designed to run on the client side, typical for interactive form components in Next.js or similar frameworks.
*   **Error Handling and Feedback**: A consistent approach to displaying validation errors (text below the field, `border-destructive` class) and general form submission feedback (success/error alerts, loading states) is implemented across both components.
*   **Modular Design**: The separation of concerns into `DynamicForm` (overall form logic, schema building) and `FormFieldRenderer` (individual field rendering) promotes modularity and maintainability.

## 7:54:10 AM
The provided code logs detail updates to a dynamic form builder application, focusing on its core components. Both files were modified on **November 28, 2025,** within a minute and eighteen seconds of each other, indicating a highly concentrated development effort.

**File: `c:\Users\ridap\Downloads\dynamic-form-builder\components\form\dynamic-form.tsx` (Timestamp: 11/28/2025, 10:38:27 PM)**
This file defines the main `DynamicForm` component, which is responsible for rendering an entire form based on a given schema.
*   It utilizes `@tanstack/react-form` for form management and `@tanstack/zod-form-adapter` with `zod` for robust schema validation.
*   A key function, `buildValidationSchema`, dynamically constructs a Zod validation schema. This function supports various field types (`text`, `number`, `date`, `select`, `multi-select`, `switch`) and applies validation rules such as `minLength`, `maxLength`, `min`, `max`, `regex`, `minDate`, `minSelected`, `maxSelected`, and `required` based on the field's definition.
*   The component renders individual form fields using the `FormFieldRenderer` component (imported from `./form-field-renderer`).
*   It includes UI elements for displaying success and error messages using `Alert` components and manages a loading state for the submit button with a `Loader` icon.

**File: `c:\Users\ridap\Downloads\dynamic-form-builder\components\form\form-field-renderer.tsx` (Timestamp: 11/28/2025, 10:39:45 PM)**
This file contains the `FormFieldRenderer` component, which is tasked with rendering the appropriate UI element for each specific form field type.
*   It uses a `switch` statement to conditionally render different UI components based on the `field.type` property.
*   Supported field types include:
    *   `text`, `number`, `textarea`: Rendered using `Input` and `Textarea` components.
    *   `select`: Uses `Select` components for single option selection.
    *   `multi-select`: Handled by a dedicated `MultiSelectField` sub-component, which leverages `Popover` and `Command` components for a searchable, multi-selection interface.
    *   `date`: Handled by a `DateField` sub-component, utilizing `Popover`, `Calendar`, and `date-fns` for date picking and formatting.
    *   `switch`: Renders a `Switch` component.
*   Each rendered field includes a `Label`, optional `description`, and displays validation `error` messages.
*   The component consistently applies `border-destructive` class to input elements when an error is present.

**Patterns and Recurring Elements:**
*   **Dynamic Form Generation:** Both components are integral parts of a system designed to build forms dynamically from a schema, with `dynamic-form.tsx` orchestrating the form and `form-field-renderer.tsx` focusing on individual field presentation.
*   **Zod Validation:** `dynamic-form.tsx` heavily relies on Zod for comprehensive schema validation, ensuring data integrity.
*   **Shadcn/UI Integration:** The consistent import paths (`@/components/ui/...`) for `Button`, `Input`, `Textarea`, `Switch`, `Select`, `Alert`, `Popover`, `Calendar`, and `Command` suggest the widespread use of Shadcn/UI or a similar component library, providing a cohesive design system.
*   **Client-Side Rendering:** Both files begin with `"use client"`, indicating they are client-side components within a React framework like Next.js.
*   **Consistent Error Display:** A recurring pattern is observed in how validation errors are handled, often involving conditional styling (e.g., `border-destructive`) and clear error message display.
*   **Timestamp Proximity:** The very close timestamps imply these changes were part of a single, focused development iteration or commit, likely adding or refining the core dynamic form functionality.

## 8:32:49 AM
The changes log outlines the development of a React application with Redux integration, focusing on an e-commerce-like structure.

**File-Specific Updates:**

*   **`c:\Users\ridap\Downloads\react-redux\src\App.jsx`**:
    *   **7:33:04 AM**: Initial setup of a basic React component, including `useState` and a placeholder heading "React Redux Learing....".
    *   **8:02:01 AM**: Integrates the `Header` component into `App.jsx`.
    *   **8:03:24 AM**: Minor formatting update to `App.jsx`.
    *   **8:05:53 AM**: Imports `App.css` to `App.jsx`.
    *   **8:10:49 AM**: Integrates the `Product` component into `App.jsx`.
    *   **8:11:31 AM**: Removes the "React Redux Learing...." heading, leaving only `Header` and `Product` components.

*   **`c:\Users\ridap\Downloads\react-redux\src\index.css`**:
    *   **7:33:15 AM**: Created as an empty CSS file.
    *   **Later changes**: The `main.jsx` file later attempts to import `index.css`.

*   **`c:\Users\ridap\Downloads\react-redux\src\App.css`**:
    *   **7:33:21 AM**: Created as an empty CSS file.
    *   **8:02:28 AM**: Significant styling was added for global resets (`*`), and specific styles for `.header`, `.logo`, `.nav-links`, `.cart-container`, `.cart-icon`, and `.cart-count`.
    *   **8:11:10 AM**: Further styling was added for `.product-card`, `.product-img`, `.product-title`, `.product-price`, `.new-price`, `.old-price`, `.product-rating`, and `.add-cart-btn`.

*   **`c:\Users\ridap\Downloads\react-redux\src\main.jsx`**:
    *   **7:33:30 AM**: Sets up basic React rendering using `StrictMode` and `App` component.
    *   **7:50:10 AM**: Integrates Redux by importing `Provider` from `react-redux` and `store` from `./store.js`, wrapping the `App` component with `Provider`.
    *   **8:01:07 AM**: Modifies the store import path from `./store.js` to `./redux/store.js`, suggesting a restructuring of the Redux store location.
    *   **8:04:11 AM**: Adds `import '../src/App.css'` (an unusual path, likely a typo intended for `./App.css`).
    *   **8:04:39 AM**: Introduces syntax errors with a partial `<Provi` tag and removes `Provider` and `store` imports, potentially a temporary experimental or erroneous change.
    *   **8:04:59 AM**: Corrects the `Provider` tag but removes the `store` prop and the `store` import, indicating an incomplete Redux setup.
    *   **8:05:25 AM**: Correctly re-integrates Redux `Provider` with the `store` prop and imports `store` from `./redux/store.js`. Imports `./index.css`.

*   **`c:\Users\ridap\Downloads\react-redux\src\store.js`**:
    *   **7:49:33 AM**: Initializes a Redux store using `configureStore` from `@reduxjs/toolkit`, but with an incorrect `reducer` syntax.
    *   **7:50:57 AM**: Corrects the `reducer` syntax within `configureStore` to be an empty object.

*   **`c:\Users\ridap\Downloads\react-redux\src\Header.jsx`**:
    *   **8:00:52 AM**: Creates a `Header` component with a logo, navigation links, and a cart icon with a count, using `class` attributes.
    *   **8:00:59 AM**: Minor formatting adjustment.
    *   **8:01:49 AM**: Removes the cart container and icon from the `Header` component, indicating that cart functionality might be moved to a separate component.
    *   **8:06:06 AM**: Further simplifies the `Header` component by removing "Offers" and "Contact" links.
    *   **8:07:02 AM**: Re-introduces the cart functionality by importing and rendering an `AddToCart` component.
    *   **8:16:18 AM**: Updates `class` attributes to `className` for React compatibility.

*   **`c:\Users\ridap\Downloads\react-redux\src\AddToCart.jsx`**:
    *   **8:01:39 AM**: Creates a dedicated `AddToCart` component, encapsulating the cart icon and count previously in `Header`.
    *   **8:16:26 AM**: Updates `class` attributes to `className` for React compatibility.

*   **`c:\Users\ridap\Downloads\react-redux\src\Product.jsx`**:
    *   **8:09:50 AM**: Introduces a `Product` component with an image, title, price (new and old), rating, and an "Add to Cart" button. Uses `class` attributes.
    *   **8:13:30 AM**: Updates the product image source to a more specific URL.
    *   **8:13:58 AM**: Updates the product title from "Sample Product Name" to "Wire Less Mouse".
    *   **8:15:36 AM**: Updates `class` attributes to `className` for React compatibility.

*   **`c:\Users\ridap\Downloads\react-redux\src\redux\slice.js`**:
    *   **8:28:09 AM**: Creates a Redux slice named `cart` using `createSlice`. It defines an `initialValue` with a `value` of 0 and a reducer `addItem` that increments `state.value`. Exports `addItem` action and `addToCart.reducer`. (Note: `initialValue` was initially placed incorrectly as a direct property of `createSlice` config).
    *   **8:30:35 AM**: Corrects the placement of `initialValue` within the `createSlice` configuration object.

*   **`c:\Users\ridap\Downloads\react-redux\src\redux\store.js`**:
    *   **8:30:11 AM**: Reconfigures the Redux store to integrate `CartReducer` (imported from `./slice`) under the `cart` key in the root reducer. This confirms the Redux store is now correctly set up with a `cart` slice.

**Timestamps of Significant Changes:**

*   **7:50:10 AM**: Initial integration of Redux `Provider` into `main.jsx`.
*   **7:50:57 AM**: Correction of `store.js` Redux `reducer` syntax.
*   **8:01:07 AM**: Restructuring of Redux store path in `main.jsx` to `./redux/store.js`.
*   **8:02:28 AM**: First substantial styling added to `App.css`.
*   **8:07:02 AM**: Introduction of `AddToCart.jsx` and its integration into `Header.jsx`.
*   **8:09:50 AM**: Creation of `Product.jsx`.
*   **8:11:10 AM**: Addition of `Product` specific styling in `App.css`.
*   **8:15:36 AM - 8:16:26 AM**: A series of updates across `Product.jsx`, `Header.jsx`, and `AddToCart.jsx` to switch from `class` to `className` attributes, indicating a focus on React best practices.
*   **8:28:09 AM**: Creation of the `cart` Redux slice (`slice.js`), marking the beginning of state management for cart functionality.
*   **8:30:11 AM**: Integration of the `cart` reducer into the Redux store (`store.js`).

**Patterns and Recurring Elements:**

*   **Component-based Development**: The log clearly shows a progression from a single `App` component to multiple specialized components like `Header`, `AddToCart`, and `Product`, promoting modularity.
*   **Redux Integration**: There's a consistent effort to set up Redux, starting with basic store configuration and eventually defining and integrating a `cart` slice. The path for the Redux store and slices was consolidated under a `redux` directory.
*   **Styling**: Styling is primarily handled in `App.css`, which grows with new component additions, indicating a global or centralized styling approach.
*   **React Best Practices**: A noticeable pattern is the correction of HTML `class` attributes to React's `className` across multiple components (`Header`, `AddToCart`, `Product`), suggesting a cleanup or adherence to React conventions.
*   **Incremental Development**: Changes are often small and focused, building functionality step-by-step (e.g., creating an empty CSS file, then adding styles, then adding more styles for new components).
*   **Error Correction/Refinement**: There are instances of correcting syntax errors (e.g., in `store.js` reducer definition, `main.jsx` `Provider` tag) and logical flow (e.g., moving cart icon to `AddToCart` component, correcting `initialValue` placement in `slice.js`).
*   **E-commerce Elements**: The components (Header with cart, Product card) and Redux slice (cart) strongly suggest the development of a basic e-commerce application.

## 8:54:12 AM
The provided code changes detail the implementation of a dynamic form builder, focusing on two core components: `DynamicForm` and `FormFieldRenderer`. Both files were updated on **11/28/2025**, at approximately **10:38 PM and 10:39 PM**, suggesting a concentrated development effort on these interconnected features. Both components are marked with `"use client"`, indicating they are client-side React components.

### File: `c:\Users\ridap\Downloads\dynamic-form-builder\components\form\dynamic-form.tsx`

This file defines the `DynamicForm` component, which orchestrates the creation, validation, and submission of a form based on a provided schema.

*   **Core Functionality:**
    *   **Dynamic Schema Validation:** It features a `buildValidationSchema` function that dynamically constructs a Zod validation schema based on the `FormSchema` prop. This function supports various field types (`text`, `textarea`, `number`, `date`, `select`, `multi-select`, `switch`) and applies appropriate validation rules such as `minLength`, `maxLength`, `regex`, `min`, `max`, `minDate`, `minSelected`, and `maxSelected`. It also handles required fields.
    *   **Form Management:** Utilizes `@tanstack/react-form` for form state management, `zodValidator` for integrating Zod with the form library, and sets up `defaultValues` for various field types (e.g., empty string, empty array, or false).
    *   **Rendering:** It iterates through the `schema.fields` and renders each field using the `FormFieldRenderer` component, passing necessary props like `value`, `onChange`, `onBlur`, and `error`.
    *   **Feedback & Submission:** Displays success and error messages using Shadcn UI's `Alert` component. The submit button shows a loading spinner and changes text when `isLoading` is true.

*   **Key Dependencies:** `@tanstack/react-form`, `zod`, custom `FormSchema` type, `FormFieldRenderer`, and UI components like `Button`, `Alert`, `AlertDescription` from `@/components/ui`.

### File: `c:\Users\ridap\Downloads\dynamic-form-builder\components\form\form-field-renderer.tsx`

This file defines the `FormFieldRenderer` component, responsible for rendering individual form fields based on their type and managing their basic input and error display.

*   **Core Functionality:**
    *   **Conditional Field Rendering:** The `renderField` function uses a `switch` statement to render different UI elements based on the `field.type`. It supports:
        *   `text`, `number`, `textarea`: Renders `Input` or `Textarea` components.
        *   `select`: Renders a `Select` component for single-option dropdowns.
        *   `multi-select`: Delegates rendering to a specialized `MultiSelectField` sub-component.
        *   `date`: Delegates rendering to a specialized `DateField` sub-component.
        *   `switch`: Renders a `Switch` component.
    *   **Labeling and Description:** Displays a `Label` for each field, marks required fields with an asterisk, and shows a `description` if provided.
    *   **Error Display:** Renders validation `error` messages below the respective fields and applies `border-destructive` styling to highlight problematic inputs.
    *   **`MultiSelectField` Sub-component:** Implements a multi-select dropdown using `Popover`, `Command` (for search/filtering), and `Button` components, allowing users to select multiple options.
    *   **`DateField` Sub-component:** Implements a date picker using `Popover`, `Calendar`, and `Button` components, allowing users to select a single date and disabling future dates.

*   **Key Dependencies:** Custom `FormField` type, various UI components from `@/components/ui` (e.g., `Input`, `Label`, `Textarea`, `Switch`, `Select`, `Command`, `Popover`, `Calendar`, `Button`), `lucide-react` icons (`CalendarIcon`, `Check`, `ChevronsUpDown`), `date-fns` for date formatting, and `useState` for internal component state.

### Patterns and Recurring Elements:

*   **Dynamic Form Generation:** Both components work in tandem to create highly configurable forms based on a structured `FormSchema`.
*   **Zod Integration:** Zod is a central tool for defining and applying robust validation rules dynamically.
*   **Shadcn/UI Usage:** A consistent pattern of using UI components from `@/components/ui` (e.g., `Button`, `Input`, `Select`, `Popover`, `Calendar`, `Alert`) is evident, indicating a unified design system.
*   **Error Handling and Feedback:** A clear mechanism for displaying validation errors (text and border styling) and general form feedback (success/error alerts) is implemented across both components.
*   **Component Composition:** Complex form elements like multi-select and date pickers are broken down into dedicated sub-components within `FormFieldRenderer` for better modularity and reusability.

## 9:50:23 AM
The code changes log details the incremental development of a React application, focusing on integrating Redux for state management, specifically for a shopping cart feature. The project begins with a basic React setup and gradually introduces UI components, styling, and robust state handling.

**File-Specific Updates:**

*   **`src\App.jsx`**:
    *   **Initial Setup (12/1/2025, 7:33:04 AM)**: Starts as a simple React component displaying "React Redux Learning....".
    *   **Component Integration (8:02:01 AM - 8:11:31 AM)**: Progressively imports and renders `Header` and `Product` components, eventually removing the initial `<h2>` tag and `reactLogo`/`viteLogo` imports.
    *   **Redux Action Integration (8:59:20 AM)**: Imports `useDispatch` and `clearAllItem` from the Redux slice and adds a "Clear All Cart Item" button to dispatch this action.
    *   `useState` is consistently imported but `count` is never actively used beyond its initial declaration.

*   **`src\index.css` (12/1/2025, 7:33:15 AM)**: Created as an empty file.

*   **`src\App.css`**:
    *   **Initial Setup (12/1/2025, 7:33:21 AM)**: Created as an empty file.
    *   **Header Styling (8:02:28 AM)**: Receives comprehensive CSS for a header, logo, navigation links, and a cart icon with a count.
    *   **Product Card Styling (8:11:10 AM)**: Adds styles for product cards, including images, titles, prices, ratings, and an "Add to Cart" button.
    *   **Remove Button Styling (8:53:18 AM - 8:55:02 AM)**: Introduces and refines styling for a "Remove Cart" button (`.remove-btn`), including background color, margin adjustments (`margin-left`, `margin-top`), and a hover effect. Also modifies the `.add-cart-btn` to use `display: flex` and adjusts its margin.

*   **`src\main.jsx`**:
    *   **React Root (12/1/2025, 7:33:30 AM)**: Sets up the React application to render `App` within `StrictMode`.
    *   **Redux Provider Integration (7:50:10 AM)**: Integrates Redux by importing `Provider` and `store`, wrapping the `App` component with `Provider` and passing the `store`.
    *   **Refactoring Store Path (8:01:07 AM)**: Changes the import path for `store` from `./store.js` to `./redux/store.js`, indicating a directory restructure for Redux files.
    *   **Styling Import & Corrections (8:04:11 AM - 8:05:25 AM)**: Imports CSS files (`../src/App.css`, then `./index.css`). There were temporary syntax errors and incomplete `Provider` usage that were quickly rectified.

*   **`src\store.js`**:
    *   **Initial Redux Store Setup (12/1/2025, 7:49:33 AM - 7:50:57 AM)**: Attempts to configure the Redux store using `@reduxjs/toolkit`, correcting initial syntax errors.
    *   **Obsolescence/Refactor (8:01:07 AM)**: This file seems to become obsolete or replaced as `main.jsx` starts importing from `./redux/store.js`.

*   **`src\redux\store.js` (12/1/2025, 8:30:11 AM)**: A new file is created (or existing `store.js` moved/renamed) in a `redux` subdirectory. It correctly configures the Redux store, importing `CartReducer` from `./slice` and assigning it to the `cart` slice of the reducer.

*   **`src\Header.jsx`**:
    *   **Initial Component (12/1/2025, 8:00:52 AM)**: Creates a header with a logo, navigation, and a cart section (initially hardcoded).
    *   **Cart Logic Extraction (8:01:49 AM - 8:07:02 AM)**: The cart display logic is removed from `Header` and later re-integrated by importing and rendering a separate `AddToCart` component. Navigation links are also streamlined.
    *   **React Best Practices (8:16:18 AM)**: Updates `class` attributes to `className`.
    *   **Redux Selector Experiments (8:37:07 AM - 8:38:35 AM)**: Briefly attempts to use `useSelector` to read cart state, including debugging `console.log` statements, before moving this logic entirely to `AddToCart.jsx`.

*   **`src\AddToCart.jsx`**:
    *   **Initial Component (12/1/2025, 8:01:39 AM)**: Created to display a cart icon with a hardcoded count.
    *   **React Best Practices (8:16:26 AM)**: Updates `class` attributes to `className`.
    *   **Redux Selector Integration (8:39:06 AM)**: Imports `useSelector` and dynamically displays the cart count from `state.cart.value` instead of a hardcoded number.

*   **`src\Product.jsx`**:
    *   **Initial Component (12/1/2025, 8:09:50 AM)**: Creates a component to display product details with an "Add to Cart" button.
    *   **Content & Styling Updates (8:13:30 AM - 8:15:36 AM)**: Updates product image, title ("Wire Less Mouse"), and changes `class` to `className`.
    *   **Redux Dispatch Integration (8:34:58 AM - 8:35:47 AM)**: Imports `useDispatch` and `addItem`, defining a function `AddToCart` to dispatch the `addItem` action on button click. Includes `console.log` for debugging.
    *   **Remove Button & Dispatch (8:52:46 AM - 8:58:09 AM)**: Adds a "Remove Cart" button. Initially dispatches `addItem` mistakenly, then correctly integrates `removeItem` action from Redux slice via a new `removeCartItem` function.

*   **`src\redux\slice.js`**:
    *   **Initial Redux Slice (12/1/2025, 8:28:09 AM)**: Creates a Redux slice named `cart` with an `initialValue` (later corrected to `initialState`) and an `addItem` reducer. Exports the action and reducer.
    *   **Corrections (8:30:35 AM - 8:32:59 AM)**: Fixes naming (`initialValue` to `initialState`) and property order within `createSlice`.
    *   **Adding Remove/Clear Actions (8:56:17 AM)**: Introduces `removeItem` and `clearAllItem` reducers. `removeItem` decrements `value` conditionally (only if `value > 0`).
    *   **Reducer Logic Refinements (8:57:02 AM - 8:57:33 AM)**: Corrects syntax and reintroduces the conditional check for `removeItem` to prevent negative cart counts.

**Timestamps of Significant Changes:**

*   **12/1/2025, 7:33 AM**: Initial project setup (React app, empty CSS files).
*   **12/1/2025, 7:49 AM - 7:50 AM**: First attempts at Redux store configuration and integration into `main.jsx`.
*   **12/1/2025, 8:00 AM - 8:01 AM**: Creation of `Header.jsx` and `AddToCart.jsx`, leading to component separation and the store path refactor in `main.jsx`.
*   **12/1/2025, 8:02 AM - 8:11 AM**: Extensive CSS styling additions and the introduction of `Product.jsx`.
*   **12/1/2025, 8:28 AM - 8:32 AM**: Creation and initial setup of the Redux cart slice (`slice.js`).
*   **12/1/2025, 8:34 AM - 8:39 AM**: Integration of `useDispatch` and `useSelector` in `Product.jsx` and `AddToCart.jsx` to interact with the Redux store.
*   **12/1/2025, 8:52 AM - 8:59 AM**: Implementation of `removeItem` and `clearAllItem` reducers in the slice, along with their respective button integrations in `Product.jsx` and `App.jsx`.

**Patterns and Recurring Elements:**

The changes demonstrate a clear progression in building a small e-commerce-like application with React and Redux:

1.  **Component-Based Development**: The UI is broken down into distinct, reusable components (`App`, `Header`, `AddToCart`, `Product`).
2.  **Redux Integration**: The core theme is the adoption of Redux for centralized state management, particularly for a shopping cart. This involves setting up the `Provider`, `store`, and `slice` (with reducers and actions), and then consuming this state via `useDispatch` and `useSelector`.
3.  **Iterative Styling**: CSS is added and refined in `App.css` incrementally as new components are introduced and their visual requirements evolve.
4.  **React Best Practices**: A consistent pattern of refactoring `class` attributes to `className` in JSX for React compatibility.
5.  **Debugging & Refinement**: Instances of `console.log` and corrections to syntax or logic (e.g., `initialValue` to `initialState`, fixing `removeItem` conditional) indicate an iterative development and debugging process.
6.  **Refactoring for Structure**: The movement of Redux-related files into a dedicated `src/redux` subdirectory (`store.js`, `slice.js`) indicates an effort to maintain better project organization.

## 9:54:07 AM
The file `c:\Users\ridap\Downloads\dynamic-form-builder\components\form\dynamic-form.tsx`, last modified on 11/28/2025 at 10:38:27 PM, implements the core logic for a dynamic form builder. It leverages `@tanstack/react-form` for form management and `zod` for robust schema validation. The `buildValidationSchema` function dynamically constructs a Zod validation schema based on a provided `FormSchema` type, supporting various field types like text, number, date, select, multi-select, and switch. It includes comprehensive validation rules such as `minLength`, `maxLength`, `regex`, `min`, `max`, and handles `required` constraints appropriately for different field types. The `DynamicForm` component renders the form fields using `FormFieldRenderer` and displays submission status messages (success/error) along with a loading indicator for the submit button.

The file `c:\Users\ridap\Downloads\dynamic-form-builder\components\form\form-field-renderer.tsx`, with a timestamp of 11/28/2025 at 10:39:45 PM, is responsible for rendering individual form fields based on their type. It acts as a UI factory, using a `switch` statement to select and render the appropriate Shadcn UI component (e.g., `Input`, `Textarea`, `Select`, `Switch`). It also includes specialized nested components: `MultiSelectField` which provides a searchable multi-select dropdown using `Popover` and `Command`, and `DateField` which offers a date picker using `Popover` and `Calendar` with date formatting and the ability to disable future dates. The component consistently displays field labels, descriptions, and error messages, applying a `border-destructive` class to input elements when an error is present.

Both files are integral to a dynamic form builder application, indicated by their shared `dynamic-form-builder` project path and `components/form` directory. They both utilize the `"use client"` directive for client-side rendering and extensively import UI components from `@/components/ui/` (likely Shadcn UI), establishing a consistent visual language. A recurring pattern is the handling of different form `field.type` values and the visual indication of errors. The close timestamps suggest these files were developed or modified together as part of a single, cohesive feature implementation.

## 10:50:19 AM
The code changes primarily chronicle the development of a simple React e-commerce application integrating Redux for state management, focusing on a shopping cart functionality. The entire development process occurred on **December 1, 2025**.

**File-specific updates:**

*   **`src\App.jsx`**: This file evolved from a basic React component displaying "React Redux Learning..." to the main application entry point. It progressively integrated the `Header` component (starting at 8:02:01 AM), imported `App.css` (8:05:53 AM), and included the `Product` component (8:10:49 AM). Later, it was enhanced to include a "Clear All Cart Item" button (8:59:20 AM) that dispatches a Redux action to reset the cart.
*   **`src\index.css`**: This file was created empty at 7:33:15 AM and saw no further modifications in the provided log, suggesting it might serve as an entry point for global styles but remained unused or for future use.
*   **`src\App.css`**: Initially empty (7:33:21 AM), this file became the central stylesheet for the application. Significant styling for the header, logo, navigation links, and cart container was added around 8:02:28 AM. Product card styles, including image, title, price, rating, and "Add to Cart" button, were introduced at 8:11:10 AM. Later changes (8:53:18 AM - 8:55:02 AM) focused on styling the "Remove Cart" button, adjusting margins, display properties, and adding hover effects.
*   **`src\main.jsx`**: This file manages the main rendering of the React application. It underwent a critical transformation for Redux integration. Starting from a basic `StrictMode` render (7:33:30 AM), it was updated to import `Provider` and `store` from Redux (7:50:10 AM) and wrapped the `App` component within the `Provider`. The path for `store` was later moved to a dedicated `redux` directory (`./redux/store.js`) around 8:01:07 AM, signifying a structural organization. It also handled importing `index.css` for global styles.
*   **`src\store.js`**: This file was initially created (7:49:33 AM) to configure the Redux store using `@reduxjs/toolkit` but with minor syntax issues, which were quickly corrected (7:50:57 AM). Its role was then superseded by `src\redux\store.js` as the project structure evolved.
*   **`src\Header.jsx`**: This component was first introduced at 8:00:52 AM, setting up a header with a logo, navigation, and a hardcoded cart display. The cart display was later extracted into a separate `AddToCart` component (8:01:49 AM, fully integrated at 8:07:02 AM). It also saw changes to replace HTML `class` attributes with React's `className` (8:16:18 AM) and briefly experimented with `useSelector` for debugging cart state before delegating that responsibility to `AddToCart`.
*   **`src\AddToCart.jsx`**: Created at 8:01:39 AM, this component initially displayed a static cart icon and count. It was updated to use `className` for styling (8:16:26 AM) and critically, around 8:39:06 AM, it was integrated with Redux using `useSelector` to dynamically display the cart's item count (`state.cart.value`).
*   **`src\Product.jsx`**: This component, introduced at 8:09:50 AM, displayed a sample product card. It received updates to its product image and title (8:13:30 AM - 8:13:58 AM) and transitioned to `className` for styling (8:15:36 AM). A major set of changes between 8:34:58 AM and 8:35:47 AM involved integrating Redux: `useDispatch` and `addItem` were imported, and the "Add to Cart" button was wired to dispatch the `addItem` action. Later, a "Remove Cart" button was added (8:52:46 AM), and by 8:58:09 AM, it was correctly set up to dispatch the `removeItem` action.
*   **`src\redux\slice.js`**: This new file was created at 8:28:09 AM to define the `cart` Redux slice. It started with an `initialState` (initially `initialValue`) for a `value` of 0 and an `addItem` reducer. It was refined to follow Redux Toolkit conventions (8:30:35 AM - 8:32:59 AM). Significant additions around 8:56:17 AM included `removeItem` (decrementing `value` but not below zero) and `clearAllItem` (resetting `value` to 0) reducers, along with exporting their corresponding actions. Minor corrections to the `removeItem` logic were made until 8:57:33 AM.
*   **`src\redux\store.js`**: This file was created at 8:30:11 AM, taking over the role of `src\store.js`. It properly configures the Redux store, mapping the `CartReducer` from `src\redux\slice.js` to the `cart` key.

**Timestamps of significant changes:**

*   **7:50:10 AM**: First major Redux integration in `main.jsx`.
*   **8:02:28 AM**: Introduction of core application styling in `App.css`.
*   **8:07:02 AM**: Modularization of `Header` with `AddToCart`.
*   **8:11:10 AM**: Introduction of `Product` styling.
*   **8:28:09 AM**: Creation of the Redux `cart` slice.
*   **8:39:06 AM**: `AddToCart` component displays dynamic cart count from Redux state.
*   **8:56:17 AM**: Introduction of `removeItem` and `clearAllItem` actions/reducers for the cart.
*   **8:59:20 AM**: `App.jsx` implements a global "Clear All Cart Item" functionality.

**Patterns and recurring elements:**

*   **Progressive Redux Integration:** The development clearly shows a phased approach to integrating Redux, starting with store setup, then defining slices and actions, then dispatching actions, and finally consuming state in components.
*   **Component-based Refactoring:** Larger sections of UI (like the cart within the header) are consistently broken down into smaller, reusable components.
*   **Styling Workflow:** CSS files (initially empty) are gradually populated with styles as new UI components are introduced and refined.
*   **React `class` to `className` migration:** Multiple JSX files exhibit a consistent refactoring from using the HTML `class` attribute to the React-specific `className` attribute for styling.
*   **Debugging via `console.log`:** `console.log` statements were frequently used within `Product.jsx` and `Header.jsx` to verify state values or dispatched actions during development.
*   **Redux Toolkit Usage:** The `@reduxjs/toolkit` library is consistently used for Redux setup, indicating a modern approach to Redux state management.

## 10:54:10 AM
The provided code changes detail the implementation of a dynamic form builder application, focusing on client-side components for rendering and validating forms.

**File: `c:\Users\ridap\Downloads\dynamic-form-builder\components\form\dynamic-form.tsx` (Timestamp: 11/28/2025, 10:38:27 PM)**
This file defines the `DynamicForm` component, which is the orchestrator for generating forms based on a provided schema.
*   **Functionality:** It uses `@tanstack/react-form` for form management and `zod` for validation.
*   **`buildValidationSchema`:** A crucial function dynamically constructs a `zod` schema based on an input `FormSchema` (from `@/lib/types`). It supports various field types (`text`, `number`, `date`, `select`, `multi-select`, `switch`) and their associated validation rules like `minLength`, `maxLength`, `regex`, `min`, `max`, `minDate`, `minSelected`, `maxSelected`, and `required` fields.
*   **`DynamicForm` Component:**
    *   Initializes form state and applies the dynamically built `zod` validation.
    *   Handles form submission and displays `successMessage` or `errorMessage` using UI alerts.
    *   Iterates through the form schema fields, delegating the rendering of individual fields to the `FormFieldRenderer` component.
    *   Includes a submit button with a loading indicator.

**File: `c:\Users\ridap\Downloads\dynamic-form-builder\components\form\form-field-renderer.tsx` (Timestamp: 11/28/2025, 10:39:45 PM)**
This file defines the `FormFieldRenderer` component, responsible for rendering specific input types, and includes helper components for complex field types.
*   **Functionality:** It receives `FormField` data, current `value`, `onChange`, `onBlur`, and `error` to render the appropriate UI element.
*   **Field Rendering:** A `switch` statement handles different `field.type`s:
    *   `text`, `number`, `textarea`: Rendered using `Input` or `Textarea` components.
    *   `select`: Utilizes `Select` components for single choice dropdowns.
    *   `multi-select`: Delegates to the `MultiSelectField` helper component.
    *   `date`: Delegates to the `DateField` helper component.
    *   `switch`: Renders a `Switch` component.
*   **Helper Components:**
    *   **`MultiSelectField`:** Implements a searchable multi-select dropdown using `Popover`, `Command`, and `Button` components. It manages the selection of multiple options and displays the count of selected items.
    *   **`DateField`:** Provides a date picker using `Popover`, `Calendar`, and `Button` components. It uses `date-fns` for date formatting and disables future dates.
*   **UI/Styling:** It consistently applies labels, descriptions, and error messages, and uses a `border-destructive` class for input fields with validation errors.

**Patterns and Recurring Elements:**
*   **Client-Side React Components:** Both files explicitly use `"use client"`, indicating they are rendered on the client-side.
*   **`shadcn/ui` Convention:** The extensive use of UI components like `Button`, `Input`, `Select`, `Switch`, `Popover`, `Calendar`, `Command`, `Alert`, and `Label` strongly suggests adherence to the `shadcn/ui` component library for a consistent design system.
*   **`lucide-react` Icons:** Icons such as `AlertCircle`, `Loader`, `CalendarIcon`, `Check`, and `ChevronsUpDown` are consistently used for visual feedback and functionality.
*   **Dynamic Form Generation with Zod:** The core pattern involves dynamically generating form inputs and their `zod` validation schemas based on a flexible `FormSchema` type.
*   **Modular Design:** The separation of concerns between `DynamicForm` (overall form logic and validation) and `FormFieldRenderer` (individual field rendering) promotes maintainability and reusability.
*   **Centralized Error Handling:** A consistent approach to displaying validation errors for individual fields and overall form submission messages.
*   **Date Handling with `date-fns`:** The `date-fns` library is used for reliable date formatting and manipulation, specifically in the `DateField` component.

## 1:19:46 PM
This change log details an extensive update to the `agentBookingApi.js` file, located at `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\store\api\agentBookingApi.js`, with a timestamp of 12/1/2025, 11:47:38 AM.

The update significantly expands the API slice responsible for managing agent bookings, ISF (Importer Security Filing), and HBL (House Bill of Lading) within a frontend application using Redux Toolkit Query.

**Key File-Specific Updates:**

*   **Comprehensive Endpoint Expansion:** Numerous new endpoints have been added across three main categories:
    *   **Booking Management:**
        *   `saveBooking`: For creating new bookings.
        *   `fetchBookingDashboard`, `fetchBookingDetails`, `fetchBookingFormDetails`: For retrieving various levels of booking information.
        *   `saveBookingStatus`, `fetchCustomerApproveDetails`: For handling booking approval workflows.
        *   `createBookingXml`, `uploadBookingXml`: Functionality for generating and uploading XML data related to bookings.
        *   `updateCarrierBooking`, `updateDo`: Specific updates for carrier booking details and delivery orders. Notably, `updateDo` explicitly removes the `Content-Type` header from its request.
        *   `exportSprReport`: For exporting a booking report.
    *   **ISF Management:**
        *   `saveISF`, `fetchISFDetails`: For managing ISF data.
        *   `isfDescXmlCreate`, `isfDescXmlUpload`: Functionality for creating and uploading ISF description XML.
    *   **HBL (House Bill of Lading) Management:** A new set of endpoints for HBL has been introduced:
        *   `saveHblBooking`, `fetchHblBookingFormDetails`, `getHblDashboard`, `updateHblBooking`, `deleteHblBooking`: Providing full CRUD (Create, Read, Update, Delete) operations and dashboard views for HBL entries.
*   **New Tag Type:** A new `FormDetails` tag type has been added to the `tagTypes` array, indicating an expansion in caching granularity for form-specific data.
*   **Extensive Hook Exports:** The file now exports a large number of RTK Query hooks (e.g., `useSaveBookingMutation`, `useFetchBookingDashboardQuery`, `useSaveHblBookingMutation`, etc.) corresponding to each new and existing endpoint, making them available for use in components.

**Patterns and Recurring Elements:**

*   **Consistent API Structure:** All endpoints follow a standard RTK Query pattern using `builder.mutation` for POST/DELETE/PUT operations and `builder.query` for GET operations.
*   **Standard Headers:** The `getAppHeaders()` function is consistently used across almost all requests to provide application-specific headers (likely for authentication or content type).
*   **Query String Generation:** Queries frequently use `new URLSearchParams(params).toString()` to dynamically build query strings for GET requests.
*   **Robust Cache Management:** There is extensive and consistent use of `providesTags` and `invalidatesTags` to manage the Redux Toolkit Query cache, ensuring data freshness and efficient UI updates upon relevant mutations or fetches.
*   **API Base URL:** All requests are configured to use `API_BASE_URL` defined externally.
*   **Debugging Logs:** Several `console.log` statements (e.g., in `saveHblBooking`, `fetchHblBookingFormDetails`, `updateCarrierBooking`, `updateHblBooking`) are present, suggesting active development or debugging during these changes.
*   **XML Integration:** A notable pattern is the introduction of dedicated endpoints for generating and uploading XML files for both general bookings and ISF descriptions, indicating an integration with external systems or specific data formats.

## 1:19:49 PM
The provided log details changes exclusively within the file `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\hblEntry.controller.ts`.

**Summary of File-Specific Updates and Significant Timestamps:**

*   **Initial State (12/1/2025, 11:50:49 AM):**
    *   The file contains two main asynchronous controller functions: `createHblMasterBooking` and `updateHblMasterBooking`.
    *   `createHblMasterBooking` handles the insertion of a new HBL (House Bill of Lading) master record and related details (vessel, HBL specifics, routing, containers, purchase orders) into multiple database tables, all within a transaction (`BEGIN`, `COMMIT`, `ROLLBACK`). It populates a `hblEntryPayloadTypes` object from the request body, sanitizes string inputs, and formats dates.
    *   `updateHblMasterBooking` is present but appears to be in an early stage of development or refactoring. It primarily performs a single `updateQuery` on the `hbl_master` table based on a `serial_id` from the request body. A large, commented-out SQL `UPDATE` statement for `hbl_master` is visible, indicating a past or alternative implementation approach.

*   **Minor Adjustments (12/1/2025, 11:52:26 AM and 12/1/2025, 11:56:46 AM):**
    *   During these timestamps, only very minor cosmetic or formatting changes were applied. For instance, the quote style for string literals in the error response for a missing `serial_id` (`status: "error"` vs. `status: 'error'`) in `updateHblMasterBooking` changed. No functional changes to either `create` or `update` methods were introduced. The commented-out SQL block in `updateHblMasterBooking` remained.

*   **Major Refactoring (12/1/2025, 11:58:52 AM):**
    *   This timestamp marks a significant refactor of the `updateHblMasterBooking` function.
    *   The commented-out SQL block has been removed.
    *   The `updateHblMasterBooking` function is expanded to perform comprehensive updates across all related tables, mirroring the `create` function's multi-table approach.
    *   It now explicitly updates:
        *   `hbl_master` (using `updateQuery`).
        *   `agent_booking_vessel` (using a direct SQL `UPDATE` statement).
        *   `agent_booking_hbl` (using `updateQuery`).
    *   For lists such as `routingList`, `containerList`, and `basicPoList`, the strategy shifts to a "delete and insert many" pattern. Existing records associated with the `hbl_master_id` are deleted first, and then new records from the payload are inserted using `insertMany`. This ensures that these sub-entries are completely synchronized with the incoming payload.
    *   Variable declarations within `updateHblMasterBooking` (`locationByRole`, `payload`) are now consistently using `const`.
    *   The `createHblMasterBooking` function remains largely unchanged from its initial state.

**Patterns and Recurring Elements:**

*   **Input Sanitization and Date Formatting:** Both `create` and `update` functions extensively use `sanitizeString()` for all incoming string data and `AppDateFormate()` to convert dates to a `YYYY-MM-DD` format (`db_format`) before interacting with the database. This indicates a consistent approach to data cleanliness and database compatibility.
*   **Transactional Database Operations:** All significant database modifications are wrapped within `await query('BEGIN')`, followed by multiple `insertQuery`, `updateQuery`, `insertMany`, or direct `query` operations, and concluded with `await query('COMMIT')` on success or `await query('ROLLBACK')` in case of an error. This pattern ensures atomicity and data integrity.
*   **Error Handling:** The code consistently checks the `rowCount` returned by database operations and throws an `HttpError` with a 500 status code if an expected row count is not met, indicating a failure to save or update. Errors are also logged using `logger.error`.
*   **Unified Payload Structure:** The `hblEntryPayloadTypes` object is central to both creating and updating HBL records, suggesting a well-defined and consistent data model for HBL information across different operations.
*   **Role-Based Data Assignment:** The `locationByRole` variable is determined based on `req.user.role` (AGENT vs. other roles like companyname), indicating role-specific data handling.

## 2:19:55 PM
The provided log details changes exclusively to the file `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\hblEntry.controller.ts` between 12/1/2025, 11:50:49 AM and 12/1/2025, 2:12:58 PM.

**File-Specific Updates (`hblEntry.controller.ts`):**

The changes primarily revolve around the `updateHblMasterBooking` function, while the `createHblMasterBooking` function remains largely consistent throughout the log.

1.  **Initial State (12/1/2025, 11:50:49 AM - 11:56:46 AM):** The `updateHblMasterBooking` function was initially structured to update the `hbl_master` table using a generic `updateQuery` helper function. It contained a significant commented-out block representing a direct SQL `UPDATE` statement for `hbl_master`, suggesting an alternative or previous implementation approach. The `createHblMasterBooking` function already implemented a comprehensive, transactional insertion process across multiple tables (`hbl_master`, `agent_booking_vessel`, `agent_booking_hbl`, `agent_booking_routing`, `agent_booking_container`, `agent_booking_po`).

2.  **Major Refactoring for Updates (12/1/2025, 11:58:52 AM):** This was a significant update. The commented-out raw SQL for `hbl_master` was removed. The `updateHblMasterBooking` function was expanded to manage related sub-tables:
    *   It started updating `agent_booking_vessel` using a direct SQL `UPDATE` query.
    *   It introduced an update for `agent_booking_hbl` using the `updateQuery` helper.
    *   For `agent_booking_routing` and `agent_booking_container` lists, a pattern of "delete all existing entries for the HBL and then re-insert new ones" was implemented using raw `DELETE` SQL and the `insertMany` helper.

3.  **Partial Reversion to Raw SQL & Field Additions (12/1/2025, 1:20:16 PM - 1:27:58 PM):** The `updateHblMasterBooking` underwent further refinement, specifically moving away from `updateQuery` for `hbl_master` and `agent_booking_hbl`.
    *   **1:20:16 PM:** The `updateQuery` for `hbl_master` and `agent_booking_hbl` was replaced by direct, extensive SQL `UPDATE` statements, similar to the initially commented-out block.
    *   **1:22:23 PM:** The `UPDATE agent_booking_hbl` SQL query was modified to include the `marks` field.
    *   **1:26:16 PM:** The `UPDATE hbl_master` SQL query was modified to include the `bookingdate` field. A `console.log` for debugging the `payload` was also added.
    *   **1:27:58 PM:** The `UPDATE agent_booking_hbl` SQL query was further modified to include the `hbldate` field.

4.  **Minor Data Source Correction (12/1/2025, 1:38:52 PM):** In the `updateHblMasterBooking` function, the `agent_booking_id` and `booking_id` fields within the `insertMany` call for `agent_booking_routing` were updated to consistently use `payload.booking_id` instead of `req.body.agent_booking_id`.

**Patterns and Recurring Elements:**

*   **Transactional Integrity:** Both `createHblMasterBooking` and `updateHblMasterBooking` consistently implement database transactions using `await query('BEGIN')`, `await query('COMMIT')`, and `await query('ROLLBACK')` within `try-catch` blocks. This ensures atomicity of multi-table operations.
*   **Data Sanitization and Formatting:** `sanitizeString` is extensively applied to almost all incoming string fields from `req.body` to prevent injection vulnerabilities and ensure data cleanliness. `AppDateFormate` is used for consistent date formatting (`YYYY-MM-DD`).
*   **Multi-table Data Handling:** Both creation and update operations are complex, involving coordinated inserts/updates across several interconnected database tables (`hbl_master`, `agent_booking_vessel`, `agent_booking_hbl`, `agent_booking_routing`, `agent_booking_container`, `agent_booking_po`).
*   **Error Management:** `HttpError` is used for specific business logic failures (e.g., unable to save HBL), and `logger.error(error)` ensures detailed logging of exceptions.
*   **Role-Based Data Sourcing:** The `locationByRole` variable is consistently determined based on `req.user.role` (either `req.user?.location` for `AGENT` or `req.user?.companyname` otherwise) in both create and update functions.
*   **"Delete and Re-insert" Pattern for Lists:** For dynamic lists like `routingList` and `containerList`, the update strategy involves deleting all associated records for a given `hbl_master_id` and then inserting the new list items, simplifying update logic for variable-length lists.

## 2:20:08 PM
**File-Specific Updates and Timestamps:**

**`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\store\api\agentBookingApi.js`**
*   **Timestamp: 12/1/2025, 11:47:38 AM**
    *   **Key Changes:** Introduced a new `tagType` called `FormDetails` for Redux Toolkit Query. A new `fetchBookingFormDetails` query was added, providing `FormDetails` and `UPDATE` tags. A significant set of new API endpoints were added specifically for House Bill of Lading (HBL) functionality, including mutations for `saveHblBooking`, `updateHblBooking`, `deleteHblBooking`, and queries for `fetchHblBookingFormDetails` and `getHblDashboard`. Mutations for `updateCarrierBooking` and `updateDo` were also added, along with a query for `exportSprReport`. Corresponding RTK Query hooks were exported.

**`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblRoutingForm.jsx`**
*   **Timestamp: 12/1/2025, 1:32:15 PM**
    *   **Key Changes:** Initial creation of the `HblRoutingForm` component. This component manages a list of routing details for HBL entries, displaying them in an `AppTable` with edit and delete capabilities. It uses an `Accordion` for UI organization and a `ThemedModal` to house the `AddRoutingDetailForm` for adding or editing individual routing entries. State management for the routing list is handled via Redux (`hblEntryFormSlice`).
*   **Timestamp: 12/1/2025, 1:49:14 PM**
    *   **Key Changes:** Modified the `handleSubmitRouting` logic to explicitly retain the `slno` (serial number) when updating an existing routing detail, using `row: { ...data, slno: modal.data.slno }`.
*   **Timestamp: 12/1/2025, 1:50:42 PM**
    *   **Key Changes:** Reverted the `handleSubmitRouting` logic for updates back to `row: data` and removed a `console.log` statement.
*   **Timestamp: 12/1/2025, 1:54:31 PM**
    *   **Key Changes:** Refined the `handleSubmitRouting` logic again: for edits, it now merges `modal.data` with the submitted `data` (`row: { ...modal.data, ...data }`) to preserve `slno`. For new additions, it sends just `row: data`, with a comment indicating the reducer is responsible for `slno` generation.
*   **Timestamp: 12/1/2025, 1:56:46 PM**
    *   **Key Changes:** Added a `console.log` statement to display the `routingList` state.
*   **Timestamp: 12/1/2025, 1:57:37 PM**
    *   **Key Changes:** Reverted the `handleSubmitRouting` logic for both add and edit modes to an earlier version (similar to 1:50:42 PM), and removed the `console.log` statement added at 1:56:46 PM.
*   **Timestamp: 12/1/2025, 1:58:12 PM**
    *   **Key Changes:** Re-added the `console.log` statement for `routingList`.
*   **Timestamp: 12/1/2025, 2:00:51 PM**
    *   **Key Changes:** Changed the prop name passed to `AddRoutingDetailForm` from `onSubmit` to `onSubmitData`.
*   **Timestamp: 12/1/2025, 2:03:58 PM**
    *   **Key Changes:** Reverted the prop name passed to `AddRoutingDetailForm` back from `onSubmitData` to `onSubmit`.

**`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\form\sub-components\AddRoutingDetailForm.jsx`**
*   **Timestamp: 12/1/2025, 1:44:41 PM**
    *   **Key Changes:** Initial creation of the `AddRoutingDetailForm` component. This form uses `Formik` for state and validation, and `useReducer` to manage options for autocomplete fields. It includes fields for "Transport Mode", "Origin", "Destination", "ETD", and "ETA".
*   **Timestamp: 12/1/2025, 1:45:50 PM**
    *   **Key Changes:** Temporarily commented out the `AppAutocomplete` components for "Origin" and "Destination".
*   **Timestamp: 12/1/2025, 1:46:25 PM**
    *   **Key Changes:** Uncommented and restored the `AppAutocomplete` components for "Origin" and "Destination".
*   **Timestamp: 12/1/2025, 1:48:09 PM**
    *   **Key Changes:** Added `enableReinitialize: true` to `useFormik` to ensure form reinitialization on prop changes. Simplified the `options` state in `useReducer` to only `pol` and `pod`. Removed `console.log` statements within `onSubmit` and changed the submit button text from "Edit" to "Update" when in edit mode. Styling props `Fsx` were also removed or replaced with `sx`.
*   **Timestamp: 12/1/2025, 1:50:48 PM**
    *   **Key Changes:** Reverted most changes from 1:48:09 PM, re-adding `console.log` in `onSubmit`, restoring `por` and `fpd` to `options` initial state, reverting button text to "Edit", and reintroducing `Fsx` styling.
*   **Timestamp: 12/1/2025, 1:59:13 PM**
    *   **Key Changes:** Added a `console.log` for the `model` prop (with a typo, should be `modal`).
*   **Timestamp: 12/1/2025, 1:59:23 PM**
    *   **Key Changes:** Corrected the typo in the `console.log` from `model` to `modal`.
*   **Timestamp: 12/1/2025, 2:00:44 PM**
    *   **Key Changes:** Renamed the `onSubmit` prop received by the component to `onSubmitData`.
*   **Timestamp: 12/1/2025, 2:01:51 PM**
    *   **Key Changes:** Added `onSubmitData` to the existing `console.log` in the component body.
*   **Timestamp: 12/1/2025, 2:03:53 PM**
    *   **Key Changes:** Reverted the `onSubmitData` prop back to `onSubmit`.

**`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblEntryFormScreen.jsx`**
*   **Timestamp: 12/1/2025, 2:04:52 PM**
    *   **Key Changes:** Initial creation of `HblEntryFormScreen`. This is the main screen for HBL entry, responsible for fetching HBL data (`useFetchHblBookingFormDetailsQuery`), managing overall form actions (add/edit/copy), and handling sub-components like `HBLForm`, `AddMasterForm`, and `HblPartyScreen`. It initializes Redux lists (`containers`, `routing`, `po`) based on fetched HBL data and includes functionality for exporting parties.
*   **Timestamp: 12/1/2025, 2:06:02 PM**
    *   **Key Changes:** Added a `ThemeButton` to the `rightComps` of the `ScreenToolbar`.
*   **Timestamp: 12/1/2025, 2:07:06 PM**
    *   **Key Changes:** Replaced the `ThemeButton` in the toolbar with an `OutlinedButton` labeled "HBL Audit", with its `onClick` handler commented out.
*   **Timestamp: 12/1/2025, 2:09:48 PM**
    *   **Key Changes:** Removed the "HBL Audit" button from the `ScreenToolbar`'s `rightComps`.

**`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\data\columns\agent.booking.js`**
*   **Timestamp: 12/1/2025, 2:08:41 PM**
    *   **Key Changes:** This file was updated to define various column configurations for tables within the booking module. It includes `BOOKING_VESSEL_COLUMN` (for vessel details, with an "Add" action), `BOOKING_VESSEL_COLUMN_CUSTOMER` (a customer-facing version), `BOOKING_CARGO_COLUMN` (for cargo details, with conditional "Add Vessel" action), and `BOOKING_DASHBOARD_COLUMNS_GRID` (for the booking dashboard, including status chips and date formatting). `HBL_COLUMNS` is implied as used in `HBLListDetails` but not explicitly shown in its definition here.

**`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLListDetails.jsx`**
*   **Timestamp: 12/1/2025, 2:10:18 PM**
    *   **Key Changes:** Initial creation of the `HblListDetails` component. This component fetches and displays a list of HBL entries using `useGetHblDashboardQuery`. It integrates functionality to delete HBL entries via `useDeleteHblBookingMutation`, showing toast notifications for success/failure. The data is presented in a `ThemedGrid` and includes an "Add HBL" button that navigates to the HBL entry form.

**Patterns and Recurring Elements:**

1.  **HBL Feature Development:** The primary focus across all changes is the implementation and refinement of a comprehensive House Bill of Lading (HBL) feature, encompassing API integration, data entry forms, and list views.
2.  **Redux Toolkit Query (RTK Query):** The `agentBookingApi.js` file demonstrates heavy reliance on RTK Query for declarative API fetching and mutation, utilizing `tagTypes`, `providesTags`, and `invalidatesTags` for efficient cache management.
3.  **Consistent UI Framework (MUI):** All UI-related files (`HblRoutingForm.jsx`, `AddRoutingDetailForm.jsx`, `HblEntryFormScreen.jsx`, `HBLListDetails.jsx`) consistently use Material-UI components (`Accordion`, `Grid`, `Stack`, `IconButton`, `ThemedModal`, `OutlinedButton`, `ThemeButton`, `AppAutocomplete`, `AppDatePicker`, `SelectBox`) to maintain a uniform look and feel.
4.  **Form Management with Formik:** `AddRoutingDetailForm.jsx` consistently employs `useFormik` for handling form state, validation, and submission, adapting initial values for "add" and "edit" scenarios.
5.  **Redux for Global State:** Redux (`hblEntryFormSlice`) is used to manage dynamic lists (like routing details, containers, POs) that are part of the HBL entry form, with `dispatch` and `useSelector` hooks.
6.  **Modal-Driven Interactions:** A recurring pattern is the use of `ThemedModal` components to encapsulate form inputs for adding or editing sub-details (e.g., routing details) or to manage related entities (e.g., parties).
7.  **`slno` Management:** The `slno` (serial number) property for list items is a recurring concern, with `HblRoutingForm.jsx` showing iterative changes in how `slno` is assigned or preserved during add and edit operations.
8.  **Debugging via `console.log`:** Frequent additions and removals of `console.log` statements are present across `AddRoutingDetailForm.jsx` and `HblRoutingForm.jsx`, indicating active development and debugging.
9.  **Date Formatting Utility:** The `appDateFormat` utility function is consistently used in column definitions to ensure standardized date display.

## 3:19:58 PM
The provided log details code changes across several JavaScript files related to a "T360_Api" frontend project, focusing on booking functionalities, particularly House Bill of Lading (HBL) entry and routing.

**File-Specific Updates:**

1.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\store\api\agentBookingApi.js`** (Timestamp: 12/1/2025, 11:47:38 AM)
    *   This file defines the Redux Toolkit Query API for agent booking.
    *   **Key additions:** New mutations `saveHblBooking`, `updateCarrierBooking`, `updateDo`, `updateHblBooking`, `deleteHblBooking` and queries `fetchHblBookingFormDetails`, `exportSprReport`, `getHblDashboard` were added.
    *   `tagTypes` were extended to include `HBL` and `FormDetails`.
    *   Console logs were added to `saveHblBooking` and `fetchHblBookingFormDetails` for debugging.
    *   The `invalidatesTags` for `updateCarrierBooking` were updated to include "Details".
    *   The `updateDo` mutation now explicitly removes `Content-Type` from headers.
    *   New exports for the added hooks (`useSaveHblBookingMutation`, `useFetchHblBookingFormDetailsQuery`, etc.) were included.

2.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblRoutingForm.jsx`** (Multiple timestamps: 12/1/2025, 1:32:15 PM - 1:58:12 PM)
    *   This component manages the "Routing Details" section for HBLs, allowing users to add, edit, and delete routing entries in a table.
    *   **Initial implementation (1:32:15 PM):** Introduced `HblRoutingForm` with state for `expanded` accordion and modal details (`open`, `type`, `data`). It uses Redux (`hblEntryFormSlice`) for managing `routingList`. `handleEdit`, `handleDelete`, `handleSubmitRouting` functions were defined. The `COLUMN` definition includes edit and delete actions.
    *   **Subsequent changes (1:49:14 PM, 1:50:42 PM, 1:53:51 PM, 1:56:46 PM, 1:57:37 PM, 1:58:12 PM):**
        *   Minor modifications were observed in the `handleSubmitRouting` logic. Initially, on edit, it used `slno: modal.data.slno` for the `row` in `updateList`. This was then changed to pass `row: data` directly, implying the `data` already contains the `slno`. Later, it was reverted to `{ ...modal.data, ...data }` to ensure `slno` is preserved during updates, and for `addList`, it was changed to pass `data` directly, expecting the reducer to auto-add `slno`. Then, it was reverted back to `{ ...data, slno: routingList.length + 1 }` for adding.
        *   Debugging `console.log` statements were added and removed (`console.log(data,"data908====")`, `console.log(routingList, " routinglist")`).

3.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\form\sub-components\AddRoutingDetailForm.jsx`** (Multiple timestamps: 12/1/2025, 1:44:41 PM - 2:03:53 PM)
    *   This component provides a form for adding or editing individual routing details within the `HblRoutingForm`.
    *   **Initial implementation (1:44:41 PM):** Defined `AddRoutingDetailForm` using Formik for form management, `useReducer` for managing autocomplete options (pol, pod, etc.), and `AppDatePicker`, `SelectBox`, `AppAutocomplete` for UI elements.
    *   **Changes (1:45:50 PM):** Briefly commented out the `AppAutocomplete` components for "Origin" (pol) and "Destination" (pod), likely for debugging or testing.
    *   **Reversion (1:46:25 PM):** The `AppAutocomplete` components for "Origin" and "Destination" were uncommented, restoring the previous state.
    *   **Refinement (1:48:09 PM):**
        *   Added `enableReinitialize: true` to `useFormik` to ensure form reinitializes with new `modal.data` when prop changes.
        *   Removed `console.log(value,"==values");` from `onSubmit`.
        *   Simplified `options` reducer's initial state by removing `por` and `fpd` as they were not used in this specific form.
        *   Removed `Fsx` prop from `SelectBox` and `AppAutocomplete` components, and also `marginButtom` and `marginTop` from their `sx` props, simplifying styling.
        *   Changed button text from "Edit" to "Update" when in edit mode.
    *   **Debugging (1:59:13 PM, 1:59:23 PM):** Added `console.log(model,"model====1234");` to debug the `modal` prop, with a typo (`model` instead of `modal`). The typo was corrected in the subsequent commit.
    *   **Prop name change (2:00:44 PM, 2:01:51 PM, 2:02:03 PM):** The `onSubmit` prop was renamed to `onSubmitData` and `onSubmitData(value)` was used in the `formik.onSubmit` callback. This change was reflected in `HblRoutingForm.jsx` as well.
    *   **Reversion (2:03:53 PM):** The `onSubmitData` prop was renamed back to `onSubmit`, and the corresponding usage inside `formik.onSubmit` was also reverted to `onSubmit(value)`.

4.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblEntryFormScreen.jsx`** (Multiple timestamps: 12/1/2025, 2:04:52 PM - 2:09:48 PM)
    *   This component serves as the main screen for HBL entry, managing form actions (add/edit/copy), modal states, and data loading.
    *   **Key updates:**
        *   Refactored the `useFetchHblBookingFormDetailsQuery` condition to specifically check `isEdit && state?.serial_id` for fetching HBL details, using `serial_id` for existing HBLs.
        *   The `useEffect` that initializes lists (`containers`, `routing`, `po`) from `hblDetails` was refined to handle array conversion more robustly and map `slno` for each item.
        *   A `ThemeButton` was briefly added to the `ScreenToolbar`'s `rightComps` (2:06:02 PM) and then replaced with an `OutlinedButton` for "HBL Audit" (2:07:06 PM).
        *   The `onClick` handler for the "HBL Audit" button was briefly commented out (2:07:16 PM) and then completely removed along with the button itself (2:09:48 PM). This indicates a change in the intended navigation or feature access for "HBL Audit".
        *   The `HblListDetails` component, previously imported and seemingly unused, was removed from the imports.

5.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\data\columns\agent.booking.js`** (Timestamp: 12/1/2025, 2:08:41 PM)
    *   This file defines column configurations for various booking-related tables.
    *   No direct changes in the provided content, but its import in `HBLListDetails.jsx` suggests it's relevant for `HBL_COLUMNS`.

6.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLListDetails.jsx`** (Multiple timestamps: 12/1/2025, 2:10:18 PM - 2:25:07 PM)
    *   This component displays a list of HBLs, likely a dashboard or a sub-screen.
    *   **Initial implementation (2:10:18 PM):** Fetches HBL dashboard data using `useGetHblDashboardQuery` based on `agent_booking_id` from `location.state`. Provides functionality to delete HBLs and navigate to the HBL entry form. Includes a `ScreenToolbar` with a "HBL Audit" button.
    *   **Minor adjustment (2:10:39 PM):** Improved whitespace in `Agent Booking ID` display.
    *   **Feature addition (2:22:47 PM):**
        *   Introduced state for `drawerOpen` and `drawerData` to manage a `ReusableRightDrawer`.
        *   The "HBL Audit" button now opens this `ReusableRightDrawer`, passing `data.serial_id` to it, and sets the `table` prop to "ISF" and `column` to `COMMON`.
    *   **Import and usage refinement (2:23:00 PM):** Imported `COMMON` columns from `../../../../data/columns/audit` for use in the `ReusableRightDrawer`.
    *   **Data parameter change (2:24:15 PM):** Changed the data passed to `setDrawerData` for "HBL Audit" from `data.serial_id` to `data.agent_booking_id`.
    *   **Data parameter change (2:24:51 PM):** Changed the data passed to `setDrawerData` for "HBL Audit" from `data.agent_booking_id` to `location.state.agent_booking_id`.
    *   **Drawer `table` prop change (2:25:07 PM):** Changed the `table` prop passed to `ReusableRightDrawer` from "ISF" to "HBL".

7.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLform.jsx`** (Timestamp: 12/1/2025, 3:07:07 PM)
    *   This is the main HBL form component, integrating various sub-forms for header details, parties, containers, routing, and POs.
    *   **Key updates:**
        *   Uses `Formik` with `HBLvalidationSchema` for form validation and `useSaveHblBookingMutation`, `useUpdateHblBookingMutation` for data submission.
        *   `initialValues` logic was expanded to handle "copy" action and ensure proper initial state for various fields, including party and location data, and lists from Redux (`routingList`, `containerList`, `basicPoList`).
        *   The `handleSave` function now constructs a comprehensive payload, recovering `_name` and `_code` values from combined strings (e.g., `ship_name` from `ship_name~ship_code`). It conditionally calls `saveBooking` or `updateHblBooking` based on `location.state.formAction`.
        *   Error handling for API responses (status 400/500) was implemented to display validation messages using `setAlertConfig`.
        *   On successful save/update, navigates to `/app/booking/hbl_form_screen` with updated `agent_booking_id` and `formAction: "edit"`.
        *   `ThemeTabs` are used to organize HBL details, with logic to update Redux state (`setIsfTab`, `setCurrentTabPartyCode`, `setPartyType`) when a party-related tab is selected.
        *   Keyboard shortcuts (`ctrl+u`, `ctrl+d`, `ctrl+a`, `ctrl+s`, `ctrl+p`) were implemented for common actions like editing/viewing/adding parties and submitting the form.
        *   Imported `ConsigneeFormForHbl` and `BasicPoForm`, integrating them into the HBL form structure.

**Timestamps of Significant Changes:**

*   **12/1/2025, 11:47:38 AM:** Major API extension in `agentBookingApi.js` to support HBL CRUD and other booking features.
*   **12/1/2025, 1:48:09 PM:** `AddRoutingDetailForm.jsx` was refined for reinitialization, simplified state, and minor styling/text changes.
*   **12/1/2025, 1:49:14 PM - 1:58:12 PM:** Iterative debugging and refinement of `handleSubmitRouting` logic in `HblRoutingForm.jsx`, specifically regarding how `slno` is handled during updates and additions to the Redux store.
*   **12/1/2025, 2:00:44 PM - 2:03:53 PM:** Brief refactoring of `onSubmit` prop to `onSubmitData` and back to `onSubmit` in `AddRoutingDetailForm.jsx`, indicating a potential naming convention reconsideration.
*   **12/1/2025, 2:04:52 PM:** `HblEntryFormScreen.jsx` updated to use `serial_id` for fetching HBL details in edit mode and improved list initialization.
*   **12/1/2025, 2:22:47 PM - 2:25:07 PM:** Introduction and subsequent minor adjustments to the "HBL Audit" drawer functionality in `HBLListDetails.jsx`, including changes to the data passed and the `table` prop.
*   **12/1/2025, 3:07:07 PM:** `HBLform.jsx` was comprehensively updated to integrate API mutations, refined form logic, error handling, keyboard shortcuts, and full HBL data handling.

**Patterns and Recurring Elements:**

*   **Redux Toolkit Query (RTK Query):** Extensively used across `agentBookingApi.js`, `HblEntryFormScreen.jsx`, and `HBLListDetails.jsx` for data fetching and mutations, leveraging `createApi`, `fetchBaseQuery`, `providesTags`, and `invalidatesTags` for efficient data management and caching.
*   **Form Management:** Formik is consistently used in `AddRoutingDetailForm.jsx` and `HBLform.jsx` for handling form state, validation (`validationSchema`), and submission.
*   **UI Components:** Frequent use of Material-UI components like `Grid`, `Accordion`, `Box`, `Stack`, `IconButton`, `Typography`, `Card`, `ThemedModal`, `ScreenToolbar`, `OutlinedButton`, `ThemeButton`, `AppTable`, `ThemedGrid`, `AppDatePicker`, `SelectBox`, `AppAutocomplete` for building the user interface.
*   **Data Serialization/Deserialization:** A recurring pattern in `HBLform.jsx` is the combination of display names and codes into a single string (e.g., `ship_name + "~" + ship_code`) for Formik values, which then needs to be "recovered" (split) before sending to the API.
*   **State Management with Redux:** The application uses Redux for managing global state, specifically `hblEntryFormSlice` for handling lists of containers, routing details, and POs, and `agentBookingSlice` for tracking current party tab.
*   **Debugging Console Logs:** Several `console.log` statements are temporarily added for debugging purposes across various files, especially when introducing new features or modifying data handling logic.
*   **Error Handling and Toasts:** `react-hot-toast` is used to provide user feedback for success/error messages after API calls, and a `ValidationErrorsPopup` or `setAlertConfig` handles displaying detailed validation errors.
*   **Modals and Drawers:** `ThemedModal` and `ReusableRightDrawer` components are used for presenting forms or additional information in overlays, maintaining context within the main screen.
*   **Date Formatting:** `appDateFormat` utility function is consistently used in table `renderCell` for displaying dates in a standardized format.
*   **Keyboard Shortcuts:** The `useKeyboardShortcut` hook is utilized in `HBLform.jsx` to enhance user experience with keyboard navigation and actions.

## 3:20:04 PM
The provided log details changes across three files, primarily focusing on HBL (House Bill of Lading) entry and update functionalities, and the implementation of an auditing system.

### File-Specific Updates:

1.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\hblEntry.controller.ts`**
    *   **Initial Setup (12/1/2025, 11:50:49 AM - 11:56:46 AM):** The file contains `createHblMasterBooking` and `updateHblMasterBooking` functions. The `createHblMasterBooking` function inserts data into `hbl_master`, `agent_booking_vessel`, `agent_booking_hbl`, and uses `insertMany` for `agent_booking_routing`, `agent_booking_container`, and `agent_booking_po` lists, all within a database transaction. The `updateHblMasterBooking` function initially uses a generic `updateQuery` for `hbl_master` and has a large commented-out section for a direct SQL `UPDATE` statement, indicating an evolving strategy.
    *   **Refinement of Update Logic (12/1/2025, 11:58:52 AM):** The previously commented-out explicit SQL `UPDATE` statement for `hbl_master` was fully removed. New update logic was introduced for `agent_booking_vessel` using a direct `UPDATE` query and for `agent_booking_hbl` using a generic `updateQuery` with a corrected condition. A recurring pattern emerged for updating child lists (`routingList`, `containerList`, `basicPoList`) which involves deleting all existing records related to the `hbl_master_id` and then re-inserting the entire new list from the request payload.
    *   **Shift to Direct SQL for Updates (12/1/2025, 1:20:16 PM):** The generic `updateQuery` for `hbl_master` was replaced by the re-introduction of a detailed, explicit SQL `UPDATE` statement for `hbl_master`. This SQL statement was then further refined in subsequent commits to include additional fields like `marks` (1:22:23 PM), `bookingdate` (1:23:43 PM), and `hbldate` (1:27:58 PM).
    *   **Payload Source Consistency (12/1/2025, 1:38:52 PM):** The `agent_booking_id` and `booking_id` for child records (`routingList`, `containerList`, `basicPoList`) during updates were changed to consistently derive from `payload.booking_id` instead of `req.body.agent_booking_id`.
    *   **Audit Module Integration (12/1/2025, 2:30:17 PM - 3:13:00 PM):**
        *   `simpleAudit` was imported and used in `createHblMasterBooking` to log HBL creation.
        *   `insertAudit` was imported and introduced in `updateHblMasterBooking` for more detailed auditing of HBL updates. There were several rapid, inconsistent changes in the `primaryColumn` and `primaryKey` parameters for this `insertAudit` call (`payload.agent_booking_id` vs. `payload.booking_id`), and its placement (at the beginning of the function vs. after specific updates), including being commented/uncommented multiple times. This indicates active development and debugging of the audit integration.

2.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\types\audit.types.ts`**
    *   **Audit Type Expansion (12/1/2025, 2:28:34 PM):** A new enum member `HBL` was added to `AuditQueryType`, signifying the inclusion of HBL-related actions in the application's auditing framework.

3.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\audit.controller.ts`**
    *   **HBL Audit Handling (12/1/2025, 2:28:47 PM):** The `getAll` function was updated to recognize `AuditQueryType.HBL`. When this type is requested, it configures `tableName` to "hbl_audit_log" and `refColumn` to "agent_booking_id" to fetch relevant audit logs.

4.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\config\auditConfig.ts`**
    *   This file, which defines the auditing configuration for various tables, remained unchanged throughout the provided log entries. It shows existing audit configurations for vendor, destination, expense code, terminal details, and `agent_booking_entry` (using `isf_audit_log`).

### Timestamps of Significant Changes:

*   **12/1/2025, 11:58:52 AM:** Major refactor of `updateHblMasterBooking` to delete and re-insert child records and explicit update for vessel/HBL details.
*   **12/1/2025, 1:20:16 PM:** Reverted `hbl_master` update logic from generic `updateQuery` to a large, explicit SQL statement.
*   **12/1/2025, 2:28:34 PM:** `HBL` audit type added to `audit.types.ts`.
*   **12/1/2025, 2:28:47 PM:** `audit.controller.ts` updated to handle `HBL` audit queries.
*   **12/1/2025, 2:30:17 PM:** `simpleAudit` introduced for HBL creation logging.
*   **12/1/2025, 2:51:38 PM:** `insertAudit` introduced for HBL update logging.
*   **12/1/2025, 2:53:08 PM - 3:13:00 PM:** Multiple rapid changes to the `insertAudit` call in `updateHblMasterBooking`, indicating a phase of active debugging and parameter/placement adjustments.

### Patterns and Recurring Elements:

*   **Database Transaction Management:** Both HBL creation and update operations are consistently wrapped in `BEGIN` and `COMMIT`/`ROLLBACK` SQL commands, ensuring atomicity of database changes.
*   **Data Sanitization:** The `sanitizeString` utility is frequently used for almost every string field received in the request body, highlighting a focus on security and data integrity.
*   **Date Formatting:** `AppDateFormate` is consistently used for date fields before they are stored in the database.
*   **Modular Database Operations:** The code relies on helper functions like `insertQuery`, `updateQuery`, and `insertMany` for interacting with the database.
*   **Auditing Implementation:** A strong pattern is the ongoing effort to implement comprehensive auditing. This includes defining new audit types, updating audit query handlers, and integrating `simpleAudit` and `insertAudit` functions into the HBL specific controllers. The `DELETE` then `INSERT MANY` pattern for child lists (`routingList`, `containerList`, `basicPoList`) in updates simplifies the logic for auditing these related entities by treating them as complete replacements.

## 4:27:44 PM
The changes primarily focus on the development and refinement of a House Bill of Lading (HBL) feature within a frontend application, involving API interactions, form management, and UI components.

**File-specific updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\store\api\agentBookingApi.js` (12/1/2025, 11:47:38 AM):**
    *   The Redux Toolkit Query API slice was significantly expanded.
    *   Added a new `tagType` for `FormDetails`.
    *   Introduced comprehensive HBL-related API endpoints: `saveHblBooking`, `fetchHblBookingFormDetails`, `getHblDashboard`, `updateHblBooking`, and `deleteHblBooking`. These cover CRUD operations and data retrieval for HBLs.
    *   Additional endpoints for general booking updates (`updateCarrierBooking`, `updateDo`) and reporting (`exportSprReport`) were also added.
    *   Corresponding RTK Query hooks were exported for all new endpoints.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblRoutingForm.jsx`:**
    *   **12/1/2025, 1:32:15 PM:** Initial implementation of `HblRoutingForm`, a component to manage and display routing details within an HBL. It uses Redux for state management, renders a table, and includes modals for adding/editing entries. `slno` (serial number) was initially managed manually for new entries.
    *   **12/1/2025, 1:49:14 PM:** Updated `handleSubmitRouting` to correctly preserve the `slno` of an existing item when updating, rather than overwriting it.
    *   **12/1/2025, 1:50:42 PM:** Removed a debug `console.log` statement.
    *   **12/1/2025, 1:54:31 PM:** Refined `handleSubmitRouting` logic further; for "edit", it now merges old and new data to preserve fields like `slno`, and for "add", it delegates `slno` generation to the reducer.
    *   **12/1/2025, 1:56:46 PM:** Added a debug `console.log` for `routingList`.
    *   **12/1/2025, 1:57:37 PM:** Reverted some `handleSubmitRouting` logic regarding `slno` management and removed the debug `console.log`.
    *   **12/1/2025, 1:58:12 PM:** Re-added the debug `console.log` for `routingList`.
    *   **12/1/2025, 2:00:51 PM:** Changed the prop name from `onSubmit` to `onSubmitData` for the `AddRoutingDetailForm` component, requiring a corresponding change in the child component.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\form\sub-components\AddRoutingDetailForm.jsx`:**
    *   **12/1/2025, 1:44:41 PM:** Initial implementation of `AddRoutingDetailForm`, a modal form for adding/editing individual routing details. It uses Formik for form handling and a reducer for managing autocomplete options.
    *   **12/1/2025, 1:45:50 PM & 1:46:25 PM:** Temporarily commented out then uncommented the "Origin" and "Destination" autocomplete fields.
    *   **12/1/2025, 1:48:09 PM:** Introduced `enableReinitialize: true` to Formik, removed `console.log`, simplified the options reducer, and changed button text to "Update" for edit mode. Removed some `sx` styling properties.
    *   **12/1/2025, 1:50:48 PM:** Reverted most of the changes from 1:48:09 PM, restoring `console.log`, options reducer state, and button text, and re-added `Fsx` (likely a typo for `sx`) styling props.
    *   **12/1/2025, 1:59:13 PM - 1:59:23 PM:** Added and then corrected a debug `console.log` for the `modal` prop.
    *   **12/1/2025, 2:00:44 PM - 2:02:03 PM:** Renamed the `onSubmit` prop to `onSubmitData` to match the parent `HblRoutingForm` component and updated its usage. Added a debug `console.log` for `onSubmitData`.
    *   **12/1/2025, 2:03:53 PM:** Reverted the prop name change, switching back from `onSubmitData` to `onSubmit`. This change creates an inconsistency with the parent component, which still expected `onSubmitData`.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblEntryFormScreen.jsx`:**
    *   **12/1/2025, 2:04:52 PM:** Initial setup of `HblEntryFormScreen`, the main screen for HBL entry. It fetches HBL data, handles different form actions (add, edit, copy), and dispatches Redux actions to initialize various lists (containers, routing, POs). It also integrates party management modals.
    *   **12/1/2025, 2:06:02 PM - 2:07:16 PM:** Added an "HBL Audit" button to the `ScreenToolbar` but initially left its `onClick` handler commented out.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\data\columns\agent.booking.js` (12/1/2025, 2:08:41 PM):**
    *   Updated column definitions: `BOOKING_VESSEL_COLUMN` and `BOOKING_CARGO_COLUMN` had their "Action" field refined to include `AddCircleOutlined` icon as a header button, and explicit `sortable: false, filterable: false` properties. This timestamp implies a broader update to column definitions, likely including `HBL_ROUTING_DETAILS_COULMN` and `HBL_COLUMNS` which are used elsewhere in the logs, though their definitions aren't fully shown here.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLListDetails.jsx`:**
    *   **12/1/2025, 2:10:18 PM:** Initial version of `HblListDetails`, a component to display a list/dashboard of HBLs. It uses `useGetHblDashboardQuery` to fetch data and `useDeleteHblBookingMutation` for deletion. It also includes an "Add HBL" button and a placeholder "HBL Audit" button.
    *   **12/1/2025, 2:22:47 PM:** Integrated a `ReusableRightDrawer` component for the "HBL Audit" functionality. The audit drawer is now opened via the "HBL Audit" button and set to display `data.serial_id` (individual HBL ID) initially.
    *   **12/1/2025, 2:23:00 PM:** Imported `COMMON` from `../../../data/columns/audit` to define columns for the audit drawer.
    *   **12/1/2025, 2:24:15 PM:** Changed the data passed to the audit drawer from `data.serial_id` to `location.state.agent_booking_id`, indicating a shift to auditing based on the main booking ID rather than an individual HBL.
    *   **12/1/2025, 2:25:07 PM:** Changed the `table` prop for `ReusableRightDrawer` from `"ISF"` to `"HBL"`, explicitly indicating the audit drawer's context.
    *   **12/1/2025, 3:40:37 PM - 3:41:15 PM:** Removed `isfDummyData` and some commented-out UI elements, cleaning up the component.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLform.jsx`:**
    *   **12/1/2025, 3:07:07 PM:** Introduced a comprehensive `HBLForm` component. This form integrates Formik with `HBLvalidationSchema`, fetches and updates data via `useSaveHblBookingMutation` and `useUpdateHblBookingMutation`. It handles complex initial values, processes party/port codes, and uses multiple sub-forms (`HblHeaderForms`, `ShipperForm`, `NotifyPartyForm`, `ConsigneeFormForHbl`, `HblContainerDetailsForm`, `HblRoutingForm`, `BasicPoForm`) organized with `ThemeTabs`. It also implements keyboard shortcuts for various actions.
    *   **12/1/2025, 3:36:47 PM:** No functional changes.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\actions.js`:**
    *   **12/1/2025, 3:38:43 PM:** Refactored the `getBookingActions` function to be more modular. It now defines separate arrays for different action types (booking, ISF, view, update line booking, update DO, create HBL) and combines them based on user access roles. The previous `hblAction` (for editing HBL directly from booking dashboard) was removed, and a `createHblAction` was introduced to navigate to the HBL form screen. A new `getHblActions` function was introduced specifically for HBL listing actions, containing an "Edit HBL" action.
    *   **12/1/2025, 3:39:03 PM:** No functional changes.

**Patterns and Recurring Elements:**

*   **HBL Feature-Centric Development:** The predominant theme across all changes is the comprehensive development and integration of the HBL (House Bill of Lading) feature, from backend API support to frontend forms, listings, and audit capabilities.
*   **Redux Toolkit Query (RTK Query):** Widely used for data fetching and mutations, simplifying API interactions and state management for data-intensive operations.
*   **Formik for Forms:** Consistently applied for form handling, validation, and state management in complex forms.
*   **Material-UI (MUI):** Extensive use of MUI components for building the user interface, ensuring a consistent design system.
*   **Redux for Local State Management:** Beyond RTK Query, Redux slices (`hblEntryFormSlice`, `agentBookingSlice`) are used to manage complex local states within forms (e.g., lists of containers, routing details, POs).
*   **Iterative Refinement and Debugging:** Frequent additions and removals of `console.log` statements, along with changes and occasional reversals in form logic (e.g., `onSubmit` prop renaming, `slno` handling), indicate an active and iterative development and debugging process.
*   **Modularization:** The `actions.js` file shows a clear move towards modularizing action definitions based on access roles and feature areas, improving maintainability.
*   **Navigation State:** `react-router-dom`'s `useLocation` and `useNavigate` are frequently used, often passing complex `state` objects to control form behavior (e.g., "add", "edit", "copy").
*   **Audit Trail Integration:** The introduction of `ReusableRightDrawer` suggests a common pattern for displaying audit logs or detailed views across different entities (initially for ISF, then adapted for HBL).

## 4:28:17 PM
The provided log details changes across three files: `hblEntry.controller.ts`, `auditConfig.ts`, and `audit.types.ts`, primarily focusing on implementing and refining audit logging for HBL (House Bill of Lading) related operations.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\hblEntry.controller.ts`**
    *   **12/1/2025, 11:50:49 AM to 11:56:46 AM:** The `updateHblMasterBooking` function was initially structured to use an `updateQuery` helper for `hbl_master`. Commented-out SQL `UPDATE` statements show a previous or alternative approach to updating `hbl_master`. The initial `updateQuery` was replaced by directly defining `bookingInsertQuery` and passing it to `updateQuery` for `hbl_master`.
    *   **12/1/2025, 11:58:52 AM:** The `updateHblMasterBooking` function underwent a significant refactor. Instead of using a generic `updateQuery` for the main `hbl_master` table, it transitioned to direct SQL `UPDATE` statements (`updateMasterQuery`) for `hbl_master`.
        *   It introduced explicit `UPDATE` statements for `agent_booking_vessel` and `agent_booking_hbl` tables.
        *   It implemented a "delete and insert" strategy for `agent_booking_routing` and `agent_booking_container` lists, first deleting existing records related to `hbl_master_id` and then inserting new ones if `payload.routingList` or `payload.containerList` are not empty. A similar pattern for `basicPoList` was implied but truncated in the log.
    *   **12/1/2025, 1:22:23 PM:** The `UPDATE agent_booking_hbl` query was modified to include the `marks` field.
    *   **12/1/2025, 1:26:16 PM:** The `updateMasterQuery` for `hbl_master` was updated to include `bookingdate` as a field to be updated.
    *   **12/1/2025, 1:27:58 PM:** The `UPDATE agent_booking_hbl` query was updated again to include `hbldate` as a field to be updated.
    *   **12/1/2025, 1:38:52 PM:** A `console.log(payload, "payload====890")` statement was added to `updateHblMasterBooking` for debugging purposes. In the `routingList` mapping, `agent_booking_id` was changed from `req.body.agent_booking_id` to `payload.booking_id`.
    *   **12/1/2025, 2:30:17 PM to 2:30:37 PM:** The `createHblMasterBooking` function was enhanced to include a `simpleAudit` call after a successful HBL master insert, logging the creation action to `hbl_audit_log` table.
    *   **12/1/2025, 2:51:38 PM:** The `updateHblMasterBooking` function was modified to import `insertAudit` and `simpleAudit` from `AuditModule`. An `insertAudit` call was added at the beginning of the `updateHblMasterBooking` `try` block, attempting to log changes to `hbl_master` based on `agent_booking_id`.
    *   **12/1/2025, 2:53:08 PM:** The `insertAudit` call in `updateHblMasterBooking` was moved and adjusted. It was placed after the `agent_booking_hbl` update and changed its `primaryColumn` to `agent_booking_id` and `primaryKey` to `payload.booking_id`.
    *   **12/1/2025, 2:59:35 PM:** The `insertAudit` call in `updateHblMasterBooking` was moved again, this time to immediately after the `BEGIN` transaction, to capture data before any updates occur.
    *   **12/1/2025, 3:12:15 PM:** The `insertAudit` call in `updateHblMasterBooking` was commented out and then re-added, with `primaryColumn` set to `serial_id` and `primaryKey` to `hbl_master_id`.
    *   **12/1/2025, 3:25:19 PM:** The `updateHblMasterBooking` function was further refined for auditing. It now imports `auditConfigObj` and uses it to filter the payload, ensuring only relevant `hbl_master` fields are logged in the audit, executing the `insertAudit` call after the `hbl_master` update.
    *   **12/1/2025, 3:45:25 PM:** The `insertAudit` call in `updateHblMasterBooking` was adjusted to use `agent_booking_id` as the `primaryColumn` for the `hbl_master` audit.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\config\auditConfig.ts`**
    *   **12/1/2025, 2:28:04 PM:** A new audit configuration for `hbl_master` was added, defining `relationColumn: "hbl_master_id"` and `auditTable: "hbl_audit_log"`. This configuration specifies a detailed list of columns to be audited for HBL entries, including various shipping details like MBL/HBL numbers, vessel, voyage, shipper/consignee/notify party addresses and contact information, and origin/destination ports.
    *   **12/1/2025, 2:47:30 PM to 3:27:34 PM:** Minor, non-functional code changes (e.g., adding a newline at the end) were observed, but the core configuration for `hbl_master` remained consistent throughout these timestamps.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\types\audit.types.ts`**
    *   **12/1/2025, 2:28:34 PM:** The `AuditQueryType` enum was updated to include a new type: `HBL`.

**Timestamps of Significant Changes:**

*   **12/1/2025, 11:58:52 AM:** Major refactor of the `updateHblMasterBooking` logic in `hblEntry.controller.ts`, shifting from generic update helper to explicit SQL `UPDATE` statements for core tables and introducing "delete and insert" for related lists.
*   **12/1/2025, 2:28:04 PM:** Introduction of `hbl_master` configuration in `auditConfig.ts`, indicating the initiation of audit logging for HBLs.
*   **12/1/2025, 2:28:34 PM:** Update to `audit.types.ts` to recognize 'HBL' as a valid audit query type.
*   **12/1/2025, 2:30:17 PM:** Integration of `simpleAudit` for `createHblMasterBooking` in `hblEntry.controller.ts`.
*   **12/1/2025, 2:51:38 PM - 3:25:19 PM:** Iterative development and refinement of `insertAudit` implementation within `updateHblMasterBooking` in `hblEntry.controller.ts`, including changes to its placement, `primaryColumn`, `primaryKey`, and the introduction of `auditConfigObj` to filter audited data.
*   **12/1/2025, 3:45:25 PM:** Final adjustment to the `insertAudit` call in `updateHblMasterBooking`, using `agent_booking_id` as the primary key for the audit.

**Patterns and Recurring Elements:**

*   **Consistent File Path:** All changes are concentrated within the `t360-backend` project, specifically within the `src/controllers`, `src/config`, and `src/types` directories.
*   **Focus on HBL Management:** The primary theme is the implementation and refinement of HBL (House Bill of Lading) creation and update functionalities, along with the introduction of auditing for these operations.
*   **Database Interactions:** Heavy reliance on `query`, `insertQuery`, `updateQuery`, and `insertMany` functions, indicating direct SQL interaction with a PostgreSQL-like database. Transactions (`BEGIN`, `COMMIT`, `ROLLBACK`) are consistently used to ensure data integrity during multi-step operations.
*   **Payload Sanitization:** The `sanitizeString` utility is widely applied to all incoming request body fields before they are used, suggesting a focus on preventing SQL injection or other input-related vulnerabilities.
*   **Date Formatting:** `AppDateFormate` is consistently used to format date fields to `YYYY-MM-DD` for database consistency.
*   **Error Handling:** `HttpError` is used for consistent error reporting, and `logger.error` is used for logging errors, often followed by a `ROLLBACK` in case of transaction failures.
*   **Audit Logging Implementation:** A significant pattern is the introduction and detailed configuration of audit logging.
    *   **`AuditQueryType` enum:** Expanded to support HBL.
    *   **`auditConfig.ts`:** Centralized configuration for defining what columns are audited for specific tables (like `hbl_master`). This is a clear pattern for managing audit trails across different entities.
    *   **`simpleAudit` and `insertAudit`:** Custom audit functions are being integrated into controller logic, first `simpleAudit` for creation, then `insertAudit` with more detailed data capturing for updates. The `insertAudit` call for updates specifically moved and refined to ensure accurate logging of `hbl_master` changes, filtering data based on `auditConfigObj`.
*   **Modular Design:** The use of `AuthenticatedRequest`, `HttpError`, and utility functions (`AppDateFormate`, `sanitizeString`, `simpleAudit`, `insertAudit`) suggests a modular and organized backend architecture.

## 5:38:59 PM
The changes primarily focus on the development and refinement of a House Bill of Lading (HBL) feature within a booking management application, leveraging Redux Toolkit Query for API interactions and Formik for form handling.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\store\api\agentBookingApi.js` (Timestamp: 12/1/2025, 11:47:38 AM):**
    *   This file saw extensive updates, introducing multiple API endpoints and their corresponding Redux Toolkit Query hooks for HBL management.
    *   New `tagTypes` (`'FormDetails'`) were added to the API definitions.
    *   Added `fetchBookingFormDetails` endpoint.
    *   Crucially, new mutations and queries for HBL functionality were introduced: `saveHblBooking`, `fetchHblBookingFormDetails`, `getHblDashboard`, `updateHblBooking`, and `deleteHblBooking`.
    *   Additional booking-related mutations/queries were added: `updateCarrierBooking`, `updateDo` (notably removing `Content-Type` header for its request), and `exportSprReport`.
    *   `invalidatesTags` for `saveBooking` now includes `'FormDetails'`.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblRoutingForm.jsx` (Multiple timestamps between 12/1/2025, 1:32:15 PM and 1:58:12 PM, and 2:00:51 PM):**
    *   This component, responsible for managing HBL routing details, was developed and refined. It uses Material-UI Accordion for collapsing/expanding content and `AppTable` to display routing entries.
    *   Redux actions (`addList`, `updateList`, `removeList` from `hblEntryFormSlice`) are used to manage the `routingList` state.
    *   The `handleSubmitRouting` logic was adjusted to correctly handle both adding new routing details (assigning `slno`) and updating existing ones (preserving `slno` by merging `modal.data` with new `data` for "edit" actions).
    *   A temporary commenting out and re-enabling of `AppAutocomplete` components for "Origin" and "Destination" occurred, along with back-and-forth changes in button text and `sx` props.
    *   The `onSubmit` prop for `AddRoutingDetailForm` was briefly renamed to `onSubmitData` and then reverted.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\form\sub-components\AddRoutingDetailForm.jsx` (Multiple timestamps between 12/1/2025, 1:44:41 PM and 2:03:53 PM):**
    *   This form component for adding/editing routing details uses Formik for state management and `useReducer` for autocomplete options.
    *   Initial form values are dynamically set based on whether the form is in "add" or "edit" mode.
    *   Autocomplete fields for Origin (`pol`) and Destination (`pod`) fetch options dynamically.
    *   Changes included adding `enableReinitialize: true` to Formik and then removing it, and fluctuating the presence of `console.log` statements. The list of `options` managed by `useReducer` was briefly trimmed and then restored.
    *   The `onSubmit` prop name was toggled between `onSubmit` and `onSubmitData` across different commits.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblEntryFormScreen.jsx` (Multiple timestamps between 12/1/2025, 2:04:52 PM and 3:39:57 PM):**
    *   This component serves as the main screen for HBL form entry, handling different form actions (add, edit, copy).
    *   It fetches HBL details using the new `useFetchHblBookingFormDetailsQuery`.
    *   Redux is used to initialize and reset lists (containers, routing, POs) based on fetched data.
    *   The `ScreenToolbar` initially included an "HBL Audit" button that was implemented, then had its navigation commented out, and finally was removed from this component entirely.
    *   Imports for `HblListDetails` and `ThemeButton` were removed, indicating component restructuring.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\data\columns\agent.booking.js` (Timestamp: 12/1/2025, 2:08:41 PM):**
    *   Introduced a new `HBL_COLUMNS` definition for displaying HBL data in a grid, including fields like `bill_of_loading`, `importer`, `status`, and action buttons for Edit and Delete.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLListDetails.jsx` (Multiple timestamps between 12/1/2025, 2:10:18 PM and 3:41:15 PM):**
    *   This component displays a list of HBLs in a `ThemedGrid` and allows adding new HBLs, editing, and deleting existing ones using `useDeleteHblBookingMutation`.
    *   A `ReusableRightDrawer` was integrated for an "HBL Audit" feature, with its data source (`drawerData`) updated from `data.serial_id` to `location.state.agent_booking_id`. The `table` prop for the drawer was correctly set to "HBL".
    *   Unused imports (e.g., `DirectionsBoatFilledOutlined`) and dummy data (`isfDummyData`) were removed.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLform.jsx` (Multiple timestamps between 12/1/2025, 3:07:07 PM and 3:40:18 PM):**
    *   This is the core HBL form component, integrating various sub-forms.
    *   It now utilizes the `useSaveHblBookingMutation` and `useUpdateHblBookingMutation` hooks for submitting data.
    *   The `handleSave` function performs data transformation to correctly map UI values (e.g., `ship_name` split into `ship_name` and `ship_code`) to the API payload. It also correctly handles `serial_id` for update operations.
    *   Keyboard shortcuts for "Edit Party", "View Parties", "Add New Parties", "Save", and "Focus Party" were implemented using `useKeyboardShortcut`.
    *   Minor console logs and formatting adjustments occurred.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\actions.js` (Multiple timestamps between 12/1/2025, 3:38:43 PM and 3:39:03 PM):**
    *   The `hblAction` constant, which defined an "Edit HBL" action, was commented out from `getBookingActions`. This implies that HBL editing is now handled more specifically in dedicated HBL-related components rather than via a general booking action.

**Patterns and Recurring Elements:**

*   **HBL Feature Focus:** The overwhelming pattern is the comprehensive development of a House Bill of Lading (HBL) feature, including API integration, UI components for data entry, listing, and audit, and state management.
*   **Redux Toolkit Query:** Consistent use of RTK Query for declarative data fetching and caching (`useQuery`, `useMutation`, `providesTags`, `invalidatesTags`).
*   **Formik:** Widely used for robust form state management, validation, and submission across complex forms.
*   **Material-UI:** Extensive use of Material-UI components for consistent and responsive UI development.
*   **Modular Component Design:** Breaking down complex features into smaller, reusable components (e.g., `AddRoutingDetailForm`, `HblHeaderForms`).
*   **Redux State Management:** Utilization of Redux (`useSelector`, `useDispatch`) to manage global and form-specific states for lists like routing, containers, and POs.
*   **Debugging/Development Logs:** Numerous `console.log` statements are present across many files, indicating active development and debugging efforts. These logs often appear and disappear or change slightly between timestamps.
*   **Client-Side Routing:** `useLocation` and `useNavigate` from `react-router-dom` are used for managing application navigation, passing state between routes.
*   **Modal/Drawer Usage:** Frequent use of `ThemedModal` and `ReusableRightDrawer` for presenting additional information or forms in an overlay.

## 5:39:09 PM
The recent code changes primarily revolve around the `hblEntry.controller.ts` file, focusing on the `createHblMasterBooking` and `updateHblMasterBooking` functions, along with the introduction of a robust auditing system across the backend.

### File-Specific Updates:

1.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\hblEntry.controller.ts`**
    *   **Initial State (12/1/2025, 11:50:49 AM - 11:56:46 AM)**: The `updateHblMasterBooking` function initially used a generic `updateQuery` helper to modify `hbl_master` records, with a large commented-out block suggesting a planned or alternative direct SQL approach.
    *   **Refactoring `updateHblMasterBooking` (12/1/2025, 11:58:52 AM)**: A significant change occurred as the `updateHblMasterBooking` function was refactored. The generic `updateQuery` for `hbl_master` was replaced with a more explicit, hand-crafted SQL `UPDATE` statement that directly lists 41 columns. This indicates a move towards more granular control over database updates. Simultaneously, the logic for updating associated lists (`routingList`, `containerList`, `basicPoList`) was implemented using a "delete-then-insert" strategy, where existing entries linked to `hbl_master_id` are deleted, and new entries from the payload are then inserted. New `UPDATE` SQL queries were also introduced for `agent_booking_vessel` and `agent_booking_hbl`.
    *   **Refinement of Update Queries (12/1/2025, 1:20:16 PM - 1:27:58 PM)**: Further refinements were made to the explicit SQL `UPDATE` statements.
        *   The `agent_booking_hbl` update was extended to include the `marks` field.
        *   The `hbl_master` update query (`updateMasterQuery`) was updated to include the `bookingdate` field.
        *   The `agent_booking_hbl` update query was modified to include the `hbldate` field.
    *   **Payload ID Correction (12/1/2025, 1:38:52 PM)**: The `agent_booking_id` and `booking_id` used for inserting items into `agent_booking_routing`, `agent_booking_container`, and `agent_booking_po` were changed to consistently use `payload.booking_id`.
    *   **Introduction of Auditing (12/1/2025, 2:30:17 PM - 3:24:07 PM)**:
        *   The `createHblMasterBooking` function was enhanced with `simpleAudit` to log HBL creation events to `hbl_audit_log`.
        *   The `updateHblMasterBooking` function saw the introduction and iterative refinement of `insertAudit`. This involved multiple adjustments to the audit function's placement within the transaction, and the `primaryColumn`/`primaryKey` parameters it uses.
        *   **Finalized Audit Integration (12/1/2025, 3:24:07 PM)**: The `updateHblMasterBooking` function began importing `auditConfigObj`. The `insertAudit` call for `hbl_master` was then modified to use this configuration object to filter the payload, ensuring only relevant `hbl_master` fields are included in the audit log for updates. This signifies a move to a more structured and declarative auditing approach.

2.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\types\audit.types.ts`**
    *   **Audit Type Definition (12/1/2025, 2:28:34 PM)**: A new enum `AuditQueryType` was introduced, adding `HBL` as a specific type for audit queries, alongside existing types like `USER`, `EXPANSE_CODE`, `DESTINATION`, `VENDOR`, `ISF`, and `TERMINAL`.

3.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\audit.controller.ts`**
    *   **HBL Audit Endpoint (12/1/2025, 2:28:47 PM)**: The `getAll` function was updated to recognize `AuditQueryType.HBL`. When this type is provided, it configures the audit query to target the `hbl_audit_log` table using `agent_booking_id` as the reference column.

4.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\config\auditConfig.ts`**
    *   **Audit Configuration (12/1/2025, 2:28:04 PM)**: This new file defines interfaces (`labelType`, `AuditCofigObjectType`, `AudityConfigType`) and an `auditConfigObj`. This object centralizes audit configurations for various database tables, specifying their `relationColumn`, `auditTable`, and `columns` (key-label pairs) to be audited. Initial configurations for several tables including `agent_booking_entry` (which uses `isf_audit_log`) were added.
    *   **Subsequent Saves (12/1/2025, 2:47:30 PM - 3:27:34 PM)**: Multiple log entries for this file show no content changes, indicating frequent saves without functional modifications during the development of the auditing features.

### Patterns and Recurring Elements:

*   **Comprehensive Auditing**: A significant pattern is the progressive implementation of an auditing system. This includes defining audit types, configuring audit tables and columns, and integrating audit calls into both create and update operations. The use of `simpleAudit` for creation and `insertAudit` with configuration-based payload filtering for updates highlights a structured approach.
*   **Transactional Integrity**: Both `createHblMasterBooking` and `updateHblMasterBooking` consistently use `BEGIN`, `COMMIT`, and `ROLLBACK` for database operations, ensuring data consistency and atomicity.
*   **Data Sanitization and Formatting**: The `sanitizeString` utility is widely applied to incoming request body data, indicating a focus on security and preventing injection vulnerabilities. `AppDateFormate` ensures consistent date formatting (`YYYY-MM-DD`) for database entries.
*   **Refined Database Interaction**: The `updateHblMasterBooking` function transitioned from a generic `updateQuery` to more explicit SQL statements and a "delete-then-insert" strategy for related lists, suggesting optimization or greater control over multi-table updates.
*   **Debugging/Logging**: `console.log` and `logger.info` statements are present throughout, indicating active development and debugging.

## 6:39:02 PM
The code changes primarily focus on expanding and refining the House Bill of Lading (HBL) functionality within the T360 API frontend. This involves updates across API services, UI components, and data structures.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\store\api\agentBookingApi.js` (Timestamp: 12/1/2025, 11:47:38 AM):**
    *   **Significant Expansion of HBL API:** Introduced new API endpoints for HBL management including `saveHblBooking`, `fetchHblBookingFormDetails`, `getHblDashboard`, `updateHblBooking`, and `deleteHblBooking`. These endpoints cover comprehensive CRUD (Create, Read, Update, Delete) operations for HBLs.
    *   **New Booking-Related Mutations:** Added `updateCarrierBooking` and `updateDo` for updating carrier bookings and delivery orders, respectively.
    *   **Report Export:** Included `exportSprReport` for exporting SPR booking reports.
    *   **Tag Management:** Updated `tagTypes` with `FormDetails` and `HBL` to manage Redux Toolkit Query caching for these new features. Corresponding `invalidatesTags` and `providesTags` were added to the new endpoints.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblRoutingForm.jsx` (Multiple timestamps between 12/1/2025, 1:32:15 PM and 1:58:12 PM):**
    *   This component manages the "Routing Details" section of the HBL form using an Accordion, an editable table (`AppTable`), and a modal (`ThemedModal`) for adding/editing individual routing entries.
    *   **Frequent Adjustments to `handleSubmitRouting`:** There were several iterations on how routing data is handled upon submission, specifically concerning the assignment of `slno` (serial number) for new entries and how existing `slno` values are preserved or updated during edits. This indicates active debugging and refinement of the Redux state update logic.
    *   **Debugging Console Logs:** Multiple `console.log` statements were added and removed throughout the changes, particularly for `data` during submission and the `routingList` state.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\form\sub-components\AddRoutingDetailForm.jsx` (Multiple timestamps between 12/1/2025, 1:44:41 PM and 2:03:53 PM):**
    *   This sub-component is responsible for the form within the routing details modal, allowing input for `transport_mode`, `pol` (origin), `pod` (destination), `etd`, and `eta`.
    *   **Dynamic Form Initialization:** Uses `useFormik` with `initialValues` conditionally set based on whether the modal is in "edit" or "add" mode.
    *   **Temporary Component Changes:** Temporarily commented out and then restored `AppAutocomplete` components for "Origin" and "Destination" in some commits, suggesting UI experimentation or debugging.
    *   **Formik Reinitialization:** Briefly included `enableReinitialize: true` in `useFormik` (at 1:48:09 PM) for better handling of `initialValues` in edit mode, but later reverted, indicating a preference for implicit re-rendering or another solution.
    *   **Styling and Prop Renaming:** Minor changes were made to styling (`sx` props) and a temporary renaming of the `onSubmit` prop to `onSubmitData`, which was subsequently reverted.
    *   **Debugging Console Logs:** Similar to `HblRoutingForm.jsx`, `console.log` statements were frequently added for debugging `modal` and `values`.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblEntryFormScreen.jsx` (Multiple timestamps between 12/1/2025, 2:04:52 PM and 3:39:57 PM):**
    *   This is the main screen for creating and editing HBL entry forms.
    *   **HBL Data Fetching and Initialization:** Uses `useFetchHblBookingFormDetailsQuery` to retrieve HBL data and initializes Redux store lists (`containers`, `routing`, `po`) upon successful data fetch.
    *   **Party Management Integration:** Provides modals and screens for managing parties (Shipper, Consignee, Notify) including export, import, add, edit, and view functionalities.
    *   **Toolbar UI Changes:** An "HBL Audit" button was introduced to the `ScreenToolbar` (2:07:06 PM), temporarily had its `onClick` commented out (2:07:16 PM), and was eventually removed from this component (2:09:48 PM) as the audit functionality was likely moved to `HBLListDetails.jsx`.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\data\columns\agent.booking.js` (Timestamp: 12/1/2025, 2:08:41 PM):**
    *   **New HBL Column Definitions:** Introduced `HBL_ROUTING_DETAILS_COULMN` and `HBL_COLUMNS` to structure data for the respective HBL tables.
    *   **Dashboard Column Enhancements:** Updated `BOOKING_DASHBOARD_COLUMNS_GRID` with `id` properties, `renderCell` for `booking_status` (using colored chips), and adjusted the `ready_date` field.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLListDetails.jsx` (Multiple timestamps between 12/1/2025, 2:10:18 PM and 3:41:15 PM):**
    *   This component displays a list of HBLs associated with a booking.
    *   **HBL Dashboard Integration:** Fetches HBL dashboard data using `useGetHblDashboardQuery`.
    *   **HBL Deletion:** Implemented `handleDelete` functionality using `useDeleteHblBookingMutation` with user confirmation and toast notifications.
    *   **HBL Audit Drawer:** Evolved the "HBL Audit" feature. Initially a placeholder button, it was later integrated with a `ReusableRightDrawer` (2:22:47 PM) to show audit details. The data passed to the drawer changed from `data.serial_id` to `location.state.agent_booking_id` (2:24:15 PM), and the `table` prop for the drawer was explicitly set to "HBL" (2:25:07 PM).
    *   **Cleanup:** Removed `isfDummyData` and various commented-out UI elements.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLform.jsx` (Multiple timestamps between 12/1/2025, 3:07:07 PM and 3:40:18 PM):**
    *   This is the core HBL entry/edit form, pulling together various sub-components.
    *   **Comprehensive HBL Management:** Uses `Formik` for form state, `useSaveHblBookingMutation`, and `useUpdateHblBookingMutation` for data persistence.
    *   **Payload Transformation:** `handleSave` meticulously transforms form values into a `payload` for the API, including string parsing for combined fields (e.g., `ship_name` and `ship_code` from `ship_name` field).
    *   **Redux State Integration:** Integrates `routingList`, `containerList`, and `basicPoList` from the Redux store into the HBL payload.
    *   **Keyboard Shortcuts:** Implemented keyboard shortcuts (Ctrl+U for Edit Party, Ctrl+D for View Parties, Ctrl+A for Add New Party, Ctrl+S for Save, Ctrl+P to focus Party tab) for enhanced user experience.
    *   **Party Tab Management:** Uses `ThemeTabs` and Redux to manage the currently active party tab and related party codes.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\actions.js` (Multiple timestamps between 12/1/2025, 3:38:43 PM and 3:39:03 PM):**
    *   **Action Refactoring:** Refactored `getBookingActions` to return different sets of actions based on user access roles (`agentBookingMenu`, `customerBookingMenu`, `adminBookingMenu`).
    *   **Dedicated HBL Actions:** Introduced `createHblAction` for navigating to the HBL form and `getHblActions` specifically for editing HBLs, highlighting a shift towards more granular, HBL-specific actions.
    *   **Removal of Redundant HBL Actions:** A previously commented-out `hblAction` array was officially removed from the main booking actions, suggesting a consolidation of HBL-related actions under the new `createHblAction` and `getHblActions`.

**Patterns and Recurring Elements:**

1.  **HBL Feature Development:** The overarching theme is the development of a complete HBL management system, including API integration, form creation, list displays, and associated actions.
2.  **Redux Toolkit and RTK Query:** Extensive use of `@reduxjs/toolkit/query/react` for API interaction, demonstrating a pattern of modern state management and data fetching.
3.  **Formik for Form Handling:** `useFormik` is consistently used for managing complex forms, validation, and submission across multiple components.
4.  **Modular UI Components:** The application adheres to a component-based architecture, breaking down complex screens into smaller, reusable UI components (e.g., `ScreenToolbar`, `ThemedModal`, `AppTable`, `AppAutocomplete`, `AppDatePicker`).
5.  **Role-Based Access Control (RBAC) for Actions:** Actions are dynamically presented based on user roles (e.g., `access?.agentBookingMenu`), a recurring pattern for controlling feature visibility.
6.  **Debugging Practices:** Frequent addition and removal of `console.log` statements throughout the development process, indicating an iterative debugging workflow.
7.  **Toast Notifications:** `react-hot-toast` is used for providing user feedback on operations (e.g., success or failure messages).
8.  **Keyboard Shortcuts:** Implementation of keyboard shortcuts for common actions in `HBLForm` to improve user efficiency.
9.  **Data Transformation:** Consistent pattern of transforming UI form data (e.g., combined strings for names/codes) into API-friendly payload structures.

## 9:09:30 PM
The provided logs detail a series of concentrated code changes focused on enhancing the HBL (House Bill of Lading) module within a frontend application. The updates primarily occurred on **12/1/2025**, indicating a dedicated development effort.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\store\api\agentBookingApi.js` (12/1/2025, 11:47:38 AM):**
    *   This file received a significant expansion of its API endpoints.
    *   It now includes a dedicated set of Redux Toolkit Query endpoints for HBL management: `saveHblBooking`, `fetchHblBookingFormDetails`, `getHblDashboard`, `updateHblBooking`, and `deleteHblBooking`.
    *   New endpoints for updating carrier bookings (`updateCarrierBooking`), handling delivery orders (`updateDo`), and exporting SPR reports (`exportSprReport`) were also added.
    *   The `tagTypes` were updated to include `FormDetails`, indicating a new data type for form-related data.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblRoutingForm.jsx` (Multiple timestamps, 1:32:15 PM - 1:58:12 PM):**
    *   This component, responsible for managing HBL routing details, underwent several iterative refinements.
    *   Initial implementation included functionality to add, edit, and delete routing entries using Redux actions (`addList`, `updateList`, `removeList`).
    *   There were frequent adjustments to the `handleSubmitRouting` function, specifically concerning how the `slno` (serial number) for routing items is handled during both "add" and "edit" operations. This indicates ongoing efforts to ensure correct state management for dynamic list items.
    *   Console logs were intermittently added and removed for debugging purposes.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\form\sub-components\AddRoutingDetailForm.jsx` (Multiple timestamps, 1:44:41 PM - 2:03:53 PM):**
    *   This form, used for adding/editing individual routing details, also saw several rapid changes.
    *   Functionality for selecting "Origin" and "Destination" via `AppAutocomplete` was briefly commented out and then restored.
    *   A significant change at **1:48:09 PM** introduced `enableReinitialize: true` to `useFormik` for better form state management during edits, simplified `options` state, and adjusted button text. However, many of these changes were reverted or re-evaluated shortly after at **1:50:48 PM** and **2:03:53 PM**, suggesting a back-and-forth in design decisions or debugging.
    *   The prop name `onSubmit` was temporarily renamed to `onSubmitData` and then reverted, again pointing to an iterative development and refactoring process.
    *   Numerous `console.log` statements were added for debugging.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HblEntryFormScreen.jsx` (Multiple timestamps, 2:04:52 PM - 3:39:57 PM):**
    *   This is the main screen for HBL forms, handling data fetching, state initialization, and modal interactions.
    *   The component was set up to fetch HBL details using `useFetchHblBookingFormDetailsQuery` and dispatch `initializeLists` to populate Redux state with containers, routing, and PO data upon successful fetch.
    *   The `ScreenToolbar`'s `rightComps` (right-hand components) were frequently adjusted, with an "HBL Audit" button being added, commented out, and eventually removed in these logs.
    *   Unused imports (like `ThemeButton` and `HblListDetails`) were eventually cleaned up.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\data\columns\agent.booking.js` (12/1/2025, 2:08:41 PM):**
    *   The `BOOKING_DASHBOARD_COLUMNS_GRID` definition was updated to include `blno` (HBL) and `mblno` (MBL) fields, integrating HBL visibility into the main booking dashboard.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLListDetails.jsx` (Multiple timestamps, 2:10:18 PM - 3:41:15 PM):**
    *   This component displays a list of HBLs and includes functionality for deletion (`useDeleteHblBookingMutation`).
    *   A new "HBL Audit" button was introduced, which, starting from **2:22:47 PM**, now opens a `ReusableRightDrawer`.
    *   The `drawerData` passed to this drawer was refined, initially using `data.serial_id`, then `data.agent_booking_id`, and finally `location.state.agent_booking_id` (at **2:24:51 PM**). Crucially, at **2:25:07 PM**, the `table` prop for the drawer was correctly set from `"ISF"` to `"HBL"`.
    *   Unused imports and dummy data (`isfDummyData`) were removed in later timestamps.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\hbl\HBLform.jsx` (Multiple timestamps, 3:07:07 PM - 3:40:18 PM):**
    *   This file represents the core HBL entry form. It's a comprehensive form using Formik, integrating various sub-components (for header, parties, containers, routing, POs).
    *   It implements the logic for `handleSave`, which conditionally calls `useSaveHblBookingMutation` or `useUpdateHblBookingMutation` based on the `formAction` (add/edit).
    *   Party-related fields (`ship_name`, `notify_name`, `cnee_name`, etc.) are processed using a `recoverValue` utility to extract relevant data from combined strings.
    *   Keyboard shortcuts (Ctrl+U for Edit Party, Ctrl+D for View Parties, Ctrl+A for Add New Parties, Ctrl+S for Save) were implemented for improved user experience.
    *   Error and success notifications using `react-hot-toast` are also integrated.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\booking\actions.js` (Multiple timestamps, 3:38:43 PM - 3:39:03 PM):**
    *   This file defines action arrays (`getBookingActions`, `getHblActions`) for grid row operations (edit, copy, view).
    *   It specifies actions based on user roles (`agentBookingMenu`, `customerBookingMenu`, `adminBookingMenu`).
    *   The logic for HBL actions was refactored: a dedicated `getHblActions` was created for HBL-specific edits, and the `getBookingActions` now includes `createHblAction` to navigate to the HBL form screen (for add/edit based on state), replacing a previously commented-out direct "Edit HBL" action.

**Patterns and Recurring Elements:**

*   **HBL Feature Development:** The overwhelming majority of changes revolve around building out the HBL functionality, from API integration to detailed form and list components.
*   **Redux Toolkit Query:** This library is a central piece for data fetching and mutation across `agentBookingApi.js`, `HblEntryFormScreen.jsx`, `HBLListDetails.jsx`, and `HBLform.jsx`.
*   **Formik and MUI:** These frameworks are consistently used for form creation, validation, and UI styling, indicating a standard frontend stack for the project.
*   **Iterative Refinement:** Many files show multiple, closely-spaced timestamps with minor adjustments, additions of `console.log` statements, and subsequent removals or re-evaluations (e.g., handling of `slno` in `HblRoutingForm.jsx`, `enableReinitialize` in `AddRoutingDetailForm.jsx`), suggesting an active, iterative development and debugging process.
*   **State Management Detail:** Specific attention is paid to how list items (like routing details) are identified and updated (`slno` logic) and how form data is prepared for API calls (`recoverValue` utility).
*   **User Experience (UX) Enhancements:** The addition of keyboard shortcuts and detailed error/success feedback (`toast`) in `HBLform.jsx` highlights a focus on usability.
*   **Modularization:** HBL-related components are organized into dedicated files (`HblRoutingForm.jsx`, `AddRoutingDetailForm.jsx`, `HblEntryFormScreen.jsx`, `HBLform.jsx`, `HBLListDetails.jsx`), and actions are separated into `actions.js`, promoting a modular codebase.

## 10:09:31 PM
The provided log details a concentrated effort on developing and refining the House Bill of Lading (HBL) functionality within the T360_Api frontend application, primarily occurring on **December 1, 2025**.

**File-Specific Updates:**

*   **`src\store\api\agentBookingApi.js` (12/1/2025, 11:47:38 AM)**
    *   **Expansion of HBL API Endpoints:** This file received substantial updates to support HBL management. New mutations were added for `saveHblBooking`, `updateHblBooking`, and `deleteHblBooking`. Queries were introduced for `fetchHblBookingFormDetails` and `getHblDashboard`.
    *   **Other Booking-related API Endpoints:** Additional mutations `updateCarrierBooking` and `updateDo`, and a query `exportSprReport` were also added, indicating broader booking feature enhancements.
    *   **Tag Management:** The `tagTypes` array was updated to include `"HBL"`, ensuring proper caching invalidation and data re-fetching for HBL-related operations.

*   **`src\components\screen\booking\hbl\HblRoutingForm.jsx` (multiple updates between 1:32:15 PM and 1:58:12 PM)**
    *   This component manages the display, addition, editing, and deletion of routing details for HBLs.
    *   **Initial Implementation & Iteration:** The first entry shows the component setting up an Accordion, an `AppTable` to list routing items, and a `ThemedModal` for a `AddRoutingDetailForm`. It uses Redux actions (`addList`, `updateList`, `removeList`) to manage the `routingList`.
    *   **`slno` Handling Refinement:** Several changes focused on how `slno` (serial number) is handled during add and edit operations. Initially, it was manually added for new items. There was a temporary attempt to simplify `updateList` by merging all data, then a reversion to explicitly setting `slno` during edits (`row: { ...data, slno: modal.data.slno }`) and for new additions (`{ ...data, slno: routingList.length + 1 }`).
    *   **Debugging:** Frequent `console.log` statements were added and removed, suggesting active debugging during development.

*   **`src\components\screen\booking\form\sub-components\AddRoutingDetailForm.jsx` (multiple updates between 1:44:41 PM and 2:03:53 PM)**
    *   This form is used within a modal to input or modify individual HBL routing details.
    *   **Form Structure:** It leverages Formik for validation and state management, featuring `SelectBox` for transport mode, `AppAutocomplete` for origin/destination ports, and `AppDatePicker` for ETD/ETA.
    *   **Temporary UI Changes:** A notable pattern was the commenting out and subsequent uncommenting of the "Origin" and "Destination" `AppAutocomplete` fields, indicating temporary removal or testing.
    *   **Formik Enhancements:** At one point (`1:48:09 PM`), `enableReinitialize: true` was added to Formik (for better form re-initialization in edit mode), and styling props were streamlined. However, some of these changes (like styling prop removal and submit button text) were later reverted or adjusted.
    *   **Prop Renaming:** The `onSubmit` prop for the component was temporarily renamed to `onSubmitData` (`2:00:44 PM`), likely to avoid conflicts, but then reverted back.

*   **`src\components\screen\booking\hbl\HblEntryFormScreen.jsx` (multiple updates between 2:04:52 PM and 3:39:57 PM)**
    *   This is the primary screen for viewing and managing HBL entry forms.
    *   **Data Fetching & Initialization:** The component now conditionally fetches HBL details using `useFetchHblBookingFormDetailsQuery` based on `formAction` (edit/copy) and `serial_id`. It includes `useEffect` hooks to initialize Redux lists (`containers`, `routing`, `po`) upon successful data fetching or when the `formAction` changes.
    *   **Party Management Integration:** It incorporates modals for `AddMasterForm` and `PartyFormScreen` to manage associated parties, along with export functionality via `handleExportParties`.
    *   **HBL Audit Button:** An "HBL Audit" button was introduced in the `ScreenToolbar` (`2:07:06 PM`), but its navigation logic was initially commented out, and eventually, the button itself was removed (`3:39:57 PM`). This suggests a re-evaluation of its placement or functionality.

*   **`src\data\columns\agent.booking.js` (12/1/2025, 2:08:41 PM)**
    *   **HBL Columns Definition:** A new `HBL_COLUMNS` constant was introduced to define the structure and actions for displaying HBL data in a grid.
    *   **Dashboard Column Enhancements:** `BOOKING_DASHBOARD_COLUMNS_GRID` was updated to include new fields like `booking_status` (with visual `Chip` component), `blno` (HBL number), `mblno` (MBL number), `ship_name`, and `customer`.
    *   **Conditional Action Column:** The `BOOKING_CARGO_COLUMN` was updated to conditionally render an "Action" column (with an "Add Vessel" button) only if a `setModal` function is provided.

*   **`src\components\screen\booking\hbl\HBLListDetails.jsx` (multiple updates between 2:10:18 PM and 3:41:15 PM)**
    *   This component displays a list of HBLs associated with a particular agent booking.
    *   **HBL Data Display & Actions:** It fetches HBL dashboard data using `useGetHblDashboardQuery`. The `HBL_COLUMNS` are used to render a `ThemedGrid` with edit and delete actions.
    *   **Delete Functionality:** `useDeleteHblBookingMutation` is implemented for deleting HBLs, including a confirmation prompt and toast notifications.
    *   **Add HBL Button:** A `ThemeButton` allows users to navigate to the HBL form to add a new HBL for the current booking.
    *   **HBL Audit Drawer:** A `ReusableRightDrawer` was integrated (`2:22:47 PM`) to display "HBL Audit" details. The data passed to this drawer (`drawerData`) was initially `data.serial_id`, then changed to `location.state.agent_booking_id` (`2:24:15 PM`), and the `table` prop was adjusted from `"ISF"` to `"HBL"` (`2:25:07 PM`), indicating a clearer focus on HBL-specific auditing.
    *   **Cleanup:** Later timestamps show the removal of unused imports and commented-out dummy data (`isfDummyData`), tidying up the component.

*   **`src\components\screen\booking\hbl\HBLform.jsx` (multiple updates between 3:07:07 PM and 3:40:18 PM)**
    *   This is the main HBL creation/editing form.
    *   **Comprehensive HBL Form:** It combines multiple sub-forms (`HblHeaderForms`, `HblContainerDetailsForm`, `HblRoutingForm`, party forms, `BasicPoForm`) into a single `Formik`-managed form.
    *   **Save/Update Logic:** Implements `useSaveHblBookingMutation` and `useUpdateHblBookingMutation`. The `handleSave` function constructs a complex payload by processing form values (including splitting combined `name~code` strings) and integrating data from Redux-managed lists (`routingList`, `containerList`, `basicPoList`). It includes error handling, toast messages, and navigation after successful submission.
    *   **Party Interaction:** Provides buttons and keyboard shortcuts for editing, viewing, and adding parties, dynamically updating Redux state (`currentTabPartyCode`, `isTab`, `partyType`) based on the active party tab.
    *   **Keyboard Shortcuts:** `useKeyboardShortcut` hook is used for actions like "Edit Party", "View Parties", "Add New Parties", and "Save".

*   **`src\components\screen\booking\actions.js` (multiple updates between 3:38:43 PM and 3:39:03 PM)**
    *   This file centralizes action definitions for various booking-related entities based on user roles.
    *   **Modular Action Definition:** The `getBookingActions` function was refactored into a more modular structure, separating actions into `bookingActions`, `isfActions`, `createHblAction`, `viewAction`, etc.
    *   **HBL-Specific Actions:** A new `getHblActions` function was introduced specifically for HBL entities, currently containing an "Edit HBL" action.
    *   **HBL Entry Point Shift:** The direct "Edit HBL" action from the main booking dashboard (`hblAction` array) was commented out and then removed from `getBookingActions`. This implies that HBLs are now primarily accessed/managed through the `createHblAction` (which leads to the `HblListDetails` screen) rather than direct editing from the main booking dashboard.

**Patterns and Recurring Elements:**

*   **HBL-Centric Development:** The primary focus across all updated files is the comprehensive implementation and refinement of the HBL (House Bill of Lading) feature. This includes its API integration, UI forms, data management, and user interaction flows.
*   **Modular Component Design:** Extensive use of sub-components (e.g., `AddRoutingDetailForm` within `HblRoutingForm`, multiple forms within `HBLform`) to break down complex UI.
*   **Redux Toolkit & RTK Query:** A consistent pattern of using Redux for global state management and RTK Query for declarative, cached API interactions across various files.
*   **Formik for Forms:** All significant form components rely on Formik for robust form state management and validation.
*   **Material-UI:** Consistent use of Material-UI components (Accordion, Card, Stack, Typography, Buttons, Modals, Drawers) for UI consistency.
*   **Iterative Development:** The multiple, closely spaced timestamps for `HblRoutingForm.jsx` and `AddRoutingDetailForm.jsx` (and the `console.log` statements) suggest rapid iteration, debugging, and refinement of specific features.
*   **Console Logging for Debugging:** Widespread use of `console.log` for inspecting data and flow, which is a common practice during active development.
*   **Data Transformation:** Logic exists to transform API response data into a format suitable for UI components or Redux state (e.g., `convertToArray` and adding `slno` in `HblEntryFormScreen.jsx`, `recoverValue` in `HBLform.jsx`).
*   **Navigation State:** `useLocation().state` is consistently used to pass data and `formAction` (add, edit, copy) between screens for context-aware rendering.

## 10:12:12 PM
The provided logs indicate significant development activity across several files, primarily focusing on auditing features for an application named `T360_Api`.

### File-Specific Updates:

1.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\hblEntry.controller.ts`**
    *   **Timestamp Range:** 12/1/2025, 11:50:49 AM to 12/1/2025, 3:45:25 PM
    *   **Key Changes:**
        *   **Initial `updateHblMasterBooking` (11:50 AM - 11:56 AM):** The `updateHblMasterBooking` function was initially structured to directly use an `updateQuery` helper for `hbl_master`. A large block of commented-out SQL `UPDATE` statements for `hbl_master` suggests a previous or alternative approach to updating the master record.
        *   **Refactoring `updateHblMasterBooking` (11:58 AM):** The `updateHblMasterBooking` function was refactored significantly. Instead of using a generic `updateQuery` with a full payload, it reverted to explicit SQL `UPDATE` statements for `hbl_master`. Crucially, it introduced `DELETE` and `INSERT` patterns for associated lists like `routingList`, `containerList`, and `basicPoList` in tables such as `agent_booking_routing`, `agent_booking_container`, and `agent_booking_po`. This implies a "replace all" strategy for child records on update. The `agent_booking_hbl` table update also changed from `updateQuery` to a direct SQL `UPDATE`.
        *   **Minor Adjustments in `updateHblMasterBooking` (1:20 PM - 1:27 PM):**
            *   At 1:20 PM, the `updateMasterQuery` for `hbl_master` was re-introduced and used, replacing the direct `updateQuery` helper, aligning with the earlier commented-out block.
            *   At 1:22 PM, the `UPDATE` query for `agent_booking_hbl` was expanded to include `marks` as an updatable field.
            *   At 1:23 PM, `bookingdate` was added as a field to be updated in the `hbl_master` table.
            *   At 1:26 PM, `hbldate` was added as a field to be updated in the `agent_booking_hbl` table.
        *   **Introduction of Audit Logging (2:30 PM - 3:45 PM):**
            *   At 2:30 PM, the `simpleAudit` function from `../modules/AuditModule` was imported and integrated into `createHblMasterBooking` to log HBL creation.
            *   At 2:51 PM, `insertAudit` was imported and used in `updateHblMasterBooking` (initially with `primaryColumn: "agent_booking_id"`).
            *   At 2:54 PM, the `insertAudit` call in `updateHblMasterBooking` was modified to use `primaryColumn: "booking_id"` instead of `agent_booking_id`.
            *   At 3:12 PM, `auditConfigObj` was imported and used to filter payload data for `insertAudit` in `updateHblMasterBooking`. The `insertAudit` call for `hbl_master` was adjusted to use `primaryColumn: "serial_id"` instead of `agent_booking_id` and the `primaryKey` changed to `hbl_master_id`.
            *   At 3:24 PM, the `insertAudit` call for `hbl_master` in `updateHblMasterBooking` was modified again, changing the `primaryColumn` back to `agent_booking_id`.
            *   Finally, at 3:45 PM, the `simpleAudit` message for creation was adjusted to be `'HBL log created'` with appropriate primary key parameters.
    *   **Overall Pattern:** The `hblEntry.controller.ts` file shows a common pattern of handling complex form submissions: receiving a large payload, sanitizing it, initiating a database transaction (`BEGIN`), performing multiple inserts/updates across several related tables (`hbl_master`, `agent_booking_vessel`, `agent_booking_hbl`, `agent_booking_routing`, `agent_booking_container`, `agent_booking_po`), and then committing or rolling back. The major evolution is the implementation of detailed auditing for both creation and update operations.

2.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\config\auditConfig.ts`**
    *   **Timestamp Range:** 12/1/2025, 2:28:04 PM to 12/1/2025, 3:27:34 PM
    *   **Key Changes:**
        *   **Initial Structure (2:28 PM):** Defines `labelType`, `AuditCofigObjectType`, and `AudityConfigType` interfaces. The `auditConfigObj` is populated with configuration for several tables (e.g., `spr_vendor_master`, `spr_destination_master`, `expense_code_mapping`, `terminal_details`, `agent_booking_entry`). Each configuration includes `relationColumn`, `auditTable`, and a list of `columns` with `key` and `label`.
        *   **No functional changes in the provided logs:** The content of `auditConfigObj` remains consistent across all timestamps in the log for this file. It consistently defines the schema for auditing various master data entities (vendors, destinations, expenses, terminals, agent bookings, ISF, etc.). This file acts as a central configuration for how different tables should be audited.

3.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\types\audit.types.ts`**
    *   **Timestamp:** 12/1/2025, 2:28:34 PM
    *   **Key Changes:**
        *   **New Enum `AuditQueryType`:** This file was updated to introduce a new TypeScript enum `AuditQueryType`. This enum centralizes string constants for different audit types, such as `USER`, `EXPANSE_CODE`, `DESTINATION`, `VENDOR`, `ISF`, `TERMINAL`, and, significantly, `HBL`.
    *   **Overall Pattern:** This indicates an effort to formalize and standardize the types of audit queries supported by the system.

4.  **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-backend\src\controllers\audit.controller.ts`**
    *   **Timestamp:** 12/1/2025, 2:28:47 PM
    *   **Key Changes:**
        *   **Import `AuditQueryType`:** The `AuditQueryType` enum was imported from `../types/audit.types`.
        *   **Added `HBL` Audit Case:** A new `else if` condition was added to the `getAll` function to handle `AuditQueryType.HBL`. When `type` is `HBL`, it sets `tableName` to `"hbl_audit_log"` and `refColumn` to `"agent_booking_id"`, allowing for retrieval of HBL-related audit logs.
    *   **Overall Pattern:** This update directly consumes the new `AuditQueryType` enum and expands the audit controller's capability to fetch logs for the newly audit-enabled HBL entity.

### Patterns and Recurring Elements:

*   **Database Transactions:** Both `createHblMasterBooking` and `updateHblMasterBooking` functions consistently use `await query('BEGIN')`, followed by multiple database operations, and then `await query('COMMIT')` or `await query('ROLLBACK')` within a `try-catch` block. This ensures data integrity.
*   **Data Sanitization:** The `sanitizeString` utility is widely used for almost all incoming request body fields in `createHblMasterBooking` to prevent potential security vulnerabilities like SQL injection.
*   **Date Formatting:** `AppDateFormate` is consistently used for formatting date fields before insertion or update into the database.
*   **Modular Auditing:** A new `AuditModule` (with functions like `simpleAudit` and `insertAudit`) is being integrated across the codebase. This suggests a pattern of centralizing audit logic to make it reusable and maintainable.
*   **"Delete and Insert" for Child Records:** For updating related lists (routing, containers, POs), the strategy is to first delete all existing child records associated with the `hbl_master_id` and then insert the new list. This simplifies update logic but might not be optimal for performance in all scenarios (e.g., if only a few items change).
*   **Error Handling:** Both `createHblMasterBooking` and `updateHblMasterBooking` use `HttpError` for specific failure conditions and log errors using `logger.error(error)` within their `catch` blocks.
*   **`hbl_master_id` as Foreign Key:** The `hbl_master_id` is consistently used as the linking key for related tables (`agent_booking_vessel`, `agent_booking_hbl`, `agent_booking_routing`, `agent_booking_container`, `agent_booking_po`), indicating a strong relational structure around the HBL master record.
*   **Detailed `hblEntryPayloadTypes`:** The extensive payload mapping in `createHblMasterBooking` highlights the comprehensive data structure associated with an HBL entry, covering shipper, consignee, notify party, ports, vessel details, container details, and POs.

## 11:09:30 PM
The code changes primarily focus on the development and refinement of the House Bill of Lading (HBL) functionality within a booking application, across multiple frontend components and API integrations.

**File-Specific Updates:**

*   **`src\store\api\agentBookingApi.js` (Timestamp: 12/1/2025, 11:47:38 AM):**
    *   This file, which defines the Redux Toolkit Query API for agent bookings, received substantial updates.
    *   It now includes several new endpoints specifically for HBL management: `saveHblBooking` (create), `fetchHblBookingFormDetails` (fetch single HBL details), `getHblDashboard` (fetch HBL list), `updateHblBooking` (update), and `deleteHblBooking` (delete).
    *   New endpoints for general booking updates, `updateCarrierBooking` and `updateDo`, were also added, along with `exportSprReport` for report generation.
    *   The `HBL` tagType was introduced to facilitate cache invalidation and re-fetching for HBL-related operations.
    *   Corresponding Redux hooks (`useSaveHblBookingMutation`, `useFetchHblBookingFormDetailsQuery`, etc.) were exported.

*   **`src\components\screen\booking\hbl\HblRoutingForm.jsx` (Timestamps: 12/1/2025, 1:32:15 PM - 2:03:58 PM):**
    *   This component manages a list of routing details for HBLs.
    *   The initial version (1:32:15 PM) included basic CRUD operations (add, edit, delete) for routing entries, using Redux (`hblEntryFormSlice`) to manage the list and a modal (`AddRoutingDetailForm`) for input. New additions automatically assigned a `slno`.
    *   Throughout several subsequent commits, there was an iterative refinement, and some reversions, regarding how `slno` (serial number) is handled during edits. Specifically, at 1:54:31 PM, the edit logic was updated to merge new data with existing data (`{ ...modal.data, ...data }`) to ensure `slno` preservation, but this was later reverted (1:57:37 PM) to expect the `data` object to contain the correct `slno` for updates, and re-introduced manual `slno` generation for new entries.
    *   A brief change at 2:00:51 PM altered the prop name for the submit handler from `onSubmit` to `onSubmitData` when rendering `AddRoutingDetailForm`, which was then reverted at 2:03:58 PM.
    *   Multiple `console.log` statements were added and occasionally removed for debugging `routingList` and `data`.

*   **`src\components\screen\booking\form\sub-components\AddRoutingDetailForm.jsx` (Timestamps: 12/1/2025, 1:44:41 PM - 2:03:53 PM):**
    *   This form component is used within a modal to add or edit routing details.
    *   The initial setup (1:44:41 PM) used Formik and `useReducer` for autocomplete options.
    *   Temporary changes involved commenting out and then re-enabling `AppAutocomplete` components for "Origin" and "Destination" (1:45:50 PM, 1:46:25 PM).
    *   A significant change at 1:48:09 PM introduced `enableReinitialize: true` to Formik, refined the `useReducer` options state, removed some styling props, and changed the submit button text from "Edit" to "Update" in edit mode. These changes were largely reverted at 1:50:48 PM, restoring the previous behavior and styling.
    *   `console.log` statements were frequently added for debugging `modal` and form values (1:59:13 PM, 1:59:23 PM, 2:01:51 PM).
    *   The `onSubmit` prop was changed to `onSubmitData` (2:00:44 PM) and subsequently reverted back to `onSubmit` (2:03:53 PM).

*   **`src\components\screen\booking\hbl\HblEntryFormScreen.jsx` (Timestamps: 12/1/2025, 2:04:52 PM - 3:39:57 PM):**
    *   This is the main screen for HBL form entry.
    *   It fetches HBL data using `useFetchHblBookingFormDetailsQuery` and initializes Redux lists for containers, routing, and POs. It handles "add" and "edit" form actions.
    *   Between 2:07:06 PM and 2:09:48 PM, an "HBL Audit" button was briefly added to the `ScreenToolbar` but later removed.
    *   The file uses modals for adding master forms and a party screen, with functionality for exporting and importing parties.
    *   The final changes at 3:39:57 PM involved removing the `HblListDetails` import (which likely implies it's no longer directly rendered within this screen) and cleaning up unused imports (`ThemeButton`).

*   **`src\data\columns\agent.booking.js` (Timestamp: 12/1/2025, 2:08:41 PM):**
    *   Column definitions for various booking tables were updated.
    *   `BOOKING_CARGO_COLUMN` was modified to conditionally display an "Add Vessel" button in the header if a `setModal` function is provided.
    *   The `etd` and `eta` columns were commented out in `BOOKING_DASHBOARD_COLUMNS_GRID`.

*   **`src\components\screen\booking\hbl\HBLListDetails.jsx` (Timestamps: 12/1/2025, 2:10:18 PM - 3:41:15 PM):**
    *   This component displays a list of HBLs.
    *   It uses `useGetHblDashboardQuery` to fetch HBL data and `useDeleteHblBookingMutation` for deletion.
    *   An "Add HBL" button navigates to the HBL entry form.
    *   Significant additions include the integration of `ReusableRightDrawer` (2:22:47 PM) to show "HBL Audit" details. The data passed to this drawer (`drawerData`) was initially `data.serial_id`, then `data.agent_booking_id`, and finally `location.state.agent_booking_id` (2:24:15 PM, 2:24:51 PM). The `table` prop for the drawer was also explicitly set to `"HBL"` (2:25:07 PM).
    *   Throughout the changes, commented-out dummy data and unused imports were cleaned up (3:40:37 PM, 3:40:50 PM, 3:41:15 PM).

*   **`src\components\screen\booking\hbl\HBLform.jsx` (Timestamps: 12/1/2025, 3:07:07 PM - 3:40:18 PM):**
    *   This comprehensive HBL form handles creation and updates.
    *   It leverages Formik for form state and validation, Redux selectors for `routingList`, `containerList`, and `basicPoList`.
    *   The `handleSave` function dispatches `saveHblBooking` or `updateHblBooking` based on the `formAction`. It includes logic to parse combined name/code strings (e.g., `ship_name~ship_code`) into separate fields for the API payload.
    *   Error messages from API responses are handled with a custom `alertConfig`.
    *   The `agent_booking_id` logic within `handleSave` for the "edit" action was refined (3:36:47 PM) and then for the "add" action was reverted (3:40:18 PM), indicating ongoing adjustments to how the booking ID is sourced.
    *   Keyboard shortcuts for common actions (edit/view/add party, save) are implemented.

*   **`src\components\screen\booking\actions.js` (Timestamps: 12/1/2025, 3:38:43 PM - 3:39:03 PM):**
    *   This file defines actions available for booking and HBL entries.
    *   `getBookingActions` now includes a `createHblAction` which navigates to the HBL entry form for adding new HBLs, passing relevant booking IDs.
    *   `getHblActions` was defined to provide an "Edit HBL" action, navigating to the HBL form for editing existing HBLs.
    *   A previously commented-out `hblAction` array was removed.

**Patterns and Recurring Elements:**

*   **HBL Feature Focus:** The overwhelming majority of changes are dedicated to building out, integrating, and refining the House Bill of Lading (HBL) functionality, from backend API calls to frontend forms and list views.
*   **Redux Toolkit Query:** Centralized data fetching and modification are consistently handled using RTK Query, with a clear pattern of defining endpoints, tag types, and associated hooks.
*   **Formik for Form Management:** Complex forms like `HBLForm` and sub-forms like `AddRoutingDetailForm` use Formik for robust state management, validation, and submission.
*   **Material-UI (MUI) Components:** The user interface heavily relies on a wide array of MUI components, indicating a consistent design system.
*   **Redux for Global State:** Redux (`hblEntryFormSlice`, `agentBookingSlice`) is used to manage application-wide state, especially for lists of items (containers, routing, POs) and current form contexts.
*   **`useLocation` and `useNavigate` for Routing:** Navigation between screens and passing state between routes is a key pattern. The `formAction` parameter (add, edit, copy) is frequently used in route state.
*   **Modular UI with Modals and Drawers:** `ThemedModal` and `ReusableRightDrawer` are repeatedly used for displaying additional information or forms, promoting a non-disruptive user experience.
*   **Iterative Development and Debugging:** The numerous small changes, occasional reverts, and frequent `console.log` statements suggest an ongoing, active, and debug-heavy development process, particularly for new features like HBL routing and form handling.
*   **Action Abstraction:** `actions.js` centralizes the definition of available actions for different entities (bookings, HBLs) based on user roles, promoting maintainability and consistency.