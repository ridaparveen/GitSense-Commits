# Activity Summary for 9/5/2025

## 10:52:15 AM
The log shows two entries for the file `c:\Users\ridap\OneDrive\Documents\T360_Api\t360-thirdparty\src\controller\external\invoice.controller.ts`, both made on September 5th, 2025.  The changes between the two timestamps (10:24:51 AM and 10:25:26 AM) are insignificant; the code is identical in both entries.

The file contains a TypeScript function `getAll` which retrieves invoice data from a database.  The function dynamically selects tables ("cng_invoice," "spr_invoice," etc.) and joins based on the `req.companyname` parameter, handling "CENTRAL NATIONAL GOTTESMAN, INC." and "SP RICHARDS COMPANY" specifically.  It constructs and executes SQL queries to fetch paginated invoice data with filtering and ordering capabilities based on parameters like `fromDate`, `toDate`, `invoice_no`, and `mblno`.  The results, along with pagination metadata, are returned as a JSON response.  Error handling is included, logging API usage with an api_key_id, and distinguishing between client-side errors (400) and server-side errors (500).  The code uses parameterized queries to mitigate SQL injection vulnerabilities, although the use of string concatenation for building the `WHERE` clause raises a minor concern unless the inputs are properly sanitized.


## 11:26:26 AM
The `customerService.ts` file contains several functions related to customer management.  On September 5th, 2025, at 11:11:27 AM, significant changes were made to this file.

The `getCustomer` function retrieves customer data based on various search criteria (search term, status, location, customer type, ID, and date range), allowing for sorting. It also constructs and executes a query to fetch options for dropdown menus.


The `getCustomerDashboardCardInfo` function fetches summarized customer information (active, inactive, and total customers) based on date range or predefined filters ("weekly," "monthly," or "all").


The `saveCustomerDetails` function saves new customer details, generating a unique `customer_id` and using transactions to ensure data consistency.


The `GetCustomerDetails` function retrieves detailed customer information, including GST location details, using separate queries and error handling for cases when a customer isn't found.


The `SaveGstLocation` function handles saving GST location details.  It sanitizes input data, converting empty strings to NULL values.  This function utilizes transactions and performs multiple inserts into related tables (`customer_gst_location`, `customer_key_personal`, `customer_alerts`, `customer_credit_control`) based on the provided request body.  The data is sanitized before insertion.  The function includes error handling and returns appropriate status codes.

A recurring pattern is the use of asynchronous operations (`async/await`) for database interactions and the consistent use of a common structure for API responses (status, data, message or error).  The code extensively uses parameterized queries to prevent SQL injection vulnerabilities.  There's also a notable emphasis on transaction management using `BEGIN`, `COMMIT`, and `ROLLBACK` for data integrity.


## 11:26:35 AM
The log shows multiple revisions of `GstCustomerLocation.tsx`, a React component responsible for managing GST location data for customers.  The primary changes revolve around the `onSubmit` function within the `useFormik` hook.

Initially, the `onSubmit` function directly called `saveGstLoaction` with the form values.  Between 11:05:38 AM and 11:06:21 AM, the code was modified to include the `customer_id` explicitly within the object sent to `saveGstLoaction`.  This ensures that the customer ID is included in the API request.

Further revisions between 11:06:21 AM and 11:16:05 AM focused on refining how the data is submitted.  The `finalValues` object was introduced to explicitly structure the data sent to the backend, improving code readability and maintainability. The most significant change involved the argument passed to `saveGstLoaction` which oscillated between sending the entire `finalValues` object and only `values.gstLocations`, ultimately settling on sending only `values.gstLocations` at 11:16:05 AM. The addition of `console.log` statements throughout these revisions aids in debugging and tracking data flow.  All changes were made within a short time span on September 5th, 2025.  No structural changes to the UI are apparent from the provided logs.
