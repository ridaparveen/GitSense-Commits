# Activity Summary for 9/22/2025

## 11:35:34 AM
On September 22nd, 2025, significant changes were made to the `envosys-backend` application.

At 10:35:41 AM, the `index.ts` file within the `src/routes` directory was updated. This file acts as a routing hub, registering various API endpoints.  The update involved registering new routes for authentication (`AuthRoutes`), master data (`MasterRoutes`), line bookings (`LineBookingRoutes`), customer bookings (`CustomerBookingRoutes`), document uploads (`DocumentRoutes`), vessels (`VesselRoutes`), vessel and voyages (`VesselAndVoyageRoutes`), and vendors (`VendorRoutes`).  An autocomplete endpoint using the `getAll` service function was also added.  The code uses the `express` router to define and organize these routes.

Later, at 11:25:33 AM, the `vendorServices.ts` file (located in `src/services`) was modified. This file contains functions for managing vendor data.  The update introduced three key functions: `getAll`, `addVendor`, and `updateVendor`.  `getAll` retrieves vendor data with pagination, sorting, and filtering capabilities. `addVendor` creates new vendor entries, and `updateVendor` updates existing ones.  All three functions include robust error handling, logging errors using a logger, and returning appropriate HTTP status codes.  The code uses a custom `QueryBuilder` class for database interactions and leverages parameterized queries for security.  Input validation is performed to prevent invalid data from being accepted.


## 11:35:58 AM
The log shows modifications to components related to a vessel voyage dashboard in a React application.  The `OverviewContainer.tsx` component underwent significant changes between 11:15 AM and 11:29 AM.  Initially, it displayed static data (`vesselVoyogeData`).  Subsequent updates integrated Redux using `useSelector` and `useDispatch` to fetch and display dynamic voyage data from the `voyageDashboardSlice` and `vesselAndVoyageDataApi`.  The data displayed was modified from displaying counts of vessels to counts of voyages.  A `DatePeriodSelector` component was added to allow filtering of data based on a date range and period.

The `voyageDashboardSlice.ts` file (modified at 11:20:07 AM) defines Redux slices for managing pagination, filters (date range, status, vessel name, line name, serial ID), and sorting of vessel voyage data.  The `setDateRange` and `setPeriod` actions are used by `OverviewContainer.tsx` to update date range and period selection respectively.

The `store.ts` file (modified at 11:20:48 AM) configures the Redux store, including the `voyageDashboardSlice` and several other reducers and API middleware.

Finally, the `VesselVoyageDashboard.tsx` component (modified between 11:33 AM and 11:35 AM) displays a table of vessel voyage data using `AppGrid`. The initial version used static data from `vesselData`, but this was later replaced by fetching data dynamically from `useFetchVoyageDashboardDataQuery` with filters and pagination from Redux's `voyageDashboardSlice`. The component includes search, filtering, sorting, and data export functionalities.  A key change here was the replacement of  the data source for the `AppGrid` from local state to the fetched `vesselVoyageDashboardData`.  Initially, the commented out code for the filter parameter showed it was intended to use the state from the redux store.


## 12:35:35 PM
The log shows multiple revisions of the `vesselAndVoyageService.ts` file between 11:53 AM and 11:59 AM on September 22, 2025.  The changes primarily focus on the `getAll` function, specifically its pagination logic.

Initially, the offset calculation in `getAll` was incorrect: `offset = (Number(page) - 1) * Number(perPage);`.  This was changed to `offset = Number(page) * Number(perPage);` at 11:55:19 AM, then reverted back to the original correct calculation at 11:59:08 AM.  A `console.log` statement was added to debug the offset value at 11:56:14 AM.

Between 11:53:33 AM and 11:54:34 AM, a minor correction was made in the `getAll` function's response.  The `total` count in pagination was updated to include a fallback value of 0 using the nullish coalescing operator (`|| 0`).

No other significant functional changes were made to the other functions (`CreateVesselAndVoyage`, `fetchVesselAndVoyageData`, `getVesselAndVoyageDashboardCardInfo`, `UpdateVesselAndVoyage`) across the revisions.  These functions consistently use database interaction functions (`insertQuery`, `query`, `updateQuery`) and handle transactions using `BEGIN` and `COMMIT` or `ROLLBACK` blocks.  They also consistently return JSON responses with status indicators ("success" or "error").  The code shows consistent use of asynchronous functions and error handling.
