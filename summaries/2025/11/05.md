# Activity Summary for 11/5/2025

## 9:40:09 AM
The `src\routes\index.ts` file, updated at 11/4/2025, 7:35:07 PM, underwent significant expansion to consolidate and register a wide array of API routes for the backend. New routes were added for authentication, customer management, line bookings, customer bookings, document uploads, vessel management, vendor management, and job management. Additionally, dedicated endpoints for autocomplete search (`/autocomplete`) and audit logs (`/audit`) were integrated, utilizing `getAll` from `searchOptions` and `getAllAudit` from `auditService` respectively. A previously existing `EnquiryRoutes` section was commented out.

Following shortly after, at 11/4/2025, 7:43:53 PM, the `src\middleware\uploadMiddleware.ts` file was introduced or updated to implement a robust and flexible file upload mechanism. This file exports an `uploadMiddleware` factory function that leverages `multer` for disk storage. Key features include:
*   **Dynamic folder creation:** The middleware can create highly specific destination folders, optionally including `year/month/day/hour-minute-second` within a `mainFolder/subFolder` structure, ensuring unique and organized storage paths.
*   **Directory Management:** It automatically creates the necessary directories recursively if they don't exist.
*   **Unique Filenaming:** Files are renamed upon upload to include a timestamp-based unique suffix, preventing name collisions while retaining the original base name and extension.
*   **File Filtering and Limits:** It accepts all file types by default (though customizable) and enforces a 10MB file size limit.
*   **Versatile Handlers:** The factory function returns an object containing various `multer` handlers (`single`, `array`, `fields`, `any`) to support different file upload scenarios, making it highly adaptable for handling single files, multiple files, or files associated with specific form fields.

The changes indicate a focused development effort within a short timeframe on 11/4/2025, primarily enhancing the backend's routing capabilities to support core business logic and introducing a sophisticated file upload system, suggesting that document management is a critical component of the application.

## 9:41:05 AM
The codebase reflects a focused effort on implementing and refining a document upload feature, alongside a broader expansion of the Redux store.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-frontend\src\store\store.ts` (11/4/2025, 5:57:55 PM):** This file underwent a significant expansion, integrating numerous new Redux API slices and feature slices. Key additions include `customerDataApi`, `uploadDocumentApi`, `lineBookingApi`, `customerBookingApi`, `vesselAndVoyageDataApi`, `jobApi`, `vendorDataApi`, `auditDataApi`, and `enquiryDataApi`. Corresponding feature slices like `customerDashboardSlice`, `lineBookingSlice`, `voyageDashboardSlice`, `jobDashboardSlice`, and `customerBookingSlice` were also added, indicating a substantial increase in the application's data management capabilities.

*   **`c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-frontend\src\pages\upload-docs\uploadDocs.tsx`**: This file shows a clear evolution of the `UploadDocs` page component:
    *   **Initial Creation (11/4/2025, 6:01:03 PM - 6:01:47 PM):** Started as a simple placeholder React component, quickly renamed to `UploadDocs` (PascalCase).
    *   **Layout Integration (11/4/2025, 6:02:46 PM):** Incorporated a `PageWrapper` component for basic UI structure.
    *   **Feature Implementation (11/4/2025, 6:13:16 PM - 6:19:01 PM):** Transformed into a modal-like component with form management (`useFormik`), state for file uploads (`uploadedFile`, `isDragOver`), drag-and-drop functionality, and basic UI elements for a "Confirm Line Booking" action. It also shifted from a default to a named export.
    *   **Component Refactoring (11/4/2025, 6:24:18 PM - 6:29:14 PM):** The core form logic was extracted into a new component named `ConfirmLineBookingForm` (which was then moved to `components/screen/upload-docs/uploadDocs.tsx`). The `pages` file then became a wrapper, importing and rendering this new form component. The title was also updated from "Confirm Line Booking" to "Upload Documents".
    *   **Final Page Structure (11/4/2025, 7:21:01 PM - 7:22:21 PM):** The page component removed the `bg-gray-100` class and fully integrated `ConfirmLineBookingForm` within `PageWrapper.Content`, showcasing a structured layout.

*   **`c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-frontend\src\components\screen\upload-docs\uploadDocs.tsx`**: This new file was created as the destination for the refactored document upload component.
    *   **Initial Move (11/4/2025, 6:28:22 PM):** The `ConfirmLineBookingForm` component was moved here, retaining its functionality from the `pages` directory.
    *   **Form Simplification and Renaming (11/4/2025, 6:30:54 PM - 6:31:38 PM):** The "Delivery Order No." input was removed, and the component's internal title changed to "Upload Documents".
    *   **Multiple File Upload Capability (11/4/2025, 7:14:53 PM):** A significant enhancement was introduced, allowing multiple files to be uploaded. The state was updated to `uploadedFiles` (an array), and the file handling logic was modified to append unique files. The UI was adapted to list multiple uploaded files.
    *   **UI/UX Refinements (11/4/2025, 7:16:49 PM - 7:20:24 PM):** Improvements were made to the file input (resetting value after selection, z-index for button overlay), drag-and-drop styling, and overall component appearance (e.g., adding `bg-white`, `shadow-sm`, adjusting text colors).
    *   **Backend Integration (11/4/2025, 7:30:35 PM - 7:32:51 PM):** The component was integrated with `useUploadDocumentMutation` from Redux Toolkit Query to handle actual file uploads to a backend API. This involved processing each selected file in a loop, constructing `FormData`, and sending it to the `/uploadDocument` endpoint. Validation for empty uploads, loading states, and toast notifications for success/failure were added, making it a robust upload mechanism. The submit button text also changed from "Confirm" to "Save".

*   **`c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-frontend\src\App.tsx`**: This file received updates to reflect the changes in the `uploadDocs` component.
    *   **Route Addition (11/4/2025, 6:01:52 PM):** A new route `/upload-docs` was added, pointing to the `UploadDocs` component.
    *   **Import Adjustments (11/4/2025, 6:15:23 PM - 6:29:36 PM):** The import statement for `UploadDocs` was updated to reflect its change from a default export to a named export.

**Patterns and Recurring Elements:**

*   **Component Refactoring and Organization:** There's a clear pattern of initial development within a `pages` directory, followed by refactoring the core logic into a dedicated component within a `components/screen` directory for better reusability and separation of concerns.
*   **Progressive Enhancement:** The document upload feature was developed incrementally, starting from a basic placeholder, then adding drag-and-drop, single file upload, multiple file upload, and finally backend API integration with comprehensive feedback.
*   **Styling Consistency:** Extensive use of Tailwind CSS classes for consistent styling across UI elements, including dynamic styling for drag-and-drop interactions.
*   **Form Management:** The `useFormik` hook is a recurring element for handling form state, validation, and submission logic.
*   **Redux Toolkit Query Integration:** The Redux store updates and the final implementation of the file upload component demonstrate a strong reliance on Redux Toolkit Query for managing asynchronous data operations and API interactions.
*   **Iconography:** Icons from `@mui/icons-material` (Upload, Close) and `react-icons/fi` (FiFileText, FiTrash2) are consistently used for visual cues, with a brief deviation to `react-icons/hi` before reverting.

## 10:40:50 AM
The log indicates a series of backend infrastructure updates, all occurring on November 4, 2025.

The following changes were observed in specific files:

*   **`c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-backend\src\routes\index.ts`** (Timestamp: 11/4/2025, 7:35:07 PM): This file, responsible for main API routing, was updated to include and register several new or existing route modules. These modules cover authentication (`AuthRoutes`), customer management (`CustomerRoutes`, `CustomerBookingRoutes`), line bookings (`LineBookingRoutes`), document handling (`DocumentRoutes`), vessel operations (`VesselRoutes`, `VesselAndVoyageRoutes`), vendor management (`VendorRoutes`), and job-related functionalities (`JobRoutes`). It also integrates `getAll` for autocomplete features and `getAllAudit` for audit services. An `EnquiryRoutes` import and usage were found commented out.

*   **`c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-backend\src\middleware\uploadMiddleware.ts`** (Timestamp: 11/4/2025, 7:43:53 PM): A new `uploadMiddleware` factory function was introduced or modified. This middleware leverages `multer` to handle file uploads, allowing for dynamic folder creation based on `mainFolder`, `subFolder`, and an optional `dateFolder` parameter which creates a nested directory structure down to hour-minute-second for precise timestamping. It ensures target directories exist, configures disk storage to generate unique filenames by appending a timestamp, and sets a default file size limit of 10MB. The middleware returns various `multer` upload methods (single, array, fields, any) wrapped as Express `RequestHandler`s.

**Patterns and Recurring Elements:**
All significant code changes occurred on the same day, November 4, 2025, within a short span, indicating a focused development session on backend functionalities. The updates primarily involve setting up new API routes and enhancing file upload capabilities with dynamic folder structuring, suggesting work on expanding the system's core features and data management.

## 10:41:14 AM
The log primarily details significant frontend development activities, focusing on the expansion of Redux state management and the iterative development of a new document upload feature.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-frontend\src\store\store.ts`** (Timestamp: 11/4/2025, 5:57:55 PM)
    *   The Redux store configuration underwent a substantial expansion. Numerous new API slices (`vesseDataApi`, `uploadDocumentApi`, `customerDataApi`, `lineBookingApi`, `customerBookingApi`, `vesselAndVoyageDataApi`, `jobApi`, `vendorDataApi`, `auditDataApi`, `enquiryDataApi`) and feature slices (`userReducer`, `enquiryDetailsFormReducer`, `bookingDetailsFormReducer`, `mblDeatilsFormReducer`, `invoiceChargeDetailsReducer`, `vessalVoyageReducer`, `vendorDetailsFormReducer`, `boxPlanDetailsFormReducer`, `customerDetailsReducer`, `vesselDashboardSlice`, `customerDashboardSlice`, `customerFormSlice`, `lineBookingSlice`, `lineBookingDashboardSlice`, `voyageDashboardSlice`, `jobDashboardSlice`, `customerBookingSlice`, `vendorDashboardSlice`, `customerDashboardDataSlice`) were added to the `combineReducers` and `middleware`. This indicates a significant increase in the application's complexity and scope, with more data models and associated API interactions being integrated into the global state.

*   **`c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-frontend\src\pages\upload-docs\uploadDocs.tsx`**
    *   **Initial creation (11/4/2025, 6:01:03 PM - 6:01:47 PM)**: Started as a basic React functional component displaying "uploadDocs".
    *   **UI Structure Integration (11/4/2025, 6:02:46 PM)**: Wrapped in `PageWrapper` components for layout.
    *   **Functional Refactor to Modal (11/4/2025, 6:13:16 PM - 6:19:01 PM)**: Transformed into a `ConfirmLineBookingPopupProps` component, acting as a modal with drag-and-drop file upload capabilities using `useFormik`, `@mui/icons-material`, and `react-icons/fi`. It handled a single file upload with a "Delivery Order No." input. The export type changed from default to named (`export const UploadDocs`). Minor styling adjustments and icon changes (`X` to `Close`).
    *   **Component Relocation and Wrapper (11/4/2025, 6:28:52 PM - 6:29:14 PM)**: The core form logic was extracted into a new component `ConfirmLineBookingForm` located at `src\components\screen\upload-docs\uploadDocs.tsx`. This file then became a wrapper page, importing and rendering `ConfirmLineBookingForm`. The component was also renamed from `Home` to `UploadDocs`.
    *   **Layout Integration (11/4/2025, 7:22:21 PM)**: The `UploadDocs` page component was further integrated into the application's `PageWrapper` layout, featuring a left sidebar (`PageWrapper.Left`) and main content area (`PageWrapper.Content`).

*   **`c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-frontend\src\components\screen\upload-docs\uploadDocs.tsx`**
    *   **Creation and Initial Form (11/4/2025, 6:24:18 PM)**: This file was created, initially named `ConfirmLineBookingForm`, and contained the detailed file upload form logic previously in `src\pages\upload-docs\uploadDocs.tsx`. It included input for "Delivery Order No." and single file upload with drag-and-drop. It utilized local UI components like `@components/kit/button`, `@components/kit/input`, `@mui/icons-material/Label`.
    *   **Feature Refinement & Multi-File Support (11/4/2025, 6:30:54 PM - 7:14:53 PM)**:
        *   The "Delivery Order No." input field was removed from the UI (though `formik.initialValues` retained it).
        *   The component title changed from "Confirm Line Booking" to "Upload Documents".
        *   **Crucially, it was refactored to support multiple file uploads** by changing `uploadedFile` state to `uploadedFiles: File[]`, modifying `handleFileUpload` to append unique files, and updating the UI to display a list of uploaded files with individual remove buttons. The file input was made `multiple`.
    *   **UI/UX Enhancements (11/4/2025, 7:16:49 PM - 7:20:24 PM)**: Improvements were made to the drag-and-drop area's styling, `z-index` for the file input overlay, and the default background color of the form and file list items. The `handleFileInputChange` was updated to clear the input value, allowing re-selection of the same file.
    *   **Backend Integration and Submission Logic (11/4/2025, 7:30:35 PM - 7:32:51 PM)**:
        *   Integrated `useUploadDocumentMutation` from `store/api/uploadDocumentApi` and `react-hot-toast` for user feedback.
        *   The component's logic was significantly overhauled. The `onSubmit` function now iterates through the `uploadedFiles`, constructs `FormData` for each, and calls the `uploadDocument` mutation. It includes loading states (`isUploading`), error handling, and success/error toasts.
        *   The form clears uploaded files and resets on successful submission or when "Cancel" is clicked.
        *   Despite the multi-file functionality being re-introduced, the `deliveryOrderNo` input is still not rendered, but its value from `formik.initialValues` is used as a "remark" in the `FormData`.
    *   **Minor Styling Adjustments (11/4/2025, 7:44:45 PM)**: No functional changes, only minor whitespace and code formatting.

*   **`c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-frontend\src\App.tsx`**
    *   **Integration of `UploadDocs` Route (11/4/2025, 6:01:52 PM)**: A new route `/upload-docs` was added, pointing to the `UploadDocs` page component, making the new feature accessible in the application.
    *   **Import Adjustments (11/4/2025, 6:15:23 PM - 6:29:36 PM)**: The import statement for `UploadDocs` was adjusted to reflect changes in its export type (named vs. default) in its respective file (`src\pages\upload-docs\uploadDocs.tsx`).

**Patterns and Recurring Elements:**

*   **Redux Toolkit for State Management and APIs:** The `store.ts` file shows extensive use of `@reduxjs/toolkit` for managing application state and integrating with various APIs (e.g., `vesseDataApi`, `customerDataApi`, `uploadDocumentApi`). This indicates a standardized approach to data fetching and state handling.
*   **Component-Based Development:** The document upload feature was developed iteratively, starting as a single component, then refactored into a parent page (`pages/upload-docs`) wrapping a dedicated, reusable form component (`components/screen/upload-docs`). This demonstrates a clear separation of concerns and reusability.
*   **Formik for Form Handling:** `useFormik` is consistently used for managing form state, initial values, and submission logic in the upload components.
*   **Drag-and-Drop File Upload:** The document upload feature heavily relies on drag-and-drop functionality, complemented by a traditional file input button, providing a user-friendly interface for file selection.
*   **Styling with Tailwind CSS:** The presence of utility classes like `bg-black/40`, `text-lg font-semibold text-gray-800`, `border-2 border-dashed`, `rounded-md px-3 py-2`, `space-y-4` across the UI components suggests the use of Tailwind CSS for styling.
*   **Icon Library Usage:** Icons from `@mui/icons-material` (Upload, X/Close, Label) and `react-icons/fi` (FiFileText, FiTrash2) are frequently used for visual cues.
*   **Progressive Enhancement/Refinement:** The document upload component underwent multiple stages of refinement, from a basic placeholder to a fully functional multi-file uploader with backend integration, error handling, and UI feedback.
*   **Frontend-Backend Integration:** The integration of `useUploadDocumentMutation` and `FormData` directly within the component's `onSubmit` logic highlights a direct coupling between the frontend form submission and the backend API for document uploads.

## 11:41:03 AM
The recent code changes primarily focus on enhancing document management functionalities, including file uploading, storage, and retrieval, along with updates to API routing.

**File-specific Updates:**

*   **`src\routes\index.ts` (11/4/2025, 7:35:07 PM):** An `Audit` route (`apiRouter.use(Paths.Audit.Base, getAllAudit)`) was introduced, integrating `getAllAudit` from `auditService`. Concurrently, `EnquiryRoutes` and its corresponding usage were commented out, indicating a temporary suspension or deprioritization of that feature.
*   **`src\middleware\uploadMiddleware.ts` (11/4/2025, 7:43:53 PM):** This file underwent a significant update, introducing a `uploadMiddleware` factory function. This new middleware allows for dynamic creation of upload directories, supporting a date-based folder structure (e.g., `mainFolder/subFolder/year/month/day/hour-minute-second`). It ensures that target directories exist (creating them recursively if not), assigns unique filenames, and sets a file size limit of 10MB. The function returns various Multer upload handlers (`single`, `array`, `fields`, `any`).
*   **`src\services\documentService.ts` (11/5/2025, 11:22:29 AM):** The `uploadDoc` function was updated to handle document uploads, requiring `ref_type` and `ref_id` parameters. More notably, the `downloadDoc` function was enhanced to search for files in a new, more structured date-based path (`basePath/ref_type/year/month/day/file_name`) before falling back to older path conventions (`basePath/ref_type/file_name` and `basePath/file_name`). Extensive `console.log` statements were added to assist in debugging the file path resolution.
*   **`src\common\util\globalUpload.ts` (Multiple timestamps on 11/5/2025, between 11:23:47 AM and 11:36:05 AM):** This file saw rapid, iterative changes focused on the `saveDoc` function.
    *   Initially (11:23:47 AM), the file saving logic shifted to create a target folder structure incorporating `ref_type`, `year`, `month`, and `day`.
    *   Subsequent updates (11:26:32 AM, 11:27:17 AM, 11:28:12 AM, 11:35:10 AM, 11:36:05 AM) show active experimentation with the exact format of the generated folder path. The directory creation evolved from `path.join(globalBasePath, ref_type, year, month, day)` to various concatenations like `globalBasePath, ref_type + year + month + day` and `globalBasePath, ref_type +'_' + year + month + day`. The final recorded change reverts to a structure similar to `globalBasePath, ref_type +'_' + year + month + day`.
    *   A consistent change across these iterations is that the `document_path` stored in the database is now just the `fileName`, simplifying from previous commented-out versions that stored a `relativePath`.
    *   The file contains substantial commented-out code, indicating previous iterations or experimental changes to the `saveDoc` logic.

**Patterns and Recurring Elements:**

*   **Focus on Document Management:** The most prominent pattern is the intensive development around file upload and download capabilities. This includes dedicated middleware for uploads, service functions, and a core utility for saving documents.
*   **Dynamic and Date-based Folder Structures:** There's a clear strategic decision to organize uploaded files into dynamic folders. These folders utilize `ref_type` (a reference type) and current date components (year, month, day, and even time in `uploadMiddleware`) to create a more organized and potentially scalable storage system.
*   **Debugging and Iteration:** The frequent, rapid updates to `globalUpload.ts` and the inclusion of numerous `console.log` statements in `documentService.ts` point to active debugging and refinement of the file storage and retrieval logic. This suggests the team is actively working to stabilize and optimize these new features.
*   **Database Interaction for Metadata:** The process consistently involves saving metadata about the uploaded documents (such as `ref_type`, `ref_id`, `document_name`, `document_path`, `document_type`, `remark`, `uploaded_by`) into a `document_upload` database table, indicating a structured approach to tracking files.

## 11:41:30 AM
The development log primarily details the evolution of a file upload feature and significant updates to the application's Redux store. All changes occurred on 11/4/2025, indicating a focused development period.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-frontend\src\store\store.ts` (11/4/2025, 5:57:55 PM):**
    *   Underwent a major expansion to its Redux store configuration.
    *   Numerous new API endpoints (`customerDataApi`, `uploadDocumentApi`, `lineBookingApi`, `customerBookingApi`, `vesselAndVoyageDataApi`, `jobApi`, `vendorDataApi`, `auditDataApi`, `enquiryDataApi`) were imported and integrated into the `appReducer` and middleware.
    *   Many new Redux slices (`customerDetailsReducer`, `vesselDashboardSlice`, `customerDashboardSlice`, `customerFormSlice`, `lineBookingSlice`, `lineBookingDashboardSlice`, `voyageDashboardSlice`, `jobDashboardSlice`, `customerBookingSlice`, `vendorDashboardSlice`, `customerDashboardDataSlice`) were also added to the store, indicating significant feature development across various modules.

*   **`c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-frontend\src\pages\upload-docs\uploadDocs.tsx` and `c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-frontend\src\components\screen\upload-docs\uploadDocs.tsx`:**
    *   **Initial Setup (11/4/2025, 6:01:03 PM - 6:02:46 PM):** The `uploadDocs.tsx` file was initially created as a placeholder page, then quickly renamed to `UploadDocs` (PascalCase) and integrated into a `PageWrapper` for basic layout.
    *   **Feature Development & Refactoring (11/4/2025, 6:13:16 PM - 6:31:38 PM):**
        *   The component was rapidly transformed into a functional modal/popup named `ConfirmLineBookingPopupProps`, incorporating `useFormik` for form management and supporting single file uploads with drag-and-drop.
        *   It then underwent a significant structural change, being moved from `src\pages` to `src\components\screen` (11/4/2025, 6:28:22 PM), signifying its evolution into a reusable component.
        *   The original `pages/upload-docs/uploadDocs.tsx` was subsequently re-established as a wrapper, importing and rendering the newly relocated component.
        *   The component's internal header title was changed from "Confirm Line Booking" to "Upload Documents" (11/4/2025, 6:31:38 PM), reflecting its true purpose.
    *   **Multiple File Uploads & Backend Integration (11/4/2025, 7:14:53 PM - 7:32:51 PM):**
        *   The component was enhanced to support multiple file uploads (11/4/2025, 7:14:53 PM), including logic to prevent duplicate files and display a list of uploaded items.
        *   Significant styling refinements were applied to the drag-and-drop area and overall form presentation (11/4/2025, 7:20:24 PM).
        *   Crucially, the component was integrated with the `useUploadDocumentMutation` RTK Query hook (11/4/2025, 7:32:51 PM) to handle actual file uploads to a backend API. This included implementing loading states, success/error toasts, and form reset logic. Each file is submitted as a `FormData` object with `document_type`, `ref_type`, `remark`, and `uploaded_by` fields.

*   **`c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-frontend\src\App.tsx` (11/4/2025, 6:01:52 PM - 6:29:36 PM):**
    *   Initially imported and added a route for the new `UploadDocs` page.
    *   Subsequent minor changes were made to align the `UploadDocs` import statement with changes in its export method within its source file.

**Patterns and Recurring Elements:**

*   **Modular Development:** A strong pattern of component refactoring and modularization is evident, as `uploadDocs.tsx` transitioned from a page-level component to a reusable "screen" component.
*   **Redux Toolkit and RTK Query:** The application consistently uses Redux Toolkit for state management and RTK Query for efficient data fetching and mutation, as seen in the extensive updates to `store.ts` and the integration of `useUploadDocumentMutation`.
*   **Form Management:** `Formik` is consistently used for handling form state and submissions, particularly within the file upload component.
*   **UI/UX Enhancements:** Frequent adjustments to Tailwind CSS classes and the integration of custom UI kit components (`Button`, `Input`, `Label`) indicate an ongoing focus on improving the user interface and experience.
*   **Iterative Development:** The `uploadDocs.tsx` component shows a highly iterative development process, with rapid changes to functionality, UI, and backend integration.
*   **Inconsistencies:** A notable inconsistency is present in the `ConfirmLineBookingForm` component: the `deliveryOrderNo` field remains in `formik.initialValues` and the `onConfirm` callback's interface, but the corresponding input element has been removed from the UI. This means `deliveryOrderNo` is likely an empty string when submitted. Additionally, the `pages/upload-docs/uploadDocs.tsx` `handleConfirm` callback has not been updated to reflect the `files: File[]` type expected by the `ConfirmLineBookingForm` component.

## 2:25:07 PM
The file `src/routes/AuthRoutes.ts` was updated on 11/5/2025, 12:54:56 PM. This update primarily introduces a new GET endpoint under `Paths.Auth.GetUserInfo`. This route is designed to retrieve and return information about the currently authenticated user. Specifically, it logs "User Info Requested:" along with the `req.user` object and then responds with the user's data in a JSON format with an HTTP status of OK. The file leverages Express Router for defining routes and imports common types, path constants, and HTTP status codes from internal `@src` modules.

## 2:25:18 PM
The `c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-frontend\src\components\screen\upload-docs\uploadDocs.tsx` file underwent several rapid and distinct transformations between a frontend React component and a backend utility function.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\Envosyes\envosys-frontend\src\components\screen\upload-docs\uploadDocs.tsx`**
    *   **Initial state (11/5/2025, 1:57:52 PM):** The file started as a React functional component `ConfirmLineBookingForm`. This component provides a UI for uploading documents, including drag-and-drop functionality, file selection, and displaying a list of selected files. It uses `formik` for form management, `react-hot-toast` for notifications, and interacts with a `useUploadDocumentMutation` API. In the `onSubmit` handler, it constructs `FormData` for each file, appending `document_type`, `remark`, `file`, `ref_id`, and `uploaded_by`. Notably, the `ref_type` field (`formData.append("ref_type", "upload_doc");`) was commented out, meaning this specific field was not being sent to the backend.
    *   **Minor Frontend Update (11/5/2025, 2:03:46 PM):** A small but significant change occurred in the frontend component. The previously commented-out line `formData.append("ref_type", "upload_doc");` was uncommented. This modification ensures that the `ref_type` field with the value "upload_doc" is now explicitly included in the `FormData` sent during file uploads.
    *   **Major Backend Logic Introduction (11/5/2025, 2:06:55 PM):** The file's content dramatically changed from a frontend React component to a backend utility function named `saveDoc`. This new implementation imports Node.js modules like `path`, `fs`, and `moment`. It defines an interface `SaveDocParams` that includes `ref_type`, `ref_id`, `document_type`, `remark`, `uploaded_by`, and `files` (typed as `Express.Multer.File[]`). The function's core logic involves determining target upload paths based on environment variables (`UPLOAD_DOC_PATH`, `GLOBAL_DOC_PATH`) and `ref_type`, creating directories if they don't exist, renaming uploaded files with a timestamp, moving files from temporary locations, and inserting document metadata into a `document_upload` database table.
    *   **Backend Type Adjustment (11/5/2025, 2:07:18 PM):** A slight modification was made to the `saveDoc` backend function. The `files` property in the `SaveDocParams` interface was changed from `Express.Multer.File[]` to `File[]`. The underlying implementation, however, still relied on file properties and `fs` operations typically associated with server-side file handling, suggesting this was a type definition change without a full re-evaluation of the `File` object structure in a Node.js context.
    *   **Reversion to Frontend (11/5/2025, 2:07:54 PM):** The file content reverted entirely back to the React component, specifically to the state from 11/5/2025, 2:03:46 PM. This means the frontend component was restored, and the `ref_type` field remained uncommented and active in the `FormData`.
    *   **Final Frontend Adjustment (11/5/2025, 2:08:32 PM):** The file content again reverted to an earlier state of the React component, specifically the initial version from 11/5/2025, 1:57:52 PM. This change re-comments the `formData.append("ref_type", "upload_doc");` line, making the `ref_type` field inactive once more.

**Timestamps of Significant Changes:**

*   **11/5/2025, 1:57:52 PM:** Initial frontend component version with `ref_type` commented out.
*   **11/5/2025, 2:06:55 PM:** Major shift to a backend file-saving utility function, replacing the entire frontend component.
*   **11/5/2025, 2:07:54 PM:** Complete reversion back to the frontend component, with `ref_type` uncommented.
*   **11/5/2025, 2:08:32 PM:** Final reversion to the initial frontend component state, with `ref_type` commented out again.

**Patterns or Recurring Elements:**

The most prominent pattern is the file `uploadDocs.tsx` oscillating between being a frontend React component and a backend Node.js utility function. This suggests a potential issue in file organization, temporary placement of backend logic in a frontend directory, or a rapid iteration/testing phase where different implementations were tried in the same file path. Within the frontend component, there's a recurring pattern of toggling the `formData.append("ref_type", "upload_doc");` line between commented and uncommented states, indicating an ongoing decision or experiment related to this specific data field in the API request.