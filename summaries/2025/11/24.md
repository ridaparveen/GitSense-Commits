# Activity Summary for 11/24/2025

## 9:15:44 AM
The provided code changes primarily involve frontend components related to user authentication, session management, and role-based access.

**File-specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\core\usercard.tsx`** (Timestamp: 11/21/2025, 10:15:47 AM)
    *   The `handleLogout` function has been significantly refactored to modify the logout flow.
    *   For users authenticated via "auth0," `localStorage` items (`token` and `user`) are now explicitly removed *before* initiating the redirect. The redirect target has also changed from `VITE_UI_V1_BASE_URL/logout` to `VITE_UI_V1_BASE_URL/login`.
    *   For other authentication types, `localStorage` items are also cleared before dispatching the `auth/logout` action and navigating to the root (`/`).
    *   The component continues to display user information (name, role) from `user` data retrieved from `localStorage` or `useFetchUserPreferenceQuery`, and provides a "Sign out" dropdown item.

*   **`c:\Users\ridap\OneDrive\Documents\T360-V2\t360-frontend-v2\src\components\core\layout.tsx`** (Timestamp: 11/21/2025, 10:20:01 AM)
    *   This layout component introduces robust session management and role-based content display.
    *   An `isTokenExpired` function was added to check the validity of the user's session based on `localUser` and `localToken` from `localStorage` and a timestamp (`exp`).
    *   Upon component mount, a `useEffect` hook checks for token expiration: if expired, it clears `user` and `token` from `localStorage` and redirects to the root (`/`); otherwise, it dispatches `initializeSelectedCustomer()`.
    *   Another `useEffect` hook manages the `selectedCustomer` state based on the user's role: "CUSTOMER" roles automatically set their company as the `selectedCustomer`, while "ADMIN_V2" roles clear any `selectedCustomer` filter. This state is synchronized with Redux and `localStorage`.
    *   The `Outlet` (main content) is only rendered if a `selectedCustomer` is present. "ADMIN_V2" users without a selected customer are shown a prompt to select one.

**Timestamps of Significant Changes:**
The two changes occurred in close succession on **11/21/2025** at **10:15:47 AM** and **10:20:01 AM**, suggesting a coordinated effort to update authentication and session handling logic across the frontend application.

**Patterns and Recurring Elements:**

*   **Reliance on `localStorage`:** Both files heavily utilize `localStorage` to store and retrieve user authentication tokens (`token`), user details (`user`), and authentication type (`authtype`). This is also central to clearing session data during logout or expiration.
*   **Redux for State Management:** `react-redux` (`useDispatch`, `useSelector`) is consistently used for managing global application state, specifically for handling logout actions (`auth/logout`) and customer selection (`setSelectedCustomer`, `initializeSelectedCustomer`).
*   **Role-based Logic:** The application implements different behaviors and UI elements based on the user's role (e.g., "CUSTOMER" vs. "ADMIN_V2"), particularly in how customer filters are applied and how content is displayed.
*   **Authentication and Session Control:** There's a strong focus on ensuring authenticated access and managing session validity, including token expiration checks and consistent logout procedures.
*   **Navigation:** `react-router-dom`'s `useNavigate` hook is used for programmatically redirecting users after logout or session expiration.

## 9:15:48 AM
The log indicates changes across two files within the `t360-frontend` project.

**File-Specific Updates:**

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\App.js`**
    *   **Timestamp:** The file appeared in the log at `11/21/2025, 11:31:13 AM` and again at `11/21/2025, 11:34:00 AM`. The content of the file remained identical between these two timestamps, suggesting no functional changes were committed in this specific time window, but rather the file's state was logged twice.
    *   **Content:** This file serves as the main application entry point and defines the routing structure for a React application. It heavily utilizes `react-router-dom` to set up numerous routes for various features such as user management, packing lists, service invoices, PO/DSO orders, booking, analytics, and different tracking screens (FCL, LCL, Rail, Air).
    *   **Key Functionality:**
        *   It imports a large number of page and component files, indicating a comprehensive application with many distinct screens.
        *   Routes are nested under a `Layout` component, typically for a consistent application shell.
        *   Crucially, most routes are wrapped in `ProtectedRoute` components, enforcing role-based access control using `UserRoleEnum` (e.g., `ADMIN`, `CUSTOMER`, `AGENT`, `FRONTOFFICE`, `BACKOFFICE`, `SPR_CUSTOMER`, `ADMIN_V2`, `CSF`).
        *   Specific routes include dashboards (`DashboardScreen`, `ShipmentTrackingScreen`, `BookingDashbaordScreenExtend`, `ISFDashboardScreen`), various form screens (e.g., `UserFormScreen`, `PLFormScreen`, `AgentBookingFormScreenExtend`), and master data management (`PortmasterScreen`, `CityMaster`, `CustomerScreen`).
        *   Authentication is managed through `AuthGuard` for login and registration pages, including a `HandleAuthCallback` for OAuth flows (likely Auth0 given previous commented `Auth0Login` route).
        *   New tracking screens like `FCLScreen`, `LCLScreen`, `RailScreen`, and `AirTrackingScreen` have been integrated, along with specific components like `AddMtrForm` and `GetTruckingDetails`.
        *   New features like `AlcScreen`, `CngInvoiceScreen`, `ReportSchedulerScreen`, `PdfParserScreen`, and `AlcExceptionDashboard` are also routed.

*   **`c:\Users\ridap\OneDrive\Documents\T360_Api\t360-frontend\src\components\screen\analytics\MetricsBox.jsx`**
    *   **Timestamp:** `11/21/2025, 11:36:28 AM`
    *   **Content:** This React component is designed to display various types of analytical metrics and charts.
    *   **Key Functionality:**
        *   It dynamically renders different chart types (Bar, Pie, Line, Stacked Bar, Gauge) based on `item.chartType` and `chartView` state.
        *   It incorporates `MetricToolbar` for controls (likely chart type switching or filtering), `MetricFooter` for additional actions, and `ThemedModal` to provide a full-screen view of the selected chart.
        *   State management uses `useState` for `chartView` and `enlarge` (for modal visibility) and `useSelector` to access `analytics` data from Redux.
        *   The component includes logic to handle cases where no data is available (`NoDataAvailable` component).
        *   It demonstrates a modular approach to data visualization, allowing various charts to be rendered within a consistent container.

**Patterns and Recurring Elements:**

*   **Extensive Routing and Role-Based Access Control:** The `App.js` file clearly shows a robust and granular routing system where almost every application route is protected by `ProtectedRoute`, indicating a strong emphasis on user role management and access control throughout the application. Multiple user roles (`ADMIN`, `CUSTOMER`, `AGENT`, `CSF`, etc.) are explicitly defined and used for route authorization.
*   **Modular Component and Page Structure:** The application is highly modular, with numerous imports from dedicated `pages` and `components` directories, suggesting a well-organized codebase following a feature-sliced or domain-driven structure.
*   **Analytics and Data Visualization:** The presence of `MetricsBox.jsx` and various related imports (e.g., `PieChart`, `BarChart`, `LineChart`, `StackedBarChart`, `GaugeChart`) indicates a significant focus on displaying analytical data and providing interactive charts to users.
*   **Dashboard-Centric Design:** Many routes point to different "Dashboard" screens (e.g., `DashboardScreen`, `BookingDashbaordScreen`, `ISFDashboardScreen`), highlighting a dashboard-driven user experience for various application domains.
*   **Form and Master Data Management:** There are many "form" and "master" routes (e.g., `UserFormScreen`, `PLFormScreen`, `CustomerFormScreen`, `PortmasterScreen`, `CityMaster`), indicating comprehensive CRUD (Create, Read, Update, Delete) operations for various entities within the system.