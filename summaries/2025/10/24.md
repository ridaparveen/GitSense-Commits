# Activity Summary for 10/24/2025

## 9:35:11 AM
The provided log entry details the `AnalyticsScreen.jsx` file as of **10/23/2025, 3:18:36 PM**. This file represents the main screen for the analytics feature in the `t360-frontend` application.

**File-Specific Updates (`AnalyticsScreen.jsx`):**

This component serves as the orchestrator for displaying analytics data. Its key functionalities include:

*   **State Management:** It heavily utilizes Redux, accessing global state for `analytics` (`mainState`), `settings` (`settingsState`), and `auth.user`. It dispatches actions to update `analyticsSlice` with fetched data, loading states, and selected customer information.
*   **Data Fetching with RTK Query:** The screen integrates Redux Toolkit Query for efficient data fetching:
    *   `useFetchDashboardsQuery`: Fetches available dashboards based on the user's company and role upon component mount.
    *   `useLazyFetchEndpointsQuery`: Lazily fetches specific analytics endpoints (e.g., list of reports) based on the `selectedDashboard`.
    *   `useLazyFetchReportQuery`: Lazily fetches individual reports based on the determined endpoints.
*   **Dynamic Dashboard and Report Loading:**
    *   An `useEffect` hook initializes the dashboard state with `dashboardViews` once successfully fetched.
    *   A primary `useEffect` handles the core data fetching logic:
        *   It determines whether to use `DEFAULT_ANALYTICS_ENDPOINTS` or fetch custom endpoints based on `mainState.selectedDashobard`.
        *   It then proceeds to fetch all associated reports concurrently using `Promise.all`, applying an initial date range (`year_2_date`) and formatting dates with `moment`. Each report query includes parameters like `apiKey`, `reportName`, `userid`, date range, `displayBy`, `viewBy`, `companyname`, and `access`.
        *   Fetched data is processed by `metricsPackageHandler` and dispatched to the Redux store.
        *   Loading states are managed, showing a `Loader` during data fetching.
*   **User Role-Based Logic:**
    *   If the user's `role` is 'CUSTOMER', their `companyname` is automatically set as the `selectedCustomer`.
    *   The UI displays an `Alert` for 'ADMIN' users if no customer is selected.
*   **UI Structure:** The screen incorporates common UI components like `ScreenToolbar`, `ThemedBreadcrumb`, and `AnalyticsToolbar`. The core analytics content is rendered within `AnalyticsContainer`, conditional on loading state and customer selection.

**Patterns and Recurring Elements:**

*   **Redux-Centric Architecture:** Frequent use of `useSelector` to retrieve data from the Redux store and `useDispatch` to trigger state updates, demonstrating a strong reliance on Redux for application state management.
*   **API Query Patterns:** API calls through RTK Query consistently include `companyname`, `access`, and `userid` in their query parameters, indicating a pattern of multi-tenancy or role-based access control for analytics data.
*   **Conditional Rendering:** The component makes extensive use of conditional rendering based on `isLoading` states, `user.role`, and the presence of `selectedCustomer` to manage the user experience.
*   **Asynchronous Data Flow:** Multiple `useEffect` hooks and `async/await` patterns are employed to manage the sequential and concurrent fetching of different data sets (dashboards, endpoints, reports), ensuring data dependencies are met.
*   **Utility Functions:** Integration of utility functions like `dateFilterHandle` and `metricsPackageHandler` suggests a modular approach to handling common data manipulation and formatting tasks.