# Activity Summary for 8/12/2025

## 9:28:20 AM
The log shows updates to two files within the `t360-backend-v2` project on August 11th, 2025.

`dashboardService.ts` (6:57:56 PM): This file contains two API endpoints: `getDashboardCardInfo` and `getDeliveryData`.  `getDashboardCardInfo` retrieves dashboard card information using a complex SQL query that counts shipments based on several conditions (pending departure, in transit, ETA within a week, out for delivery).  These conditions heavily utilize the `mtr_tracking_data` table and columns like `vessel_actualdeparted_date`, `t49_vessel_actualdeparted_date`, `t49_eta`, etc., and filter based on the user's role and a provided date range. `getDeliveryData` fetches delivery and vessel arrival data, again using distinct SQL queries based on the request type ('delivery' or 'vessel'). Both functions use the `query` function from the common utility library to interact with the database and return results as JSON responses.

`shipmentService.ts` (6:58:36 PM): This file contains the `getAll` endpoint, which retrieves all shipments with extensive filtering and pagination capabilities.  The endpoint uses a custom `SqlQueryBuilder` class to construct dynamic SQL queries based on various filter parameters (POL, POD, shipment ID, status, dates, etc.).  A significant portion of the code iterates through the results to enrich each shipment with status information derived from the `mtr_tracking_data` table and its various date fields.  The logic for determining the shipment status (Pending, Loading, Departed, In Transit, Custom Hold, Arrived, Delivered) is complex and relies on multiple date comparisons and conditions from the MTR data.  The `SqlQueryBuilder` class builds conditions based on user roles (Admin, Customer, FrontOffice, Agent), applying appropriate access restrictions to the data.  The code also incorporates error handling and logging using `logger` and `HttpStatusCodes`.
