# Activity Summary for 8/25/2025

## 12:33:26 PM
The file `dashboardService.ts` contains two main functions: `getDashboardCardInfo` and `getDeliveryData`.  Both functions interact with a database (`mtr_tracking_data`) using custom SQL queries.

`getDashboardCardInfo` (updated 8/25/2025, 11:41:34 AM) retrieves dashboard card information by constructing a SQL query that counts shipments based on several conditions related to departure and arrival dates, using filtering to categorize them into "pending departure," "in transit," "ETA within 1 week," and "out for delivery." The query dynamically includes date range filters (`fromDate`, `toDate`) from the request.  It uses `buildMtrUserCondition` to incorporate user-specific conditions. The function logs various stages of processing using a logger.

`getDeliveryData` retrieves delivery data based on a type parameter ('delivery' or 'vessel').  It executes different SQL queries depending on this type.  For 'delivery', it selects distinct MBL numbers along with delivery information, while for 'vessel', it selects vessel arrival information. Both queries include a condition to exclude shipments marked as 'shipment_completed = Yes' and use `buildMtrUserCondition` for user-specific filtering. This function also logs query execution and results.  Both functions utilize the `query` function from `@src/common/util/database` for database interaction and return results with appropriate HTTP status codes.  A recurring element is the use of `buildMtrUserCondition` and error handling with HTTP status codes.  The queries heavily rely on  `mtr_tracking_data` table and columns related to shipment tracking, including various dates and statuses (e.g., `departure_date`, `vessel_actualdeparted_date`, `t49_vessel_actualarrived_date`, `shipment_completed`).
