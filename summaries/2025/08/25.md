# Activity Summary for 8/25/2025

## 12:33:26 PM
The file `dashboardService.ts` contains two main functions: `getDashboardCardInfo` and `getDeliveryData`.  Both functions interact with a database (`mtr_tracking_data`) using custom SQL queries.

`getDashboardCardInfo` (updated 8/25/2025, 11:41:34 AM) retrieves dashboard card information by constructing a SQL query that counts shipments based on several conditions related to departure and arrival dates, using filtering to categorize them into "pending departure," "in transit," "ETA within 1 week," and "out for delivery." The query dynamically includes date range filters (`fromDate`, `toDate`) from the request.  It uses `buildMtrUserCondition` to incorporate user-specific conditions. The function logs various stages of processing using a logger.

`getDeliveryData` retrieves delivery data based on a type parameter ('delivery' or 'vessel').  It executes different SQL queries depending on this type.  For 'delivery', it selects distinct MBL numbers along with delivery information, while for 'vessel', it selects vessel arrival information. Both queries include a condition to exclude shipments marked as 'shipment_completed = Yes' and use `buildMtrUserCondition` for user-specific filtering. This function also logs query execution and results.  Both functions utilize the `query` function from `@src/common/util/database` for database interaction and return results with appropriate HTTP status codes.  A recurring element is the use of `buildMtrUserCondition` and error handling with HTTP status codes.  The queries heavily rely on  `mtr_tracking_data` table and columns related to shipment tracking, including various dates and statuses (e.g., `departure_date`, `vessel_actualdeparted_date`, `t49_vessel_actualarrived_date`, `shipment_completed`).


## 12:33:29 PM
The log shows multiple revisions to `shipment-coulmns.tsx` between 11:54 AM and 12:10 PM on August 25, 2025, focusing on adjustments to column definitions for shipment data grids.  These adjustments primarily involved minor tweaks to header names, `minWidth` properties, and  link paths within the `renderCell` functions.  There's no significant change in the overall structure or functionality of the code during this period.  The most noticeable pattern is the iterative refinement of column widths and  route links in different parts of the code.


Between 12:18 PM and 12:25 PM on August 25, 2025, there were several revisions to `shipment-details-page.tsx`.  These changes involved primarily cosmetic and presentational updates.  The main changes were to the styling and layout of information displayed on the page  and several minor text changes, like correcting the label "Arrived1" to "Arrived" in `getPriorityDateLabel`.  A new `info-container` was added and some information was moved around.  The final revision at 12:25 PM added a new console log for debugging.


## 2:07:48 PM
The `shipment-details-page.tsx` file was updated on August 25, 2025, at 1:31:30 PM.  This update significantly enhances the component's functionality and presentation.  The changes involve:

* **Data Fetching and Display:** The component now fetches shipment details using `useFetchShipmentDetailsQuery` and displays them conditionally based on loading and success states.  It leverages data from the `shipmentDeatils` object to populate various UI elements.  Specific data points displayed include shipment scope, status (with color-coded badges), container type, consignee and delivery information, POL, POD, and estimated arrival/departure dates.

* **UI Improvements:**  The UI is significantly restructured using a combination of components from `@components` (e.g., `PageWrapper`, `Tabs`, `Stepper`, `Loader`, `IconButton`, `BaseModal`, `Badge`). The layout incorporates a map (`MapContainer`), tabs for messages and documents, a milestone container, and a document upload modal.  React icons are used extensively for visual appeal.

* **Interactive Elements:**  Users can navigate back using a back button, upload documents via a modal, and view shipment details broken down into different sections.  Conditional rendering based on data availability is implemented (e.g., showing place of delivery information based on if they are different).


* **Error Handling:**  Loading and error states are handled with a `Loader` component, preventing UI breakage while data is being fetched.

* **Helper Functions:**  A `getPriorityDateLabel` function is introduced to prioritize and format dates based on a predefined order ('ata', 'atd', 'etd', 'eta').  The `makeCapitalized` function is used for consistent capitalization of names.

* **Component Integration:**  Several components are integrated, including a stepper component to show the shipment progress, MessageTab, DocumentTab, and MilestoneContainer, which appear to handle different aspects of shipment information.


In essence, this commit represents a substantial overhaul of the shipment details page, providing a more comprehensive and user-friendly interface for displaying and interacting with shipment data.


## 3:07:47 PM
The log shows multiple revisions of the `shipmentService.ts` file on August 25th, 2025.  The changes primarily focus on the `getAll` function, which retrieves and processes shipment data.  The core functionality remains consistent across all revisions: retrieving shipment data based on various query parameters, then enhancing this data with information from an MTR (likely a Master Tracking Record) system.

Specific updates across the revisions include refinements to how shipment statuses are determined and handled. Initially, the code included a commented-out section relying on `shipmentScope` data. This was subsequently removed,  and the logic for determining shipment status was rewritten to rely more directly on MTR data fields like `departure_date`, `t49_eta`, `t49_vessel_actualdeparted_date`, `vessel_actualdeparted_date`, `t49_vessel_actualarrived_date`, and `vessel_actualarrived_date`. This new logic uses a series of `if` statements to assign a `ShipmentStatus` based on the presence or absence of these dates and their relative timing.  The `t49_holdspodterminal_name` field is also used to detect Custom Hold status.  The `getAll` function now explicitly handles cases where the `status` query parameter is either a string (representing a comma-separated list) or an array of `ShipmentStatus` values.  The time stamps show a series of quick edits.  The `SqlQueryBuilder` class, used for constructing database queries, remains largely unchanged across revisions; however its use within `getAll` is modified to incorporate these status changes and improved filtering.


## 3:07:48 PM
The log shows numerous modifications to `Calender.tsx` on August 25th, 2025, between 2:39 PM and 2:52 PM.  The core functionality of the calendar component remains consistent throughout these changes, displaying a calendar view with delivery or vessel arrival information.

The primary changes involve the addition and modification of a "Service Level" select element within the calendar's header. Initially, a `SelectBox` component is briefly introduced and then removed.  A standard HTML `<select>` element is then added, initially with `Standard` and `Expedited` options (around 2:48 PM), later replaced with `Door Delivery`, `Port Delivery`, and `Rail Delivery` options (around 2:52 PM).  The visibility of this `<select>` element is conditional, only appearing when `calenderType` is "vessel".  Minor adjustments to the spacing and padding within the header (`gap-5` vs `gap-2` and  `py-1.5` vs `py-1` in the select styling) are also observed across several commits.  There are no significant changes to the calendar's data rendering or other elements.  The frequent commits suggest iterative development and UI refinement of the service level selection feature.
