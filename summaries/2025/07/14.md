# Activity Summary for 7/14/2025

## 10:38:49 AM
The provided code represents a React component (`DashboardPage`) displaying a dashboard overview.  The component fetches data from multiple APIs (`useFetchShipmentDataQuery`, `useFetchDeliveryDataQuery`, `useFetchCartDataQuery`) and renders this data using various UI components such as `Card`, `DatePeriodSelector`, `Spinner`, and `InputGroup`.  Data fetching is dependent on filters and pagination state managed via Redux (`dashboardSetFilters`, `dashboardSetPagination`).

Significant changes occurred between the timestamps.  The first two commits (10:07 AM and 10:09 AM) show minor modifications.  The most notable change happened at 10:16 AM:  the `selectUserSettings` hook was removed, simplifying the state management.  This suggests refactoring of state handling within the component.  Throughout the log, `console.log` statements are used for debugging, particularly to inspect fetched data (`ShipmentData`, `Filtered Deliveries`, and `dateRangeSelecetor`).

The `DashboardPage` component consistently uses `moment.js` for date manipulation and various React icon libraries (`react-icons/fa6`, `react-icons/hi2`, `react-icons/bs`, `react-icons/io5`, `react-icons/rx`, `@heroicons/react/16/solid`).  The code includes loading states (`isCardLoading`, `isShipmentLoading`, etc.) to improve user experience.  The component handles filtering and pagination for the fetched data, updating the state accordingly and triggering refetches.  There is also functionality for creating a new booking (`nav("/app/bookings")`).


## 11:39:01 AM
The log shows updates to two files on July 14, 2025.

**`server.ts` (10:48:32 AM):** This file, the main server file,  underwent significant changes.  Updates include additions to middleware (cors, morgan for development logging, helmet for production security if not disabled by environment variable),  static file serving for uploads and frontend assets (`/t360_uploads`, `/temp-auth/login`, and  `/public`),  and  the setup of EJS templating engine for views located in the `views` directory.  The file uses environment variables (`ENV.NodeEnv`, `process.env.DOC_UPLOAD_PATH`) to conditionally apply middleware based on the environment (development or production).

**`UserService.ts` (10:50:16 AM):** This file contains various services related to user management, added shortly after the `server.ts` update.  Key additions include:

*   `login`: Handles user login, authenticating against a database (`mtr_user_master`) and generating JWT tokens.  It checks for inactive accounts and throws appropriate HTTP errors.
*   `saveUserPreferences`:  Saves or updates user preferences to the `v2_user_details` table using upsert logic.  It uses extensive logging using the `logger` utility.
*   `fetchUserPreferences`: Retrieves user preferences from `mtr_user_master` and `v2_user_details` tables.  Handles the case where no preferences exist.
*   `saveInviteLog`: Saves user invitation logs to the `v2_user_invite_log` table, sends invitation emails via `sentInviteEmail`, and handles potential conflicts.
*   `fetchAllCompanyUser`: Fetches all users associated with a company from `mtr_user_master` and `v2_user_invite_log` tables, including both active users and pending invitations.
*   `userSettings`:  Retrieves specific user settings, namely date format, from the database.

The `UserService.ts` file consistently uses the `query` function for database interactions, indicating a reliance on a common database access layer.  It also employs detailed logging throughout its functions, aiding in debugging and monitoring.  The code uses a consistent error handling pattern using `HttpError` and `next(new HttpError(...))` within the async functions.  All functions in this file consistently use  `IAuthReq` and `IRes` types, suggesting a structured approach to request and response handling.
